"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[208],{92208:function(e,t,n){n.r(t),n.d(t,{DeadCenter:function(){return Ra},GalleryContext:function(){return La},default:function(){return Fa}});var r=n(92809),i=n(80318),o=n(83789),a=n(30266),s=n(809),c=n.n(s),l=n(67294),u=n(11163),d=n(15289),p=n(39890),f=n(91288),h=n(20079),x=n(9618),v=n(35641),g=n(58877),m=n(68487),w=n(8635),y=n(65850),b=n(63255),E=n(44796),O=n(5567),j=n(65725),I=n(76102);function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _,P=(0,x.O3)();!function(e){e.folder="folder",e.favorites="favorites",e.album="album"}(_||(_={}));var k,A="collection-updation-time",R="collections";!function(e){e[e.LATEST_FILE=0]="LATEST_FILE",e[e.MODIFICATION_TIME=1]="MODIFICATION_TIME",e[e.NAME=2]="NAME"}(k||(k={}));var D=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w.ZP;case 2:if(r=e.sent,i=(0,v.Yu)(v.Pd.USER).id,t.owner.id!==i){e.next=10;break}return e.next=7,r.decryptB64(t.encryptedKey,t.keyDecryptionNonce,n);case 7:o=e.sent,e.next=17;break;case 10:return a=(0,v.Yu)(v.Pd.KEY_ATTRIBUTES),e.next=13,r.decryptB64(a.encryptedSecretKey,a.secretKeyDecryptionNonce,n);case 13:return s=e.sent,e.next=16,r.boxSealOpen(t.encryptedKey,a.publicKey,s);case 16:o=e.sent;case 17:if(e.t0=t.name,e.t0){e.next=22;break}return e.next=21,r.decryptToUTF8(t.encryptedName,t.nameDecryptionNonce,o);case 21:e.t0=e.sent;case 22:return t.name=e.t0,e.abrupt("return",Z(Z({},t),{},{key:o}));case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=(0,a.Z)(c().mark((function e(t,n,r){var i,o,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.Z.get("".concat(P,"/collections"),{sinceTime:n},{"X-Auth-Token":t});case 3:return i=e.sent,o=i.data.collections.map(function(){var e=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isDeleted){e.next=2;break}return e.abrupt("return",t);case 2:return n=t,e.prev=3,e.next=6,D(t,r);case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),(0,O.H)(e.t0,"decryption failed for collection",{collectionID:t.id});case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()),e.next=7,Promise.all(o);case 7:return s=e.sent.filter((function(e){return e.isDeleted||e.key})),e.abrupt("return",s);case 11:throw e.prev=11,e.t0=e.catch(0),(0,O.H)(e.t0,"getCollections failed"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,r){return e.apply(this,arguments)}}(),L=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getItem(R);case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=[];case 11:return n=e.t2,e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getItem(A);case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=0;case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,a.Z)(c().mark((function e(){var t,n,r,a,s,l,u,d,p,f,h,x,v,w;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:return n=e.sent,e.next=5,F();case 5:return r=e.sent,a=(0,m.LP)(),e.next=9,(0,m.GW)();case 9:return s=e.sent,e.next=12,N(a,r,s);case 12:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=16;break}e.t0=void 0!==t;case 16:if(!e.t0){e.next=20;break}e.t2=t,e.next=21;break;case 20:e.t2=[];case 21:if(0!==(l=e.t2).length){e.next=24;break}return e.abrupt("return",n);case 24:return u=[].concat((0,o.Z)(n),(0,o.Z)(l)),d=new Map,u.forEach((function(e){(!d.has(e.id)||d.get(e.id).updationTime<e.updationTime)&&d.set(e.id,e)})),p=[],e.next=30,g.Z.getItem(A);case 30:f=e.sent,h=T(d);try{for(h.s();!(x=h.n()).done;)v=(0,i.Z)(x.value,2),v[0],(w=v[1]).isDeleted||(p.push(w),f=Math.max(f,w.updationTime))}catch(c){h.e(c)}finally{h.f()}return p=oe(p,[],k.MODIFICATION_TIME),e.next=36,g.Z.setItem(R,p);case 36:return e.next=38,g.Z.setItem(A,f);case 38:return e.abrupt("return",p);case 39:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=(0,m.LP)()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,E.Z.get("".concat(P,"/collections/").concat(t),null,{"X-Auth-Token":r});case 6:return i=e.sent,e.next=9,(0,m.GW)();case 9:return o=e.sent,e.next=12,D(null===(n=i.data)||void 0===n?void 0:n.collection,o);case 12:return a=e.sent,e.abrupt("return",a);case 16:e.prev=16,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to get collection",{collectionID:t});case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),U=function(e,t){var n=new Map;t.forEach((function(e){n.has(e.collectionID)||n.set(e.collectionID,e)}));var r,i=[],o=T(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.push({collection:a,file:n.get(a.id)})}}catch(s){o.e(s)}finally{o.f()}return i},H=function(){var e=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",new Set);case 5:return e.abrupt("return",new Set(t.filter((function(e){return e.collectionID===n.id})).map((function(e){return e.id}))));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,a.Z)(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",z(t,_.album,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=(0,a.Z)(c().mark((function e(t,n,r){var i,o,a,s,l,u,d,p,f,h,x,v,g,y,b;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r){e.next=5;break}return e.next=4,M();case 4:r=e.sent;case 5:i=T(r),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=14;break}if((a=o.value).name!==t){e.next=12;break}return e.abrupt("return",a);case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.next=24,new w.ZP;case 24:return s=e.sent,e.next=27,(0,m.GW)();case 27:return l=e.sent,u=(0,m.LP)(),e.next=31,s.generateEncryptionKey();case 31:return d=e.sent,e.next=34,s.encryptToB64(d,l);case 34:return p=e.sent,f=p.encryptedData,h=p.nonce,e.next=39,s.encryptUTF8(t,d);case 39:return x=e.sent,v=x.encryptedData,g=x.nonce,y={id:null,owner:null,encryptedKey:f,keyDecryptionNonce:h,encryptedName:v,nameDecryptionNonce:g,type:n,attributes:{},sharees:null,updationTime:null,isDeleted:!1},e.next=45,W(y,u);case 45:return b=e.sent,e.next=48,D(b,l);case 48:return b=e.sent,e.abrupt("return",b);case 52:throw e.prev=52,e.t1=e.catch(0),(0,O.H)(e.t1,"create collection failed"),e.t1;case 56:case"end":return e.stop()}}),e,null,[[0,52],[6,16,19,22]])})));return function(t,n,r){return e.apply(this,arguments)}}(),W=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.Z.post("".concat(P,"/collections"),t,null,{"X-Auth-Token":n});case 3:return r=e.sent,e.abrupt("return",r.data.collection);case 7:e.prev=7,e.t0=e.catch(0),(0,O.H)(e.t0,"post Collection failed ");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re();case 3:if(n=e.sent){e.next=13;break}return e.next=7,z("Favorites",_.favorites);case 7:return n=e.sent,e.next=10,L();case 10:return r=e.sent,e.next=13,g.Z.setItem(R,[].concat((0,o.Z)(r),[n]));case 13:return e.next=15,Y(n,[t]);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to add to favorite");case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re();case 3:if(n=e.sent){e.next=6;break}throw Error(j.sH.FAV_COLLECTION_MISSING);case 6:return e.next=8,Q(n,[t]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"remove from favorite failed");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,m.LP)(),e.next=4,J(t,n);case 4:return i=e.sent,o={collectionID:t.id,files:i},e.next=8,E.Z.post("".concat(P,"/collections/add-files"),o,null,{"X-Auth-Token":r});case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"Add to collection Failed "),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),K=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,m.LP)(),e.next=4,J(t,n);case 4:return i=e.sent,o={collectionID:t.id,files:i},e.next=8,E.Z.post("".concat(P,"/collections/restore-files"),o,null,{"X-Auth-Token":r});case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"restore to collection Failed "),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),q=function(){var e=(0,a.Z)(c().mark((function e(t,n,r){var i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=(0,m.LP)(),e.next=4,J(n,r);case 4:return o=e.sent,a={fromCollectionID:t,toCollectionID:n.id,files:o},e.next=8,E.Z.post("".concat(P,"/collections/move-files"),a,null,{"X-Auth-Token":i});case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"move to collection Failed "),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),J=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,new w.ZP;case 3:i=e.sent,o=T(n),e.prev=5,o.s();case 7:if((a=o.n()).done){e.next=17;break}return s=a.value,e.next=11,i.encryptToB64(s.key,t.key);case 11:l=e.sent,s.encryptedKey=l.encryptedData,s.keyDecryptionNonce=l.nonce,r.push({id:s.id,encryptedKey:s.encryptedKey,keyDecryptionNonce:s.keyDecryptionNonce});case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(5),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:return e.abrupt("return",r);case 26:case"end":return e.stop()}}),e,null,[[5,19,22,25]])})));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,m.LP)(),i={collectionID:t.id,fileIDs:n.map((function(e){return e.id}))},e.next=5,E.Z.post("".concat(P,"/collections/v2/remove-files"),i,null,{"X-Auth-Token":r});case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,O.H)(e.t0,"remove from collection failed "),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=(0,a.Z)(c().mark((function e(t,n,r,i){var o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=(0,m.LP)(),e.next=4,E.Z.delete("".concat(P,"/collections/v2/").concat(t),null,null,{"X-Auth-Token":o});case 4:return e.next=6,n();case 6:r(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),(0,O.H)(e.t0,"delete collection failed "),i({title:y.Z.ERROR,content:y.Z.DELETE_COLLECTION_FAILED,close:{variant:"danger"}});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n,r,i){return e.apply(this,arguments)}}(),ee=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,m.LP)(),e.next=3,new w.ZP;case 3:return i=e.sent,e.next=6,i.encryptUTF8(n,t.key);case 6:return o=e.sent,a=o.encryptedData,s=o.nonce,l={collectionID:t.id,encryptedName:a,nameDecryptionNonce:s},e.next=12,E.Z.post("".concat(P,"/collections/rename"),l,null,{"X-Auth-Token":r});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),te=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new w.ZP;case 3:return r=e.sent,i=(0,m.LP)(),e.next=7,(0,b.$3)(n);case 7:return o=e.sent,e.next=10,r.boxSeal(t.key,o);case 10:return a=e.sent,s={collectionID:t.id,email:n,encryptedKey:a},e.next=14,E.Z.post("".concat(P,"/collections/share"),s,null,{"X-Auth-Token":i});case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),(0,O.H)(e.t0,"share collection failed "),e.t0;case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t,n){return e.apply(this,arguments)}}(),ne=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(0,m.LP)(),i={collectionID:t.id,email:n},e.next=5,E.Z.post("".concat(P,"/collections/unshare"),i,null,{"X-Auth-Token":r});case 5:e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),(0,O.H)(e.t0,"unshare collection failed "),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=(0,a.Z)(c().mark((function e(){var t,n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=e.sent,n=T(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=12;break}if((i=r.value).type!==_.favorites){e.next=10;break}return e.abrupt("return",i);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,null,[[4,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),ie=function(e,t){var n,r=new Set,i=T(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.add(o.collectionID)}}catch(a){i.e(a)}finally{i.f()}return e.filter((function(e){return r.has(e.id)}))};function oe(e,t,n){return function(e){return e.sort((function(e,t){return e.type===_.favorites?-1:t.type===_.favorites?1:0}))}(e.sort((function(e,r){switch(n){case k.LATEST_FILE:return function(e,t,n){if(null===e||void 0===e||!e.length)return 0;var r=ae(e,t),i=ae(e,n);return r&&i?(0,I.hE)([r,i])[0].id!==r.id?1:-1:0}(t,e,r);case k.MODIFICATION_TIME:return r.updationTime-e.updationTime;case k.NAME:return e.name.localeCompare(r.name)}})))}function ae(e,t){var n=e.filter((function(e){return e.collection.id===t.id}));if(1===n.length)return n[0].file}var se=n(27145),ce=n(99424),le=n(85893);function ue(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:(0,le.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})})}function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ue.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var fe=f.ZP.div.withConfig({displayName:"FullScreenDropZone__CloseButtonWrapper",componentId:"sc-4vwa7i-0"})(["position:absolute;top:10px;right:10px;cursor:pointer;"]),he=f.ZP.div.withConfig({displayName:"FullScreenDropZone__DropDiv",componentId:"sc-4vwa7i-1"})(["flex:1;display:flex;flex-direction:column;"]),xe=f.ZP.div.withConfig({displayName:"FullScreenDropZone__Overlay",componentId:"sc-4vwa7i-2"})(["border-width:8px;left:0;top:0;outline:none;transition:border 0.24s ease-in-out;height:100%;width:100%;display:flex;justify-content:center;align-items:center;color:#fff;font-size:24px;font-weight:900;text-align:center;position:absolute;border-color:#51cd7c;border-style:solid;background:rgba(0,0,0,0.9);z-index:3000;"]);function ve(e){var t=(0,l.useState)(!1),n=t[0],r=t[1],i=function(){return r(!1)};return(0,l.useEffect)((function(){window.addEventListener("keydown",(function(e){"Escape"===e.code&&i()}))}),[]),(0,le.jsxs)(he,pe(pe({},e.getRootProps({onDragEnter:function(){return r(!0)}})),{},{children:[(0,le.jsx)("input",pe({},e.getInputProps())),n&&(0,le.jsxs)(xe,{onDrop:i,onDragLeave:i,children:[(0,le.jsx)(fe,{onClick:i,children:(0,le.jsx)(ue,{})}),y.Z.UPLOAD_DROPZONE_MESSAGE]}),e.children]}))}var ge,me=n(73190),we=n(35005),ye=n(59134),be=n.n(ye);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e){switch(e){case ge.success:return"#51cd7c";case ge.danger:return"#c93f3f";case ge.secondary:return"#858585";case ge.warning:return"#D7BB63";default:return"#d1d1d1"}}function Ie(e){var t;return(0,le.jsx)("h5",{style:Oe({color:je(e.variant),cursor:"pointer",marginBottom:0},e.style),onClick:null!==(t=null===e||void 0===e?void 0:e.onClick)&&void 0!==t?t:function(){return null},children:e.children})}!function(e){e.success="success",e.danger="danger",e.secondary="secondary",e.warning="warning"}(ge||(ge={}));var Te=n(31262),Se=n(24118),Ce=n(39151),Ze=n(61975),_e=n(76640),Pe=n(89862),ke=n(94785);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var De,Ne,Le,Fe,Me=function(e){var t=(0,u.useRouter)(),n=(0,l.useState)(!1),r=n[0],i=n[1],o=(0,l.useContext)(Se.AppContext);(0,l.useEffect)((function(){var t;if(e.show){var n=null!==(t=(0,v.Yu)(v.Pd.USER).isTwoFactorEnabled)&&void 0!==t&&t;i(n),function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.bW)();case 2:t=e.sent,i(t),(0,v.a_)(v.Pd.USER,Re(Re({},(0,v.Yu)(v.Pd.USER)),{},{isTwoFactorEnabled:!1}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}}),[e.show]);var s=function(){var t=(0,a.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setDialogMessage({title:y.Z.DISABLE_TWO_FACTOR,staticBackdrop:!0,content:y.Z.DISABLE_TWO_FACTOR_MESSAGE,close:{text:y.Z.CANCEL},proceed:{variant:"danger",text:y.Z.DISABLE,action:d}});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var t=(0,a.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,b.XB)();case 3:(0,v.a_)(v.Pd.USER,Re(Re({},(0,v.Yu)(v.Pd.USER)),{},{isTwoFactorEnabled:!1})),e.onHide(),e.closeSidebar(),o.setDisappearingFlashMessage({message:y.Z.TWO_FACTOR_DISABLE_SUCCESS,type:Se.FLASH_MESSAGE_TYPE.INFO}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),o.setDisappearingFlashMessage({message:y.Z.TWO_FACTOR_DISABLE_FAILED,type:Se.FLASH_MESSAGE_TYPE.DANGER});case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}(),p=function(){var t=(0,a.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setDialogMessage({title:y.Z.UPDATE_TWO_FACTOR,staticBackdrop:!0,content:y.Z.UPDATE_TWO_FACTOR_MESSAGE,close:{text:y.Z.CANCEL},proceed:{variant:"success",text:y.Z.UPDATE,action:f}});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push(_e.q5.TWO_FACTOR_SETUP);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,le.jsx)(ke.Z,{show:e.show,onHide:e.onHide,attributes:{title:y.Z.TWO_FACTOR_AUTHENTICATION,staticBackdrop:!0},children:(0,le.jsx)("div",Re(Re({},r?{style:{padding:"10px"}}:{style:{padding:"10px 10px 30px 10px"}}),{},{children:r?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{children:y.Z.UPDATE_TWO_FACTOR_HINT}),(0,le.jsx)(Pe.B4,{children:(0,le.jsx)(we.Z,{variant:"outline-success",onClick:p,style:{width:"100%"},children:y.Z.RECONFIGURE})})]}),(0,le.jsxs)(Pe.X2,{children:[(0,le.jsxs)(Pe.__,{children:[y.Z.DISABLE_TWO_FACTOR_HINT," "]}),(0,le.jsx)(Pe.B4,{children:(0,le.jsx)(we.Z,{variant:"outline-danger",onClick:s,style:{width:"100%"},children:y.Z.DISABLE})})]})]}):(0,le.jsxs)(Ra,{children:[(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"36px",viewBox:"0 0 24 24",width:"36px",fill:"#000000",children:[(0,le.jsxs)("g",{fill:"none",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z"}),(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",opacity:".87"})]}),(0,le.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"})]}),(0,le.jsx)("p",{}),(0,le.jsx)("p",{children:y.Z.TWO_FACTOR_INFO}),(0,le.jsx)("div",{style:{height:"10px"}}),(0,le.jsx)(we.Z,{variant:"outline-success",onClick:function(){return t.push(_e.q5.TWO_FACTOR_SETUP)},children:y.Z.ENABLE_TWO_FACTOR})]})}))})},Be=n(68216),Ue=n(25997),He=n(4769),Ge=function(e){return"".concat(e.id,"_").concat(e.collectionID,"_").concat(e.updationTime)},ze=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set(null===n||void 0===n?void 0:n.queuedFiles),i=t.filter((function(e){if(r.has(Ge(e)))return e})),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),We=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set(null===n||void 0===n?void 0:n.exportedFiles),i=t.filter((function(e){if(!r.has(Ge(e)))return e})),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set(null===n||void 0===n?void 0:n.failedFiles),i=t.filter((function(e){if(r.has(Ge(e)))return e})),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xe=function(e){var t=new Set(e);return(0,He.Z)(Array,(0,o.Z)(t))},Ye=n(22656),Ke=n(39903),qe=n(79736);function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.INIT=0]="INIT",e[e.INPROGRESS=1]="INPROGRESS",e[e.PAUSED=2]="PAUSED",e[e.FINISHED=3]="FINISHED"}(De||(De={})),function(e){e.START="export started",e.IN_PROGRESS="export already in progress",e.FINISH="export finished",e.FAILED="export failed",e.ABORT="export aborted",e.PAUSE="export paused",e.UP_TO_DATE="no new files to export"}(Ne||(Ne={})),function(e){e.SUCCESS="success",e.FAILED="failed"}(Le||(Le={})),function(e){e[e.NEW=0]="NEW",e[e.PENDING=1]="PENDING",e[e.RETRY_FAILED=2]="RETRY_FAILED"}(Fe||(Fe={}));var tt="export_status.json",nt="metadata",rt=new(function(){function e(){var t=this;(0,Be.Z)(this,e),(0,r.Z)(this,"ElectronAPIs",void 0),(0,r.Z)(this,"exportInProgress",null),(0,r.Z)(this,"recordUpdateInProgress",Promise.resolve()),(0,r.Z)(this,"stopExport",!1),(0,r.Z)(this,"pauseExport",!1),(0,r.Z)(this,"isExportInProgress",(function(){return null!==t.exportInProgress})),this.ElectronAPIs=(0,Te.S2)()&&window.ElectronAPIs}return(0,Ue.Z)(e,[{key:"selectExportDirectory",value:function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ElectronAPIs.selectRootDirectory();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopRunningExport",value:function(){this.stopExport=!0}},{key:"pauseRunningExport",value:function(){this.pauseExport=!0}},{key:"exportFiles",value:function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s,l,u,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.exportInProgress){e.next=3;break}return this.ElectronAPIs.sendNotification(Ne.IN_PROGRESS),e.abrupt("return",this.exportInProgress);case 3:if(this.ElectronAPIs.showOnTray("starting export"),i=null===(r=(0,v.Yu)(v.Pd.EXPORT))||void 0===r?void 0:r.folder){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,(0,p.dm)();case 9:return a=e.sent,e.next=12,L();case 12:return s=e.sent,l=ie(s,a),e.next=16,this.getExportRecord(i);case 16:if(u=e.sent,n!==Fe.NEW){e.next=23;break}return e.next=20,We(a,u);case 20:o=e.sent,e.next=32;break;case 23:if(n!==Fe.RETRY_FAILED){e.next=29;break}return e.next=26,Ve(a,u);case 26:o=e.sent,e.next=32;break;case 29:return e.next=31,ze(a,u);case 31:o=e.sent;case 32:return this.exportInProgress=this.fileExporter(o,l,t,i),e.next=35,this.exportInProgress;case 35:return d=e.sent,this.exportInProgress=null,e.abrupt("return",d);case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fileExporter",value:function(){var e=(0,a.Z)(c().mark((function e(t,n,r,o){var a,s,l,u,d,p,f,h,x,v,g,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null!==t&&void 0!==t&&t.length){e.next=4;break}return this.ElectronAPIs.sendNotification(Ne.UP_TO_DATE),e.abrupt("return",{paused:!1});case 4:this.stopExport=!1,this.pauseExport=!1,this.addFilesQueuedRecord(o,t),a=0,this.ElectronAPIs.showOnTray({export_progress:"0 / ".concat(t.length," files exported")}),r({current:0,total:t.length}),this.ElectronAPIs.sendNotification(Ne.START),s=new Map,l=$e(n),e.prev=13,l.s();case 15:if((u=l.n()).done){e.next=25;break}return d=u.value,p="".concat(o,"/").concat(d.id,"_").concat(this.sanitizeName(d.name)),e.next=20,this.ElectronAPIs.checkExistsAndCreateCollectionDir(p);case 20:return e.next=22,this.ElectronAPIs.checkExistsAndCreateCollectionDir("".concat(p,"/").concat(nt));case 22:s.set(d.id,p);case 23:e.next=15;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(13),l.e(e.t0);case 30:return e.prev=30,l.f(),e.finish(30);case 33:f=$e(t.entries()),e.prev=34,f.s();case 36:if((h=f.n()).done){e.next=58;break}if(x=(0,i.Z)(h.value,2),v=x[0],g=x[1],!this.stopExport&&!this.pauseExport){e.next=41;break}return this.pauseExport&&this.ElectronAPIs.showOnTray({export_progress:"".concat(v," / ").concat(t.length," files exported (paused)"),paused:!0}),e.abrupt("break",58);case 41:return m=s.get(g.collectionID),e.prev=42,e.next=45,this.downloadAndSave(g,m);case 45:return e.next=47,this.addFileExportRecord(o,g,Le.SUCCESS);case 47:e.next=54;break;case 49:return e.prev=49,e.t1=e.catch(42),e.next=53,this.addFileExportRecord(o,g,Le.FAILED);case 53:(0,O.H)(e.t1,"download and save failed for file during export");case 54:this.ElectronAPIs.showOnTray({export_progress:"".concat(v+1," / ").concat(t.length," files exported")}),r({current:v+1,total:t.length});case 56:e.next=36;break;case 58:e.next=63;break;case 60:e.prev=60,e.t2=e.catch(34),f.e(e.t2);case 63:return e.prev=63,f.f(),e.finish(63);case 66:if(!this.stopExport){e.next=71;break}this.ElectronAPIs.sendNotification(Ne.ABORT),this.ElectronAPIs.showOnTray(),e.next=77;break;case 71:if(!this.pauseExport){e.next=76;break}return this.ElectronAPIs.sendNotification(Ne.PAUSE),e.abrupt("return",{paused:!0});case 76:a>0?(this.ElectronAPIs.sendNotification(Ne.FAILED),this.ElectronAPIs.showOnTray({retry_export:"export failed - retry export"})):(this.ElectronAPIs.sendNotification(Ne.FINISH),this.ElectronAPIs.showOnTray());case 77:return e.abrupt("return",{paused:!1});case 80:e.prev=80,e.t3=e.catch(0),(0,O.H)(e.t3,"export failed ");case 83:case"end":return e.stop()}}),e,this,[[0,80],[13,27,30,33],[34,60,63,66],[42,49]])})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"addFilesQueuedRecord",value:function(){var e=(0,a.Z)(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getExportRecord(t);case 2:return(r=e.sent).queuedFiles=n.map(Ge),e.next=6,this.updateExportRecord(r,t);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addFileExportRecord",value:function(){var e=(0,a.Z)(c().mark((function e(t,n,r){var i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ge(n),e.next=3,this.getExportRecord(t);case 3:return(o=e.sent).queuedFiles=o.queuedFiles.filter((function(e){return e!==i})),r===Le.SUCCESS?(o.exportedFiles||(o.exportedFiles=[]),o.exportedFiles.push(i),o.failedFiles&&(o.failedFiles=o.failedFiles.filter((function(e){return e!==i})))):(o.failedFiles||(o.failedFiles=[]),o.failedFiles.find((function(e){return e===i}))||o.failedFiles.push(i)),o.exportedFiles=Xe(o.exportedFiles),o.queuedFiles=Xe(o.queuedFiles),o.failedFiles=Xe(o.failedFiles),e.next=11,this.updateExportRecord(o,t);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateExportRecord",value:function(){var e=(0,a.Z)(c().mark((function e(t,n){var r=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.recordUpdateInProgress;case 2:this.recordUpdateInProgress=(0,a.Z)(c().mark((function e(){var i,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n||(n=null===(i=(0,v.Yu)(v.Pd.EXPORT))||void 0===i?void 0:i.folder),e.next=4,r.getExportRecord(n);case 4:return o=e.sent,a=Qe(Qe({},o),t),e.next=8,r.ElectronAPIs.setExportRecord("".concat(n,"/").concat(tt),JSON.stringify(a,null,2));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"error updating Export Record");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getExportRecord",value:function(){var e=(0,a.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.recordUpdateInProgress;case 3:return t||(t=null===(n=(0,v.Yu)(v.Pd.EXPORT))||void 0===n?void 0:n.folder),e.next=6,this.ElectronAPIs.getExportRecord("".concat(t,"/").concat(tt));case 6:if(!(r=e.sent)){e.next=11;break}return e.abrupt("return",JSON.parse(r));case 11:return e.abrupt("return",{});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),(0,O.H)(e.t0,"export Record JSON parsing failed ");case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadAndSave",value:function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(t.id,"_").concat(this.sanitizeName(t.metadata.title)),e.next=3,(0,Ye.S)((function(){return Ke.Z.downloadFile(t)}));case 3:i=e.sent,t.metadata.fileType===p.Gk.LIVE_PHOTO?this.exportMotionPhoto(i,t,n):(this.saveMediaFile(n,r,i),this.saveMetadataFile(n,r,t.metadata));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exportMotionPhoto",value:function(){var e=(0,a.Z)(c().mark((function e(t,n,r){var i,o,a,s,l,u,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Response(t).blob();case 2:return i=e.sent,o=(0,I.AA)(n.metadata.title),e.next=6,(0,qe.Z)(i,o);case 6:a=e.sent,s=(0,I.jR)(a.image),l="".concat(n.id,"_").concat(a.imageNameTitle),this.saveMediaFile(r,l,s),this.saveMetadataFile(r,l,n.metadata),u=(0,I.jR)(a.video),d="".concat(n.id,"_").concat(a.videoNameTitle),this.saveMediaFile(r,d,u),this.saveMetadataFile(r,d,n.metadata);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveMediaFile",value:function(e,t,n){this.ElectronAPIs.saveStreamToDisk("".concat(e,"/").concat(t),n)}},{key:"saveMetadataFile",value:function(e,t,n){this.ElectronAPIs.saveFileToDisk("".concat(e,"/").concat(nt,"/").concat(t,".json"),function(e,t){var n=Math.floor(t.creationTime/1e6),r=Math.floor(t.modificationTime/1e6);return JSON.stringify({title:e,creationTime:{timestamp:n,formatted:(0,I.p6)(1e3*n)},modificationTime:{timestamp:r,formatted:(0,I.p6)(1e3*r)},geoData:{latitude:t.latitude,longitude:t.longitude}},null,2)}(t,n))}},{key:"sanitizeName",value:function(e){return e.replaceAll("/","_").replaceAll(" ","_")}}]),e}()),it=n(51479),ot=f.ZP.span.withConfig({displayName:"ExportInProgress__ComfySpan",componentId:"sc-u3y5df-0"})(["word-spacing:1rem;color:#ddd;"]);function at(e){return(0,le.jsx)(le.Fragment,{children:(0,le.jsxs)("div",{style:{marginBottom:"30px",padding:"0 5%",display:"flex",alignItems:"center",flexDirection:"column"},children:[(0,le.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,le.jsxs)(ot,{children:[" ",e.exportProgress.current," /"," ",e.exportProgress.total," "]})," ",(0,le.jsxs)("span",{style:{marginLeft:"10px"},children:[" ","files exported"," ",e.exportStage===De.PAUSED&&"(paused)"]})]}),(0,le.jsx)("div",{style:{width:"100%",marginBottom:"30px"},children:(0,le.jsx)(it.Z,{now:Math.round(100*e.exportProgress.current/e.exportProgress.total),animated:!(e.exportStage===De.PAUSED),variant:"upload-progress-bar"})}),(0,le.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around"},children:[e.exportStage===De.PAUSED?(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:e.resumeExport,children:y.Z.RESUME}):(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:e.pauseExport,children:y.Z.PAUSE}),(0,le.jsx)("div",{style:{width:"30px"}}),(0,le.jsx)(we.Z,{block:!0,variant:"outline-danger",onClick:e.cancelExport,children:y.Z.CANCEL})]})]})})}function st(e){var t=e.exportStats.failed+e.exportStats.success;return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("div",{style:{borderBottom:"1px solid #444",marginBottom:"20px",padding:"0 5%"},children:[(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"40%",children:y.Z.LAST_EXPORT_TIME}),(0,le.jsx)(Pe.B4,{width:"60%",children:(0,I.o0)(e.lastExportTime)})]}),(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"60%",children:y.Z.SUCCESSFULLY_EXPORTED_FILES}),(0,le.jsx)(Pe.B4,{width:"35%",children:(0,le.jsxs)(ot,{children:[e.exportStats.success," / ",t]})})]}),e.exportStats.failed>0&&(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"60%",children:y.Z.FAILED_EXPORTED_FILES}),(0,le.jsx)(Pe.B4,{width:"35%",children:(0,le.jsxs)(ot,{children:[e.exportStats.failed," / ",t]})})]})]}),(0,le.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around"},children:[(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:e.onHide,children:y.Z.CLOSE}),(0,le.jsx)("div",{style:{width:"30px"}}),0!==e.exportStats.failed?(0,le.jsx)(we.Z,{block:!0,variant:"outline-danger",onClick:e.retryFailed,children:y.Z.RETRY_EXPORT_}):(0,le.jsx)(we.Z,{block:!0,variant:"outline-success",onClick:e.exportFiles,children:y.Z.EXPORT_AGAIN})]})]})}function ct(e){return(0,le.jsx)(le.Fragment,{children:(0,le.jsx)(Ra,{children:(0,le.jsx)(we.Z,{variant:"outline-success",size:"lg",style:{padding:"6px 3em",margin:"0 20px",marginBottom:"20px",flex:1,whiteSpace:"nowrap"},onClick:e.startExport,children:y.Z.START})})})}function lt(e){return(0,le.jsx)("div",{children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"#000000",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"})]})})}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}lt.defaultProps={height:24,width:24,viewBox:"0 0 24 24",open:!1};var pt=f.ZP.div.withConfig({displayName:"InProgressIcon__Rotate",componentId:"sc-1ityfjr-0"})(["width:24px;height:27px;",";cursor:",";transition-duration:0.8s;transition-property:transform;&:hover{color:#fff;transform:rotate(90deg);-webkit-transform:rotate(90deg);}"],(function(e){return!e.disabled&&"-webkit-animation: rotation 1s infinite linear"}),(function(e){return e.disabled&&"pointer"}));function ft(e){return(0,le.jsx)(pt,dt(dt({},e),{},{children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"#000000",children:[(0,le.jsx)("path",{d:"M.01 0h24v24h-24V0z",fill:"none"}),(0,le.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})]})}))}function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ft.defaultProps={disabled:!1,height:24,width:24,viewBox:"0 0 24 24"};var vt=f.ZP.div.withConfig({displayName:"ExportModal__FolderIconWrapper",componentId:"sc-vq1425-0"})(["width:15%;margin-left:10px;cursor:pointer;padding:3px;border:1px solid #444;border-radius:15%;&:hover{background-color:#444;}"]),gt=f.ZP.span.withConfig({displayName:"ExportModal__ExportFolderPathContainer",componentId:"sc-vq1425-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:200px;direction:rtl;text-align:left;"]);function mt(e){var t=(0,l.useState)(De.INIT),n=t[0],r=t[1],i=(0,l.useState)(""),s=i[0],u=i[1],d=(0,l.useState)(""),f=d[0],h=d[1],x=(0,l.useState)({current:0,total:0}),g=x[0],m=x[1],w=(0,l.useState)({failed:0,success:0}),b=w[0],E=w[1],O=(0,l.useState)(0),j=O[0],I=O[1];(0,l.useEffect)((function(){var e;be()()&&(u(null===(e=(0,v.Yu)(v.Pd.EXPORT))||void 0===e?void 0:e.folder),rt.ElectronAPIs.registerStopExportListener(k),rt.ElectronAPIs.registerPauseExportListener(A),rt.ElectronAPIs.registerResumeExportListener(R),rt.ElectronAPIs.registerRetryFailedExportListener(D))}),[]),(0,l.useEffect)((function(){s&&function(){var e=(0,a.Z)(c().mark((function e(){var t,n,i,o,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.getExportRecord();case 2:l=e.sent,r(null!==(t=null===l||void 0===l?void 0:l.stage)&&void 0!==t?t:De.INIT),I(null===l||void 0===l?void 0:l.lastAttemptTimestamp),m(null!==(n=null===l||void 0===l?void 0:l.progress)&&void 0!==n?n:{current:0,total:0}),E({success:null!==(i=null===l||void 0===l||null===(o=l.exportedFiles)||void 0===o?void 0:o.length)&&void 0!==i?i:0,failed:null!==(a=null===l||void 0===l||null===(s=l.failedFiles)||void 0===s?void 0:s.length)&&void 0!==a?a:0}),(null===l||void 0===l?void 0:l.stage)===De.INPROGRESS&&R();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[s]),(0,l.useEffect)((function(){e.show&&function(){var e=(0,a.Z)(c().mark((function e(){var t,r,i,a,l,u,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!==De.FINISHED){e.next=11;break}return e.next=3,(0,p.dm)();case 3:return t=e.sent,e.next=6,rt.getExportRecord();case 6:r=e.sent,i=r.exportedFiles.length,a=r.failedFiles.length,(l=t.length)>i+a&&(C({current:i+a,total:l}),u=new Set([].concat((0,o.Z)(r.exportedFiles),(0,o.Z)(r.failedFiles))),d=t.filter((function(e){return!u.has(Ge(e))})),rt.addFilesQueuedRecord(s,d),S(De.PAUSED));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[e.show]),(0,l.useEffect)((function(){h(e.usage)}),[e.usage]);var T=function(e){u(e),(0,v.a_)(v.Pd.EXPORT,{folder:e})},S=function(e){r(e),rt.updateExportRecord({stage:e})},C=function(e){m(e),rt.updateExportRecord({progress:e})},Z=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=(0,v.Yu)(v.Pd.EXPORT))||void 0===t?void 0:t.folder){e.next=7;break}return e.next=4,L();case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return S(De.INPROGRESS),e.next=10,(0,Te._v)(100);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,a.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return S(De.FINISHED),e.next=4,(0,Te._v)(100);case 4:n=Date.now(),I(n),rt.updateExportRecord({time:n}),N();case 6:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return C({current:0,total:0}),e.next=5,rt.exportFiles(C,Fe.NEW);case 5:return t=e.sent,n=t.paused,e.next=9,_(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:rt.stopRunningExport(),_(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){S(De.PAUSED),rt.pauseRunningExport(),_(!0)},R=function(){var e=(0,a.Z)(c().mark((function e(){var t,n,r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.getExportRecord();case 2:return t=e.sent,e.next=5,Z();case 5:return n=t.progress,m(n),r=function(e){return C({current:n.current+e.current,total:n.current+e.total})},e.next=10,rt.exportFiles(r,Fe.PENDING);case 10:return i=e.sent,o=i.paused,e.next=14,_(o);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return C({current:0,total:b.failed}),e.next=5,rt.exportFiles(C,Fe.RETRY_FAILED);case 5:return t=e.sent,n=t.paused,e.next=9,_(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,a.Z)(c().mark((function e(){var t,n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.getExportRecord();case 2:o=e.sent,a=null!==(t=null===o||void 0===o||null===(n=o.failedFiles)||void 0===n?void 0:n.length)&&void 0!==t?t:0,s=null!==(r=null===o||void 0===o||null===(i=o.exportedFiles)||void 0===i?void 0:i.length)&&void 0!==r?r:0,E({failed:a,success:s});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.selectExportDirectory();case 2:if(!(t=e.sent)){e.next=8;break}return T(t),e.abrupt("return",!0);case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){switch(n){case De.INIT:return(0,le.jsx)(ct,xt(xt({},e),{},{exportFolder:s,exportSize:f,updateExportFolder:T,startExport:P,selectExportDirectory:L}));case De.INPROGRESS:case De.PAUSED:return(0,le.jsx)(at,xt(xt({},e),{},{exportFolder:s,exportSize:f,exportStage:n,exportProgress:g,resumeExport:R,cancelExport:k,pauseExport:A}));case De.FINISHED:return(0,le.jsx)(st,xt(xt({},e),{},{exportFolder:s,exportSize:f,updateExportFolder:T,lastExportTime:j,exportStats:b,exportFiles:P,retryFailed:D}));default:return(0,le.jsx)(le.Fragment,{})}};return(0,le.jsxs)(ke.Z,{show:e.show,onHide:e.onHide,attributes:{title:y.Z.EXPORT_DATA},children:[(0,le.jsxs)("div",{style:{borderBottom:"1px solid #444",marginBottom:"20px",padding:"0 5%",width:"450px"},children:[(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"40%",children:y.Z.DESTINATION}),(0,le.jsx)(Pe.B4,{width:"60%",children:s?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(gt,{children:s}),(n===De.FINISHED||n===De.INIT)&&(0,le.jsx)(vt,{onClick:L,children:(0,le.jsx)(lt,{})})]}):(0,le.jsx)(we.Z,{variant:"outline-success",size:"sm",onClick:L,children:y.Z.SELECT_FOLDER})})]}),(0,le.jsxs)(Pe.X2,{children:[(0,le.jsxs)(Pe.__,{width:"40%",children:[y.Z.TOTAL_EXPORT_SIZE," "]}),(0,le.jsx)(Pe.B4,{width:"60%",children:f?"".concat(f):(0,le.jsx)(ft,{})})]})]}),(0,le.jsx)(F,{})]})}var wt=n(48193),yt=n(78961),bt=n(66800),Et=n(94716),Ot=n(31555),jt=n(75147),It=n(43514);var Tt=function(e){var t,n,r=(0,l.useState)(!1),i=r[0],o=r[1],s=function(){var t=(0,a.Z)(c().mark((function t(n,r){var i,a,s,l,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.email,a=r.resetForm,s=r.setFieldError,t.prev=2,o(!0),l=(0,v.Yu)(v.Pd.USER),i!==l.email){t.next=9;break}s("email",y.Z.SHARE_WITH_SELF),t.next=18;break;case 9:if(!e.collection.sharees.find((function(e){return e.email===i}))){t.next=13;break}s("email",y.Z.ALREADY_SHARED(i)),t.next=18;break;case 13:return t.next=15,te(e.collection,i);case 15:return t.next=17,e.syncWithRemote();case 17:a();case 18:t.next=34;break;case 20:t.prev=20,t.t0=t.catch(2),u=null,t.t1=null===t.t0||void 0===t.t0?void 0:t.t0.status,t.next=400===t.t1?26:402===t.t1?28:404===t.t1?30:32;break;case 26:return u=y.Z.SHARING_BAD_REQUEST_ERROR,t.abrupt("break",33);case 28:return u=y.Z.SHARING_DISABLED_FOR_FREE_ACCOUNTS,t.abrupt("break",33);case 30:return u=y.Z.USER_DOES_NOT_EXIST,t.abrupt("break",33);case 32:u="".concat(y.Z.UNKNOWN_ERROR," ").concat(t.t0.message);case 33:s("email",u);case 34:return t.prev=34,o(!1),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[2,20,34,37]])})));return function(e,n){return t.apply(this,arguments)}}(),u=function(){var t=(0,a.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ne(e.collection,n.email);case 2:return t.next=4,e.syncWithRemote();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(e){var t=e.sharee,n=e.collectionUnshare;return(0,le.jsxs)("tr",{children:[(0,le.jsx)("td",{children:t.email}),(0,le.jsx)("td",{children:(0,le.jsx)(we.Z,{variant:"outline-danger",style:{height:"25px",lineHeight:0,padding:0,width:"25px",fontSize:"1.2em",fontWeight:900},onClick:function(){return n(t)},children:"-"})})]})};return(0,le.jsx)(ke.Z,{show:e.show,onHide:e.onHide,attributes:{title:y.Z.SHARE_COLLECTION},children:(0,le.jsxs)(Ra,{style:{width:"85%",margin:"auto"},children:[(0,le.jsx)("h6",{style:{marginTop:"8px"},children:y.Z.SHARE_WITH_PEOPLE}),(0,le.jsx)("p",{}),(0,le.jsx)(wt.J9,{initialValues:{email:""},validationSchema:yt.Ry().shape({email:yt.Z_().email(y.Z.EMAIL_ERROR).required(y.Z.REQUIRED)}),validateOnChange:!1,validateOnBlur:!1,onSubmit:s,children:function(e){var t=e.values,n=e.errors,r=e.touched,o=e.handleChange,a=e.handleSubmit;return(0,le.jsx)(bt.Z,{noValidate:!0,onSubmit:a,children:(0,le.jsxs)(bt.Z.Row,{children:[(0,le.jsxs)(bt.Z.Group,{as:Ot.Z,xs:10,controlId:"formHorizontalEmail",children:[(0,le.jsx)(bt.Z.Control,{type:"email",placeholder:y.Z.ENTER_EMAIL,value:t.email,onChange:o("email"),isInvalid:Boolean(r.email&&n.email),autoFocus:!0,disabled:i}),(0,le.jsx)(Et.Z.Feedback,{type:"invalid",children:n.email})]}),(0,le.jsx)(bt.Z.Group,{as:Ot.Z,xs:2,controlId:"formHorizontalEmail",children:(0,le.jsx)(It.Z,{loading:i,inline:!0,buttonText:"+"})})]})})}}),(0,le.jsx)("div",{style:{height:"1px",margin:"10px 0px",background:"#444",width:"100%"}}),(null===(t=e.collection)||void 0===t?void 0:t.sharees.length)>0?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("p",{children:y.Z.SHAREES}),(0,le.jsx)(jt.Z,{striped:!0,bordered:!0,hover:!0,variant:"dark",size:"sm",children:(0,le.jsx)("tbody",{children:null===(n=e.collection)||void 0===n?void 0:n.sharees.map((function(e){return(0,le.jsx)(d,{sharee:e,collectionUnshare:u},e.email)}))})})]}):(0,le.jsx)("div",{style:{marginTop:"12px"},children:y.Z.ZERO_SHAREES()})]})})},St=n(10219);function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _t(e){return(0,le.jsxs)("svg",Zt(Zt({xmlns:"http://www.w3.org/2000/svg",height:"40",viewBox:"0 0 24 24",width:"24px",fill:"currentColor"},e),{},{children:[(0,le.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,le.jsx)("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})]}))}_t.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var Pt,kt=["scrollDirection"];function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.LEFT=-1]="LEFT",e[e.RIGHT=1]="RIGHT"}(Pt||(Pt={}));var Dt,Nt=f.ZP.button.withConfig({displayName:"NavigationButton__Wrapper",componentId:"sc-1ls0fk1-0"})(["height:40px;width:40px;background-color:#191919;border:none;color:#eee;z-index:1;position:absolute;"," "," & > svg{"," border-radius:50%;height:30px;width:30px;}&:hover > svg{background-color:#555;}&:hover{color:#fff;}&::after{content:' ';background:linear-gradient( to ",",#191919 5%,rgba(255,255,255,0) 80% );position:absolute;top:0;width:40px;height:40px;","}"],(function(e){return e.direction===Pt.LEFT?"margin-right: 10px;":"margin-left: 10px;"}),(function(e){return e.direction===Pt.LEFT?"left: 0;":"right: 0;"}),(function(e){return e.direction===Pt.LEFT&&"transform:rotate(180deg);"}),(function(e){return e.direction===Pt.LEFT?"right":"left"}),(function(e){return e.direction===Pt.LEFT?"left: 40px;":"right: 40px;"})),Lt=function(e){var t=e.scrollDirection,n=(0,St.Z)(e,kt);return(0,le.jsx)(Nt,Rt(Rt({direction:t},n),{},{children:(0,le.jsx)(_t,{})}))},Ft=n(43489),Mt=n(73079);function Bt(e,t,n,r,i,o){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,a.Z)(c().mark((function e(t,n,r,i,o,a){var s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(!1),s=(0,I.Rb)(r,i),e.t0=t,e.next=e.t0===Dt.ADD?5:e.t0===Dt.MOVE?8:e.t0===Dt.REMOVE?11:e.t0===Dt.RESTORE?14:17;break;case 5:return e.next=7,Y(a,s);case 7:return e.abrupt("break",18);case 8:return e.next=10,q(r.collectionID,a,s);case 10:return e.abrupt("break",18);case 11:return e.next=13,Q(a,s);case 13:return e.abrupt("break",18);case 14:return e.next=16,K(a,s);case 16:return e.abrupt("break",18);case 17:throw Error(j.sH.INVALID_COLLECTION_OPERATION);case 18:o(a.id);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ht(e,t){return t.find((function(t){return t.id===e}))}function Gt(e,t){var n=(0,v.Yu)(v.Pd.USER),r=Ht(e,t);return!!r&&(null===r||void 0===r?void 0:r.owner.id)!==n.id}function zt(e,t){var n=Ht(e,t);return!!n&&n.type===_.favorites}!function(e){e[e.ADD=0]="ADD",e[e.MOVE=1]="MOVE",e[e.REMOVE=2]="REMOVE",e[e.RESTORE=3]="RESTORE"}(Dt||(Dt={}));var Wt=n(19698),Vt=n(19611),Xt=["children"];function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qt=function(e){var t=e.children,n=(0,St.Z)(e,Xt);return(0,le.jsx)(Ie,Kt(Kt({style:{fontSize:"14px",fontWeight:700,padding:"8px 1em"}},n),{},{children:t}))},Jt=function(e){return(0,le.jsx)(Wt.Z.Item,{style:{display:"flex",alignItems:"center",justifyContent:"center",background:"#282828",padding:0},children:e.children})},Qt=function(e){var t=function(){var t=(0,a.Z)(c().mark((function t(n,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.name===r){t.next=4;break}return t.next=3,ee(n,r);case 3:e.syncWithRemote();case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return(0,le.jsx)(Vt.Z,{id:"collection-options",style:{borderRadius:"10px"},children:(0,le.jsx)(Vt.Z.Content,{style:{padding:0,border:"none"},children:(0,le.jsxs)(Wt.Z,{style:{borderRadius:"8px"},children:[(0,le.jsx)(Jt,{children:(0,le.jsx)(qt,{onClick:function(){var n;e.setCollectionNamerAttributes({title:y.Z.RENAME_COLLECTION,buttonText:y.Z.RENAME,autoFilledName:null===(n=Ht(e.selectedCollectionID,e.collections))||void 0===n?void 0:n.name,callback:function(n){e.startLoadingBar(),t(Ht(e.selectedCollectionID,e.collections),n)}})},children:y.Z.RENAME})}),(0,le.jsx)(Jt,{children:(0,le.jsx)(qt,{onClick:e.showCollectionShareModal,children:y.Z.SHARE})}),(0,le.jsx)(Jt,{children:(0,le.jsx)(qt,{variant:ge.danger,onClick:function(){e.setDialogMessage({title:y.Z.CONFIRM_DELETE_COLLECTION,content:y.Z.DELETE_COLLECTION_MESSAGE(),staticBackdrop:!0,proceed:{text:y.Z.DELETE_COLLECTION,action:function(){e.startLoadingBar(),$(e.selectedCollectionID,e.syncWithRemote,e.redirectToAll,e.setDialogMessage)},variant:"danger"},close:{text:y.Z.CANCEL}})},children:y.Z.DELETE})})]})})})};function $t(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"})]})}function en(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"})})}$t.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},en.defaultProps={height:20,width:20,viewBox:"0 0 24 24"};var tn=n(34051),nn=f.ZP.span.withConfig({displayName:"CollectionSortOptions__TickWrapper",componentId:"sc-1e2llav-0"})(["color:#aaa;margin-left:5px;"]),rn=function(e){var t=function(e){var t=e.setCollectionSortBy,n=e.activeSortBy;return function(e){return(0,le.jsx)(Jt,{children:(0,le.jsxs)(tn.Z,{children:[(0,le.jsx)(Pe.B4,{width:"20px",children:n===e.sortBy&&(0,le.jsx)(nn,{children:(0,le.jsx)(en,{})})}),(0,le.jsx)(Pe.B4,{width:"165px",children:(0,le.jsx)(qt,{onClick:function(){return t(e.sortBy)},variant:n===e.sortBy&&"success",children:e.children})})]})})}}(e);return(0,le.jsx)(Vt.Z,{id:"collection-sort-options",style:{borderRadius:"10px"},children:(0,le.jsx)(Vt.Z.Content,{style:{padding:0,border:"none",width:"185px"},children:(0,le.jsxs)(Wt.Z,{style:{borderRadius:"8px"},children:[(0,le.jsx)(t,{sortBy:k.LATEST_FILE,children:y.Z.SORT_BY_LATEST_PHOTO}),(0,le.jsx)(t,{sortBy:k.MODIFICATION_TIME,children:y.Z.SORT_BY_MODIFICATION_TIME}),(0,le.jsx)(t,{sortBy:k.NAME,children:y.Z.SORT_BY_COLLECTION_NAME})]})})})},on=n(95845);function an(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,le.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})]})}function sn(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:[(0,le.jsx)("g",{children:(0,le.jsx)("rect",{fill:"none",height:"24",width:"24"})}),(0,le.jsx)("g",{children:(0,le.jsx)("g",{children:(0,le.jsx)("path",{d:"M19,13h-6v6h-2v-6H5v-2h6V5h2v6h6V13z"})})})]})}function cn(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M10 3h4v5h3l-5 5-5-5h3v-5zm8.546 0h-2.344l5.467 9h-4.669l-2.25 3h-5.5l-2.25-3h-4.666l5.46-9h-2.317l-5.477 8.986v9.014h24v-9.014l-5.454-8.986z"})})}function ln(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"})]})}function un(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M24 11.986v9.014h-24v-9.014l5.477-8.986h2.317l-5.46 9h4.666l2.25 3h5.5l2.25-3h4.669l-5.467-9h2.344l5.454 8.986zm-10-3.986h3l-5-5-5 5h3v5h4v-5zm-11.666 4"})})}function dn(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})})}function pn(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l4 3.99L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.25 2.52.77-1.28-3.52-2.09V8z"})]})}function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xn(e){return(0,le.jsx)("svg",hn(hn({xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width},e),{},{children:(0,le.jsx)("path",{d:"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm1 12v-6h-2v8h7v-2h-5z"})}))}function vn(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:[(0,le.jsx)("g",{children:(0,le.jsx)("rect",{fill:"none",height:"24",width:"24"})}),(0,le.jsx)("g",{children:(0,le.jsx)("path",{d:"M5,20h14v-2H5V20z M19,9h-4V3H9v6H5l7,7L19,9z"})})]})}an.defaultProps={height:24,width:24,viewBox:"0 0 24 24",open:!1},sn.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},cn.defaultProps={height:28,width:20,viewBox:"0 0 24 24"},ln.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},un.defaultProps={height:28,width:20,viewBox:"0 0 24 24"},dn.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},pn.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},xn.defaultProps={height:20,width:20,viewBox:"0 0 24 24"},vn.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var gn=(0,f.ZP)(on.Z).withConfig({displayName:"SelectedFileOptions__SelectionBar",componentId:"sc-f9fn82-0"})(["position:fixed;top:0;color:#fff;z-index:1001;width:100%;padding:0 16px;"]),mn=f.ZP.div.withConfig({displayName:"SelectedFileOptions__SelectionContainer",componentId:"sc-f9fn82-1"})(["flex:1;align-items:center;display:flex;"]),wn=function(e){return(0,le.jsx)(Mt.Z,{placement:"bottom",overlay:(0,le.jsx)("p",{style:{zIndex:1002},children:e.message}),children:e.children})},yn=function(e){var t=e.addToCollectionHelper,n=e.moveToCollectionHelper,r=e.restoreToCollectionHelper,i=e.showCreateCollectionModal,o=e.removeFromCollectionHelper,a=e.fixTimeHelper,s=e.setDialogMessage,c=e.setCollectionSelectorAttributes,u=e.deleteFileHelper,d=e.downloadHelper,p=e.count,f=e.clearSelection,h=e.archiveFilesHelper,x=e.unArchiveFilesHelper,g=e.activeCollection,m=e.isFavoriteCollection,w=(0,l.useState)(!1),E=w[0],O=w[1];(0,l.useEffect)((function(){var e=(0,v.Yu)(v.Pd.USER),t=b.sm.includes(null===e||void 0===e?void 0:e.id);O(t)}),[]);return(0,le.jsxs)(gn,{children:[(0,le.jsxs)(mn,{children:[(0,le.jsx)(Pe.hU,{onClick:f,children:(0,le.jsx)(ue,{})}),(0,le.jsxs)("div",{children:[p," ",y.Z.SELECTED]})]}),g===In?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(wn,{message:y.Z.RESTORE,children:(0,le.jsx)(Pe.hU,{onClick:function(){return c({callback:r,showNextModal:i(Dt.RESTORE),title:y.Z.RESTORE_TO_COLLECTION})},children:(0,le.jsx)(pn,{})})}),(0,le.jsx)(wn,{message:y.Z.DELETE_PERMANENTLY,children:(0,le.jsx)(Pe.hU,{onClick:function(){return s({title:y.Z.CONFIRM_DELETE,content:y.Z.DELETE_MESSAGE,staticBackdrop:!0,proceed:{action:function(){return u(!0)},text:y.Z.DELETE,variant:"danger"},close:{text:y.Z.CANCEL}})},children:(0,le.jsx)(an,{})})})]}):(0,le.jsxs)(le.Fragment,{children:[E&&(0,le.jsx)(wn,{message:y.Z.FIX_CREATION_TIME,children:(0,le.jsx)(Pe.hU,{onClick:a,children:(0,le.jsx)(xn,{})})}),(0,le.jsx)(wn,{message:y.Z.DOWNLOAD,children:(0,le.jsx)(Pe.hU,{onClick:d,children:(0,le.jsx)(vn,{})})}),(0,le.jsx)(wn,{message:y.Z.ADD,children:(0,le.jsx)(Pe.hU,{onClick:function(){return c({callback:t,showNextModal:i(Dt.ADD),title:y.Z.ADD_TO_COLLECTION,fromCollection:g})},children:(0,le.jsx)(sn,{})})}),g===jn&&(0,le.jsx)(wn,{message:y.Z.UNARCHIVE,children:(0,le.jsx)(Pe.hU,{onClick:x,children:(0,le.jsx)(un,{})})}),g===Tn&&(0,le.jsx)(wn,{message:y.Z.ARCHIVE,children:(0,le.jsx)(Pe.hU,{onClick:h,children:(0,le.jsx)(cn,{})})}),g!==Tn&&g!==jn&&!m&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(wn,{message:y.Z.MOVE,children:(0,le.jsx)(Pe.hU,{onClick:function(){c({callback:n,showNextModal:i(Dt.MOVE),title:y.Z.MOVE_TO_COLLECTION,fromCollection:g})},children:(0,le.jsx)(ln,{})})}),(0,le.jsx)(wn,{message:y.Z.REMOVE,children:(0,le.jsx)(Pe.hU,{onClick:function(){return s({title:y.Z.CONFIRM_REMOVE,content:y.Z.CONFIRM_REMOVE_MESSAGE(),staticBackdrop:!0,proceed:{action:o,text:y.Z.REMOVE,variant:"danger"},close:{text:y.Z.CANCEL}})},children:(0,le.jsx)(dn,{})})})]}),(0,le.jsx)(wn,{message:y.Z.DELETE,children:(0,le.jsx)(Pe.hU,{onClick:function(){return s({title:y.Z.CONFIRM_DELETE,content:y.Z.TRASH_MESSAGE,staticBackdrop:!0,proceed:{action:u,text:y.Z.MOVE_TO_TRASH,variant:"danger"},close:{text:y.Z.CANCEL}})},children:(0,le.jsx)(an,{})})})]})]})};function bn(e){var t=rn(e);return(0,le.jsx)(Mt.Z,{rootClose:!0,trigger:"click",placement:"bottom",overlay:t,children:(0,le.jsx)("div",{children:(0,le.jsx)(wn,{message:y.Z.SORT,children:(0,le.jsx)(Pe.hU,{style:{color:"#fff"},children:(0,le.jsx)($t,{})})})})})}var En=f.ZP.div.withConfig({displayName:"OptionIcon__OptionIconWrapper",componentId:"sc-4cj2kt-0"})(["display:inline-block;opacity:0;font-weight:bold;width:24px;"]),On=function(e){var t=e.onClick;return(0,le.jsx)(En,{onClick:function(e){t(),e.stopPropagation()},style:{marginBottom:"2px"},children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20px",width:"24px",viewBox:"0 0 24 24",fill:"#000000",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{fill:"#666",d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})]})})},jn=-1,In=-2,Tn=0,Sn=f.ZP.div.withConfig({displayName:"Collections__CollectionContainer",componentId:"sc-utoxfe-0"})(["overflow-y:hidden;height:40px;display:flex;width:calc(100% - 80px);position:relative;padding:0 24px;@media (max-width:","px){padding:0 4px;}"],4*_e.C3),Cn=f.ZP.div.withConfig({displayName:"Collections__Wrapper",componentId:"sc-utoxfe-1"})(["height:70px;flex:1;white-space:nowrap;overflow:auto;max-width:100%;scroll-behavior:smooth;"]),Zn=f.ZP.div.withConfig({displayName:"Collections__CollectionBar",componentId:"sc-utoxfe-2"})(["width:100%;margin:10px auto;display:flex;align-items:center;justify-content:flex-start;"]),_n=f.ZP.button.withConfig({displayName:"Collections__Chip",componentId:"sc-utoxfe-3"})(["border-radius:8px;padding:4px;padding-left:24px;margin:3px;border:none;background-color:",";outline:none !important;&:hover{background-color:",";}&:hover ","{opacity:1;color:#000000;}"],(function(e){return e.active?"#fff":"rgba(255, 255, 255, 0.3)"}),(function(e){return!e.active&&"#bbbbbb"}),En),Pn=f.ZP.div.withConfig({displayName:"Collections__Hider",componentId:"sc-utoxfe-4"})(["opacity:",";height:",";"],(function(e){return e.hide?"0":"100"}),(function(e){return e.hide?"0":"auto"}));function kn(e){var t=e.activeCollection,n=e.collections,r=e.setActiveCollection,i=(0,l.useState)(null),o=i[0],a=i[1],s=(0,l.useRef)(null),c=e.collections.reduce((function(e,t){return e[t.id]=l.createRef(),e}),{}),u=(0,l.useState)(!1),d=u[0],p=u[1],f=(0,l.useState)({}),h=f[0],x=f[1],g=(0,l.useState)(k.LATEST_FILE),m=g[0],w=g[1],b=function(){if(s.current){var e=s.current,t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;x({scrollLeft:t,scrollWidth:n,clientWidth:r})}};(0,l.useEffect)((function(){b()}),[s.current,e.isInSearchMode,n]),(0,l.useEffect)((function(){null!==s&&void 0!==s&&s.current&&(s.current.scrollLeft=0)}),[n]),(0,l.useEffect)((function(){var e;null===(e=c[t])||void 0===e||e.current.scrollIntoView({inline:"center"})}),[t]);var E=function(e){return function(){a(e),r(null!==e&&void 0!==e?e:Tn)}},O=(0,v.Yu)(v.Pd.USER),j=Qt({syncWithRemote:e.syncWithRemote,setCollectionNamerAttributes:e.setCollectionNamerAttributes,collections:e.collections,selectedCollectionID:o,setDialogMessage:e.setDialogMessage,startLoadingBar:e.startLoadingBar,showCollectionShareModal:p.bind(null,!0),redirectToAll:r.bind(null,Tn)}),I=function(e){return function(){s.current.scrollBy(250*e,0)}},T=function(t){var n,r,i=null!==(n=null===(r=e.collectionFilesCount)||void 0===r?void 0:r.get(t))&&void 0!==n?n:0;return(0,le.jsx)(Ft.Z,{style:{padding:"0",paddingBottom:"5px"},id:"button-tooltip",children:(0,le.jsxs)("div",{style:{backgroundColor:"#282828",padding:"2px 10px",margin:0,color:"#ddd",borderRadius:3,fontSize:"12px"},children:[i," ",i>1?"items":"item"]})})},S=function(e){var t=e.activeCollection,n=e.clickHandler;return function(e){var r=e.section,i=e.label;return(0,le.jsxs)(_n,{active:t===r,onClick:n(r),children:[i,(0,le.jsx)("div",{style:{display:"inline-block",width:"24px"}})]})}}({activeCollection:t,clickHandler:E});return(0,le.jsxs)(Pn,{hide:e.isInSearchMode,children:[(0,le.jsx)(Tt,{show:d,onHide:function(){return p(!1)},collection:Ht(o,e.collections),syncWithRemote:e.syncWithRemote}),(0,le.jsxs)(Zn,{children:[(0,le.jsxs)(Sn,{children:[h.scrollLeft>0&&(0,le.jsx)(Lt,{scrollDirection:Pt.LEFT,onClick:I(Pt.LEFT)}),(0,le.jsxs)(Cn,{ref:s,onScroll:b,children:[(0,le.jsx)(S,{section:Tn,label:y.Z.ALL}),oe(n,e.collectionAndTheirLatestFile,m).map((function(e){return(0,le.jsx)(Mt.Z,{placement:"top",delay:{show:250,hide:400},overlay:T(e.id),children:(0,le.jsxs)(_n,{ref:c[e.id],active:t===e.id,onClick:E(e.id),children:[e.name,e.type!==_.favorites&&e.owner.id===(null===O||void 0===O?void 0:O.id)?(0,le.jsx)(Mt.Z,{rootClose:!0,trigger:"click",placement:"bottom",overlay:j,children:(0,le.jsx)(On,{onClick:function(){return a(e.id)}})}):(0,le.jsx)("div",{style:{display:"inline-block",width:"24px"}})]})},e.id)})),(0,le.jsx)(S,{section:jn,label:y.Z.ARCHIVE}),(0,le.jsx)(S,{section:In,label:y.Z.TRASH})]}),h.scrollLeft<h.scrollWidth-h.clientWidth&&(0,le.jsx)(Lt,{scrollDirection:Pt.RIGHT,onClick:I(Pt.RIGHT)})]}),(0,le.jsx)(bn,{setCollectionSortBy:w,activeSortBy:m})]})]})}var An=n(82736),Rn=n(57709),Dn=n(20147),Nn=["file","updatedAt"];function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bn(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Un="file-trash",Hn="trash-time",Gn="deleted-collection",zn=(0,x.O3)();function Wn(){return Vn.apply(this,arguments)}function Vn(){return(Vn=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getItem(Un);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return t=e.t0,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xn(){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getItem(Gn);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=[];case 5:return t=e.t0,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kn(e){return qn.apply(this,arguments)}function qn(){return(qn=(0,a.Z)(c().mark((function e(t){var n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xn();case 2:return n=e.sent,r=new Set(t.map((function(e){return e.file.collectionID}))),i=n.filter((function(e){return r.has(e.id)})),e.next=7,g.Z.setItem(Gn,i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.getItem(Hn);case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=0;case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $n(e,t,n){return er.apply(this,arguments)}function er(){return(er=(0,a.Z)(c().mark((function e(t,n,r){var i,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wn();case 2:return i=e.sent,e.t0=[],e.t1=(0,o.Z)(t),e.t2=o.Z,e.next=8,Xn();case 8:if(e.t3=e.sent,e.t4=(0,e.t2)(e.t3),t=e.t0.concat.call(e.t0,e.t1,e.t4),a=new Map(t.map((function(e){return[e.id,e]}))),(0,m.LP)()){e.next=14;break}return e.abrupt("return",i);case 14:return e.next=16,Jn();case 16:return s=e.sent,e.next=19,tr(a,s,n,r,i);case 19:return Kn(l=e.sent),e.abrupt("return",l);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var tr=function(){var e=(0,a.Z)(c().mark((function e(t,n,r,i,a){var s,l,u,d,p,f,h,x,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,s=(0,o.Z)(a),l=n;case 3:if(d=(0,m.LP)()){e.next=6;break}return e.abrupt("break",46);case 6:return e.next=8,E.Z.get("".concat(zn,"/trash/diff"),{sinceTime:l},{"X-Auth-Token":d});case 8:u=e.sent,p=Mn(u.data.diff),e.prev=10,p.s();case 12:if((f=p.n()).done){e.next=29;break}if(h=f.value,x=h.file.collectionID,v=t.get(x)){e.next=22;break}return e.next=19,B(x);case 19:v=e.sent,t.set(x,v),g.Z.setItem(Gn,(0,o.Z)(t.values()));case 22:if(h.isDeleted||h.isRestored){e.next=26;break}return e.next=25,(0,I.np)(h.file,v);case 25:h.file=e.sent;case 26:s.push(h);case 27:e.next=12;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(10),p.e(e.t0);case 34:return e.prev=34,p.f(),e.finish(34);case 37:return u.data.diff.length&&(l=u.data.diff.slice(-1)[0].updatedAt),s=nr(s),s=s.filter((function(e){return!e.isDeleted&&!e.isRestored})),r((0,I.hE)([].concat((0,o.Z)(null!==i&&void 0!==i?i:[]),(0,o.Z)(rr(s))))),e.next=43,g.Z.setItem(Un,s);case 43:return e.next=45,g.Z.setItem(Hn,l);case 45:if(u.data.hasMore){e.next=3;break}case 46:return e.abrupt("return",s);case 49:e.prev=49,e.t1=e.catch(0),(0,O.H)(e.t1,"Get trash files failed");case 52:case"end":return e.stop()}}),e,null,[[0,49],[10,31,34,37]])})));return function(t,n,r,i,o){return e.apply(this,arguments)}}();function nr(e){var t=new Map;e.forEach((function(e){var n=e.file,r=e.updatedAt,i=(0,St.Z)(e,Nn);(!t.has(n.id)||t.get(n.id).updatedAt<r)&&t.set(n.id,Fn({file:n,updatedAt:r},i))})),e=[];var n,r=Mn(t);try{for(r.s();!(n=r.n()).done;){var o=(0,i.Z)(n.value,2),a=(o[0],o[1]);e.push(a)}}catch(s){r.e(s)}finally{r.f()}return e}function rr(e){return(0,I.SA)(e.map((function(e){return Fn(Fn({},e.file),{},{updationTime:e.updatedAt,isTrashed:!0,deleteBy:e.deleteBy})})))}var ir=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=(0,m.LP)()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,Jn();case 6:return n=e.sent,e.next=9,E.Z.post("".concat(zn,"/trash/empty"),{lastUpdatedAt:n},null,{"X-Auth-Token":t});case 9:e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(0),(0,O.H)(e.t0,"empty trash failed"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),or=function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.Z.setItem(Un,[]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function ar(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sr(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var cr,lr=(0,x.O3)(),ur=512e3;function dr(){return pr.apply(this,arguments)}function pr(){return(pr=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=(0,m.LP)()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,E.Z.get("".concat(lr,"/files/large-thumbnails"),{threshold:ur},{"X-Auth-Token":t});case 6:return n=e.sent,e.abrupt("return",n.data.largeThumbnailFiles);case 10:throw e.prev=10,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to get large thumbnail files"),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function fr(e,t){return hr.apply(this,arguments)}function hr(){return(hr=(0,a.Z)(c().mark((function e(t,n){var r,a,s,l,u,d,f,h,x,v,g,y,b,E,j,I,T,S,C;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,e.prev=1,a=(0,m.LP)(),e.next=5,new w.ZP;case 5:return s=e.sent,e.next=8,(0,p.dm)();case 8:return l=e.sent,e.next=11,Wn();case 11:if(u=e.sent,d=rr(u),f=[].concat((0,o.Z)(l),(0,o.Z)(d)).filter((function(e){return n.has(e.id)})),n.size!==f.length&&(0,O.H)(Error(),"all large thumbnail files not found locally"),0!==f.length){e.next=17;break}return e.abrupt("return",r);case 17:return t({current:0,total:f.length}),h=[],e.next=21,Rn.Z.fetchUploadURLs(f.length,h);case 21:x=ar(f.entries()),e.prev=22,x.s();case 24:if((v=x.n()).done){e.next=52;break}return g=(0,i.Z)(v.value,2),y=g[0],b=g[1],e.prev=26,t({current:y,total:f.length}),e.next=30,Ke.Z.downloadThumb(a,b);case 30:return E=e.sent,j=new globalThis.File([E],b.metadata.title),e.next=34,(0,Dn.JB)(s,j);case 34:return I=e.sent,e.next=37,(0,An.eV)(s,j,I);case 37:return T=e.sent,S=T.thumbnail,e.next=41,xr(s,b.key,S,h.pop());case 41:return C=e.sent,e.next=44,gr(b.id,C);case 44:e.next=50;break;case 46:e.prev=46,e.t0=e.catch(26),(0,O.H)(e.t0,"failed to replace a thumbnail"),r=!0;case 50:e.next=24;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(22),x.e(e.t1);case 57:return e.prev=57,x.f(),e.finish(57);case 60:e.next=66;break;case 62:e.prev=62,e.t2=e.catch(1),(0,O.H)(e.t2,"replace Thumbnail function failed"),r=!0;case 66:return e.abrupt("return",r);case 67:case"end":return e.stop()}}),e,null,[[1,62],[22,54,57,60],[26,46]])})))).apply(this,arguments)}function xr(e,t,n,r){return vr.apply(this,arguments)}function vr(){return(vr=(0,a.Z)(c().mark((function e(t,n,r,i){var o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.encryptThumbnail(r,n);case 2:return o=e.sent,a=o.file,e.next=6,Rn.Z.putFile(i,a.encryptedData,(function(){}));case 6:return s=e.sent,e.abrupt("return",{objectKey:s,decryptionHeader:a.decryptionHeader});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gr(e,t){return mr.apply(this,arguments)}function mr(){return(mr=(0,a.Z)(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=(0,m.LP)()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,E.Z.put("".concat(lr,"/files/thumbnail"),{fileID:t,thumbnail:n},null,{"X-Auth-Token":r});case 6:e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to update thumbnail"),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function wr(e){var t=null;switch(e.fixState){case cr.NOT_STARTED:case cr.FIX_LATER:t=y.Z.REPLACE_THUMBNAIL_NOT_STARTED();break;case cr.COMPLETED:t=y.Z.REPLACE_THUMBNAIL_COMPLETED();break;case cr.NOOP:t=y.Z.REPLACE_THUMBNAIL_NOOP();break;case cr.COMPLETED_WITH_ERRORS:t=y.Z.REPLACE_THUMBNAIL_COMPLETED_WITH_ERROR()}return t?(0,le.jsx)("div",{style:{marginBottom:"30px"},children:t}):(0,le.jsx)(le.Fragment,{})}function yr(e){var t=(0,l.useState)(cr.NOT_STARTED),n=t[0],r=t[1],i=(0,l.useState)({current:0,total:0}),o=i[0],s=i[1],u=(0,l.useState)([]),d=u[0],p=u[1],f=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dr();case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=[];case 11:return n=e.t2,p(n),e.abrupt("return",n);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var t=(0,a.Z)(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:r=t.sent,n===cr.NOT_STARTED&&r.length>0&&e.show(),(n===cr.COMPLETED||n===cr.NOOP)&&r.length>0&&(g(cr.NOT_STARTED),(0,O.H)(Error(),"large thumbnail files left after migration")),0===r.length&&n!==cr.NOOP&&g(cr.NOOP);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,l.useEffect)((function(){e.isOpen&&n!==cr.RUNNING&&h()}),[e.isOpen]),(0,l.useEffect)((function(){(function(){var e,t=null===(e=(0,v.Yu)(v.Pd.THUMBNAIL_FIX_STATE))||void 0===e?void 0:e.state;return t&&t!==cr.RUNNING||(t=cr.NOT_STARTED,g(t)),t===cr.COMPLETED&&(t=cr.NOOP,g(t)),r(t),t})()===cr.NOT_STARTED&&h()}),[]);var x=function(){var e=(0,a.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(cr.RUNNING),e.next=3,fr(s,new Set(null!==(n=null!==t&&void 0!==t?t:d)&&void 0!==n?n:[]));case 3:return"undefined"!==typeof(r=e.sent)&&g(r?cr.COMPLETED_WITH_ERRORS:cr.COMPLETED),e.next=7,f();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){r(e),(0,v.a_)(v.Pd.THUMBNAIL_FIX_STATE,{state:e})};return(0,le.jsx)(ke.Z,{show:e.isOpen,onHide:e.hide,attributes:{title:y.Z.FIX_LARGE_THUMBNAILS,staticBackdrop:!0},children:(0,le.jsxs)("div",{style:{marginBottom:"20px",padding:"0 5%",display:"flex",alignItems:"center",flexDirection:"column"},children:[(0,le.jsx)(wr,{fixState:n}),n===cr.RUNNING&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,le.jsxs)(ot,{children:[" ",o.current," /"," ",o.total," "]})," ",(0,le.jsxs)("span",{style:{marginLeft:"10px"},children:[" ",y.Z.THUMBNAIL_REPLACED]})]}),(0,le.jsx)("div",{style:{width:"100%",marginTop:"10px",marginBottom:"20px"},children:(0,le.jsx)(it.Z,{now:Math.round(100*o.current/o.total),animated:!0,variant:"upload-progress-bar"})})]}),(0,le.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around"},children:[n===cr.NOT_STARTED||n===cr.FIX_LATER?(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:function(){g(cr.FIX_LATER),e.hide()},children:y.Z.FIX_THUMBNAIL_LATER}):(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:e.hide,children:y.Z.CLOSE}),(n===cr.NOT_STARTED||n===cr.FIX_LATER||n===cr.COMPLETED_WITH_ERRORS)&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{width:"30px"}}),(0,le.jsx)(we.Z,{block:!0,variant:"outline-success",onClick:function(){return x()},children:y.Z.FIX_THUMBNAIL})]})]})]})})}function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Or(e){var t=(0,l.useState)(null),n=t[0],r=t[1],i=(0,l.useState)(null),o=i[0],s=i[1],d=(0,l.useState)(null),p=d[0],f=d[1];(0,l.useEffect)((function(){s((0,v.Yu)(v.Pd.USER)),f((0,ce.rE)())}),[]);var h=(0,l.useState)(!1),g=h[0],w=h[1],E=(0,l.useState)(!1),O=E[0],j=E[1],I=(0,l.useState)(!1),T=I[0],S=I[1],C=(0,l.useState)(!1),Z=C[0],_=C[1],P=(0,l.useState)(!1),k=P[0],A=P[1],R=(0,l.useContext)(La);function D(e){var t=document.createElement("a");t.href="mailto:"+e,t.rel="noreferrer noopener",t.click()}(0,l.useEffect)((function(){(function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,b.M_)();case 4:t=e.sent,s(Er(Er({},o),{},{email:t.email})),r((0,ce.pe)(t.usage)),f(t.subscription),(0,v.a_)(v.Pd.USER,Er(Er({},(0,v.Yu)(v.Pd.USER)),{},{email:t.email})),(0,v.a_)(v.Pd.SUBSCRIPTION,t.subscription);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[g]);var N=(0,u.useRouter)();var L=function(){return(0,le.jsx)("div",{style:{height:"1px",marginTop:"40px",background:"#242424",width:"100%"}})};return(0,le.jsxs)(me.slide,{isOpen:g,onStateChange:function(e){return w(e.isOpen)},itemListElement:"div",children:[(0,le.jsx)("div",{style:{display:"flex",outline:"none",textAlign:"center"},children:(0,le.jsx)(Se.LogoImage,{style:{height:"24px",padding:"3px"},alt:"logo",src:"/icon.svg"})}),(0,le.jsx)("div",{style:{outline:"none",color:"rgb(45, 194, 98)",fontSize:"16px"},children:null===o||void 0===o?void 0:o.email}),(0,le.jsxs)("div",{style:{flex:1,overflow:"auto",outline:"none",paddingTop:"0"},children:[(0,le.jsxs)("div",{style:{outline:"none"},children:[(0,le.jsx)("div",{style:{display:"flex"},children:(0,le.jsx)("h5",{style:{margin:"4px 0 12px 2px"},children:y.Z.SUBSCRIPTION_PLAN})}),(0,le.jsxs)("div",{style:{color:"#959595"},children:[(0,ce.xC)(p)?(0,ce.aX)(p)?y.Z.FREE_SUBSCRIPTION_INFO(null===p||void 0===p?void 0:p.expiryTime):(0,ce.gd)(p)?y.Z.RENEWAL_CANCELLED_SUBSCRIPTION_INFO(null===p||void 0===p?void 0:p.expiryTime):y.Z.RENEWAL_ACTIVE_SUBSCRIPTION_INFO(null===p||void 0===p?void 0:p.expiryTime):(0,le.jsx)("p",{children:y.Z.SUBSCRIPTION_EXPIRED}),(0,le.jsx)(we.Z,{variant:"outline-success",block:!0,size:"sm",onClick:function(){w(!1),R.showPlanSelectorModal()},children:(0,ce.YK)(p)?y.Z.MANAGE:y.Z.SUBSCRIBE})]})]}),(0,le.jsx)("div",{style:{outline:"none",marginTop:"30px"}}),(0,le.jsxs)("div",{children:[(0,le.jsx)("h5",{style:{marginBottom:"12px"},children:y.Z.USAGE_DETAILS}),(0,le.jsx)("div",{style:{color:"#959595"},children:n?y.Z.USAGE_INFO(n,(0,ce.pe)(null===p||void 0===p?void 0:p.storage)):(0,le.jsx)("div",{style:{textAlign:"center"},children:(0,le.jsx)(Ce.Z,{style:{borderWidth:"2px",width:"20px",height:"20px"}})})})]}),(0,le.jsx)(L,{}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){R.setActiveCollection(jn),w(!1)},children:y.Z.ARCHIVE}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){R.setActiveCollection(In),w(!1)},children:y.Z.TRASH}),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Ze.ZP,{show:O,onHide:function(){return j(!1)},somethingWentWrong:function(){return e.setDialogMessage({title:y.Z.RECOVER_KEY_GENERATION_FAILED,close:{variant:"danger"}})}}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){return j(!0)},children:y.Z.DOWNLOAD_RECOVERY_KEY})]}),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Me,{show:T,onHide:function(){return S(!1)},setDialogMessage:e.setDialogMessage,closeSidebar:function(){return w(!1)},setLoading:e.setLoading}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){return S(!0)},children:y.Z.TWO_FACTOR})]}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){N.push(_e.q5.CHANGE_PASSWORD)},children:y.Z.CHANGE_PASSWORD}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){N.push(_e.q5.CHANGE_EMAIL)},children:y.Z.UPDATE_EMAIL}),(0,le.jsx)(L,{}),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(yr,{isOpen:k,hide:function(){return A(!1)},show:function(){return A(!0)}}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){return A(!0)},children:y.Z.FIX_LARGE_THUMBNAILS})]}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){var e="".concat((0,x.O3)(),"/users/feedback?token=").concat(encodeURIComponent((0,m.LP)()));window.open(e,"_blank").focus()},children:y.Z.REQUEST_FEATURE}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){return D("contact@ente.io")},children:y.Z.SUPPORT}),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(mt,{show:Z,onHide:function(){return _(!1)},usage:n}),(0,le.jsx)(Ie,{style:{marginTop:"30px"},onClick:function(){be()()?_(!0):e.setDialogMessage({title:y.Z.DOWNLOAD_APP,content:y.Z.DOWNLOAD_APP_MESSAGE(),staticBackdrop:!0,proceed:{text:y.Z.DOWNLOAD,action:Te.zx,variant:"success"},close:{text:y.Z.CLOSE}})},children:(0,le.jsxs)("div",{style:{display:"flex"},children:[y.Z.EXPORT,(0,le.jsx)("div",{style:{width:"20px"}}),rt.isExportInProgress()&&(0,le.jsx)(ft,{})]})})]}),(0,le.jsx)(L,{}),(0,le.jsx)(Ie,{variant:"danger",style:{marginTop:"30px"},onClick:function(){return e.setDialogMessage({title:"".concat(y.Z.CONFIRM," ").concat(y.Z.LOGOUT),content:y.Z.LOGOUT_MESSAGE,staticBackdrop:!0,proceed:{text:y.Z.LOGOUT,action:b.TX,variant:"danger"},close:{text:y.Z.CANCEL}})},children:y.Z.LOGOUT}),(0,le.jsx)(Ie,{variant:"danger",style:{marginTop:"30px"},onClick:function(){return e.setDialogMessage({title:"".concat(y.Z.DELETE_ACCOUNT),content:y.Z.DELETE_ACCOUNT_MESSAGE(),staticBackdrop:!0,proceed:{text:y.Z.DELETE_ACCOUNT,action:function(){D("account-deletion@ente.io")},variant:"danger"},close:{text:y.Z.CANCEL}})},children:y.Z.DELETE_ACCOUNT}),(0,le.jsx)("div",{style:{marginTop:"40px",width:"100%"}})]})]})}!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.FIX_LATER=1]="FIX_LATER",e[e.NOOP=2]="NOOP",e[e.RUNNING=3]="RUNNING",e[e.COMPLETED=4]="COMPLETED",e[e.COMPLETED_WITH_ERRORS=5]="COMPLETED_WITH_ERRORS"}(cr||(cr={}));var jr=n(66091),Ir=n(41389),Tr=f.ZP.div.withConfig({displayName:"LoadingOverlay",componentId:"sc-124qogg-0"})(["left:0;top:0;outline:none;height:100%;width:100%;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:900;position:absolute;background:rgba(0,0,0,0.5);z-index:9000;"]);function Sr(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:[(0,le.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,le.jsx)("path",{d:"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"})]})}function Cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Sr.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var _r=f.ZP.input.withConfig({displayName:"PreviewCard__Check",componentId:"sc-13wszfe-0"})(["appearance:none;position:absolute;z-index:10;left:0;opacity:0;outline:none;cursor:pointer;@media (pointer:coarse){pointer-events:none;}&::before{content:'';width:16px;height:16px;border:2px solid #fff;background-color:#ddd;display:inline-block;border-radius:50%;vertical-align:bottom;margin:8px 8px;text-align:center;line-height:16px;transition:background-color 0.3s ease;pointer-events:inherit;color:#aaa;}&::after{content:'';width:5px;height:10px;border-right:2px solid #333;border-bottom:2px solid #333;transform:translate(-18px,8px);transition:transform 0.3s ease;position:absolute;pointer-events:inherit;transform:translate(-18px,10px) rotate(45deg);}&:checked::before{content:'';background-color:#51cd7c;border-color:#51cd7c;color:#fff;}&:checked::after{content:'';border-right:2px solid #ddd;border-bottom:2px solid #ddd;}",";&:checked{opacity:1 !important;}"],(function(e){return e.active&&"opacity: 0.5 "})),Pr=f.ZP.div.withConfig({displayName:"PreviewCard__HoverOverlay",componentId:"sc-13wszfe-1"})(["opacity:0;left:0;top:0;outline:none;height:40%;width:100%;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:900;position:absolute;",";"],(function(e){return!e.checked&&"background:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0))"})),kr=f.ZP.div.withConfig({displayName:"PreviewCard__InSelectRangeOverLay",componentId:"sc-13wszfe-2"})(["opacity:",");left:0;top:0;outline:none;height:100%;width:100%;display:flex;justify-content:center;align-items:center;color:#fff;font-weight:900;position:absolute;",";"],(function(e){return e.active?1:0}),(function(e){return e.active&&"background:rgba(81, 205, 124, 0.25)"})),Ar=f.ZP.div.withConfig({displayName:"PreviewCard__Cont",componentId:"sc-13wszfe-3"})(["background:#222;display:flex;width:fit-content;margin-bottom:","px;min-width:100%;overflow:hidden;position:relative;flex:1;cursor:",";& > img{object-fit:cover;max-width:100%;min-height:100%;flex:1;"," pointer-events:none;}& > svg{position:absolute;color:white;width:50px;height:50px;margin-left:50%;margin-top:50%;top:-25px;left:-25px;filter:drop-shadow(3px 3px 2px rgba(0,0,0,0.7));}&:hover ","{opacity:0.5;}&:hover ","{opacity:1;}"],_e.dP,(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.selected&&"border: 5px solid #51cd7c;"}),_r,Pr);function Rr(e){var t=(0,l.useState)(),n=t[0],r=t[1],i=(0,l.useContext)(La),o=i.thumbs,s=i.files,u=e.file,d=e.onClick,p=e.updateUrl,f=e.forcedEnable,h=e.selectable,x=e.selected,v=e.onSelect,g=e.selectOnClick,m=e.onHover,w=e.onRangeSelect,y=e.isRangeSelectActive,b=e.isInsSelectRange,E=(0,l.useRef)(!0);(0,l.useLayoutEffect)((function(){if(u&&!u.msrc){var e=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.Z.getThumbnail(u);case 3:t=e.sent,E.current&&(r(t),o.set(u.id,t),u.msrc=t,u.src||(u.src=t),p(t)),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();if(o.has(u.id)){var t=o.get(u.id);r(t),u.msrc=t,u.src||(s.has(u.id)?u.src=s.get(u.id):u.src=t)}else e()}return function(){E.current=!1}}),[u]);return(0,le.jsxs)(Ar,Zr(Zr({id:"thumb-".concat(null===u||void 0===u?void 0:u.id),onClick:function(){g?(y&&w(),null===v||void 0===v||v(!x)):(null!==u&&void 0!==u&&u.msrc||n)&&(null===d||void 0===d||d())},onMouseEnter:function(){g&&m()},disabled:!f&&!(null!==u&&void 0!==u&&u.msrc)&&!n,selected:x},h?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=(0,l.useState)(!1),r=n[0],i=n[1];return(0,l.useEffect)((function(){var n;return r?n=setTimeout(e,t):clearTimeout(n),function(){clearTimeout(n)}}),[e,t,r]),{onMouseDown:function(){return i(!0)},onMouseUp:function(){return i(!1)},onMouseLeave:function(){return i(!1)},onTouchStart:function(){return i(!0)},onTouchEnd:function(){return i(!1)}}}((function(){v(!x)}),500):{}),{},{children:[h&&(0,le.jsx)(_r,{type:"checkbox",checked:x,onChange:function(e){y&&(null===w||void 0===w||w()),null===v||void 0===v||v(e.target.checked)},active:y&&b,onClick:function(e){return e.stopPropagation()}}),((null===u||void 0===u?void 0:u.msrc)||n)&&(0,le.jsx)("img",{src:(null===u||void 0===u?void 0:u.msrc)||n}),1===(null===u||void 0===u?void 0:u.metadata.fileType)&&(0,le.jsx)(Sr,{}),(0,le.jsx)(Pr,{checked:x}),(0,le.jsx)(kr,{active:y&&b})]}))}var Dr=n(11728),Nr=n(58832),Lr=n.n(Nr),Fr=n(38411),Mr=n.n(Fr),Br=n(94184),Ur=n.n(Br),Hr=f.ZP.button.withConfig({displayName:"FavButton__HeartUI",componentId:"sc-hozyl6-0"})(["width:","px;height:","px;float:right;background:url('/fav-button.png') no-repeat;cursor:pointer;background-size:cover;border:none;",""],(function(e){return e.size}),(function(e){return e.size}),(function(e){var t=e.isClick,n=e.size;return t&&"background-position: -".concat(28*n,"px;transition: background 1s steps(28);")}));function Gr(e){var t=e.isClick,n=e.onClick,r=e.size;return(0,le.jsx)(Hr,{isClick:t,onClick:n,size:r})}var zr=n(99382),Wr=n(33114),Vr=["beforeChange","afterChange","imageLoadComplete","resize","gettingData","mouseUsed","initialZoomIn","initialZoomInEnd","initialZoomOut","initialZoomOutEnd","parseVerticalMargin","close","unbindEvents","destroy","updateScrollOffset","preventDragEvent","shareLinkClick"],Xr=n(48571);function Yr(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}Yr.defaultProps={height:20,width:20,viewBox:"0 0 24 24"};var Kr=n(9198),qr=n.n(Kr),Jr=(n(7276),function(e){var t,n,r=e.isInEditMode,i=e.pickedTime,o=e.handleChange;return(0,le.jsx)(qr(),{open:r,selected:i,onChange:o,timeInputLabel:"Time:",dateFormat:"dd/MM/yyyy h:mm aa",showTimeSelect:!0,autoFocus:!0,minDate:p.lI,maxDate:p.E9,maxTime:(t=i,n=new Date,t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()?p.E9:p.Si),minTime:p.lI,fixedHeight:!0,withPortal:!0})});function Qr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $r(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ei=f.ZP.div.withConfig({displayName:"PhotoSwipe__LegendContainer",componentId:"sc-3egfe1-0"})(["display:flex;justify-content:space-between;"]),ti=f.ZP.span.withConfig({displayName:"PhotoSwipe__Legend",componentId:"sc-3egfe1-1"})(["font-size:20px;color:#ddd;display:inline;"]),ni=f.ZP.pre.withConfig({displayName:"PhotoSwipe__Pre",componentId:"sc-3egfe1-2"})(["color:#aaa;padding:7px 15px;"]),ri=function(e,t){return(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"30%",children:e}),(0,le.jsx)(Pe.B4,{width:"70%",children:t})]})};function ii(e){var t=e.file,n=e.scheduleUpdate,r=new Date((null===t||void 0===t?void 0:t.metadata.creationTime)/1e3),i=(0,l.useState)(!1),o=i[0],s=i[1],u=(0,l.useState)(r),d=u[0],f=u[1],h=function(){return s(!1)},x=function(){var e=(0,a.Z)(c().mark((function e(){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!o||!t){e.next=14;break}if((r=1e3*d.getTime())!==(null===t||void 0===t?void 0:t.metadata.creationTime)){e.next=6;break}return h(),e.abrupt("return");case 6:return e.next=8,(0,I.rx)(t,r);case 8:return i=e.sent,e.next=11,(0,p.NA)([i]);case 11:i=e.sent[0],(0,I.Vz)(t,i),n();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to update creationTime");case 19:h();case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return(0,le.jsx)(le.Fragment,{children:(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"30%",children:y.Z.CREATION_TIME}),(0,le.jsx)(Pe.B4,{width:o?"50%":"60%",children:o?(0,le.jsx)(Jr,{isInEditMode:o,pickedTime:d,handleChange:function(e){e instanceof Date&&f(e)}}):(0,I.o0)(d)}),(0,le.jsx)(Pe.B4,{width:o?"20%":"10%",style:{cursor:"pointer",marginLeft:"10px"},children:o?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Pe.hU,{onClick:x,children:(0,le.jsx)(en,{})}),(0,le.jsx)(Pe.hU,{onClick:function(){f(r),h()},children:(0,le.jsx)(ue,{})})]}):(0,le.jsx)(Pe.hU,{onClick:function(){return s(!0)},children:(0,le.jsx)(Yr,{})})})]})})}var oi=function(e,t){return t?e+"."+t:e},ai=function(e){var t=e.filename,n=e.saveEdits,r=e.discardEdits,i=e.extension,o=(0,l.useState)(!1),s=o[0],u=o[1],d=function(){var e=(0,a.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,n(t.filename);case 4:return e.prev=4,u(!1),e.finish(4);case 7:case"end":return e.stop()}}),e,null,[[0,,4,7]])})));return function(t){return e.apply(this,arguments)}}();return(0,le.jsx)(wt.J9,{initialValues:{filename:t},validationSchema:yt.Ry().shape({filename:yt.Z_().required(y.Z.REQUIRED).max(p.Uw,y.Z.FILE_NAME_CHARACTER_LIMIT)}),validateOnBlur:!1,onSubmit:d,children:function(e){var t=e.values,n=e.errors,o=e.handleChange,a=e.handleSubmit;return(0,le.jsx)(bt.Z,{noValidate:!0,onSubmit:a,children:(0,le.jsxs)(bt.Z.Row,{children:[(0,le.jsxs)(bt.Z.Group,{bsPrefix:"ente-form-group",as:Ot.Z,xs:i?7:8,children:[(0,le.jsx)(bt.Z.Control,{as:"textarea",placeholder:y.Z.FILE_NAME,value:t.filename,onChange:o("filename"),isInvalid:Boolean(n.filename),autoFocus:!0,disabled:s}),(0,le.jsx)(Et.Z.Feedback,{type:"invalid",style:{textAlign:"center"},children:n.filename})]}),i&&(0,le.jsx)(bt.Z.Group,{bsPrefix:"ente-form-group",as:Ot.Z,xs:1,controlId:"formHorizontalFileName",children:(0,le.jsx)(Pe.A0,{style:{padding:"5px"},children:".".concat(i)})}),(0,le.jsx)(bt.Z.Group,{bsPrefix:"ente-form-group",as:Ot.Z,xs:2,children:(0,le.jsxs)(Pe.B4,{width:"16.67%",children:[(0,le.jsx)(Pe.hU,{type:"submit",disabled:s,children:s?(0,le.jsx)(Ce.Z,{style:{width:"20px",height:"20px"}}):(0,le.jsx)(en,{})}),(0,le.jsx)(Pe.hU,{onClick:r,disabled:s,children:(0,le.jsx)(ue,{})})]})})]})})}})};function si(e){var t=e.file,n=e.scheduleUpdate,r=null===t||void 0===t?void 0:t.metadata.title,o=(0,l.useState)(!1),s=o[0],u=o[1],d=(0,I.J9)(r),f=(0,i.Z)(d,2),h=f[0],x=f[1],v=(0,l.useState)(h),g=v[0],m=v[1],w=function(){return u(!1)},b=function(){var e=(0,a.Z)(c().mark((function e(r){var i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=15;break}if(g!==r){e.next=5;break}return w(),e.abrupt("return");case 5:return m(r),i=oi(r,x),e.next=9,(0,I.tc)(t,i);case 9:return o=e.sent,e.next=12,(0,p.NA)([o]);case 12:o=e.sent[0],(0,I.Vz)(t,o),n();case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),(0,O.H)(e.t0,"failed to update file name");case 20:return e.prev=20,w(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[0,17,20,23]])})));return function(t){return e.apply(this,arguments)}}();return(0,le.jsx)(le.Fragment,{children:(0,le.jsxs)(Pe.X2,{children:[(0,le.jsx)(Pe.__,{width:"30%",children:y.Z.FILE_NAME}),s?(0,le.jsx)(ai,{extension:x,filename:g,saveEdits:b,discardEdits:w}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Pe.B4,{width:"60%",children:(0,le.jsx)(Ze.lN,{children:oi(g,x)})}),(0,le.jsx)(Pe.B4,{width:"10%",style:{cursor:"pointer",marginLeft:"10px"},children:(0,le.jsx)(Pe.hU,{onClick:function(){return u(!0)},children:(0,le.jsx)(Yr,{})})})]})]})})}function ci(e){var t=e.exif,n=(0,l.useState)(!1),r=n[0],i=n[1];return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)(ei,{children:[(0,le.jsx)(ti,{children:y.Z.EXIF}),(0,le.jsx)(Xr.Z,{children:(0,le.jsxs)(Xr.Z.Label,{children:[(0,le.jsx)(Xr.Z.Input,{onChange:function(e){i(e.target.checked)}}),y.Z.SHOW_ALL]})})]}),r?(0,le.jsx)(ni,{children:t.raw}):(0,le.jsxs)(le.Fragment,{children:[(null===t||void 0===t?void 0:t.Make)&&(null===t||void 0===t?void 0:t.Model)&&ri(y.Z.DEVICE,"".concat(t.Make," ").concat(t.Model)),(null===t||void 0===t?void 0:t.ImageWidth)&&(null===t||void 0===t?void 0:t.ImageHeight)&&ri(y.Z.IMAGE_SIZE,"".concat(t.ImageWidth," x ").concat(t.ImageHeight)),(null===t||void 0===t?void 0:t.Flash)&&ri(y.Z.FLASH,t.Flash),(null===t||void 0===t?void 0:t.FocalLength)&&ri(y.Z.FOCAL_LENGTH,t.FocalLength.toString()),(null===t||void 0===t?void 0:t.ApertureValue)&&ri(y.Z.APERTURE,t.ApertureValue.toString()),(null===t||void 0===t?void 0:t.ISOSpeedRatings)&&ri(y.Z.ISO,t.ISOSpeedRatings.toString())]})]})}function li(e){var t,n=e.showInfo,r=e.handleCloseInfo,i=e.items,o=e.photoSwipe,a=e.metadata,s=e.exif,c=e.scheduleUpdate;return(0,le.jsxs)(Wr.Z,{show:n,onHide:r,children:[(0,le.jsx)(Wr.Z.Header,{closeButton:!0,children:(0,le.jsx)(Wr.Z.Title,{children:y.Z.INFO})}),(0,le.jsxs)(Wr.Z.Body,{children:[(0,le.jsx)("div",{children:(0,le.jsx)(ti,{children:y.Z.METADATA})}),ri(y.Z.FILE_ID,null===(t=i[null===o||void 0===o?void 0:o.getCurrentIndex()])||void 0===t?void 0:t.id),(null===a||void 0===a?void 0:a.title)&&(0,le.jsx)(si,{file:i[null===o||void 0===o?void 0:o.getCurrentIndex()],scheduleUpdate:c}),(null===a||void 0===a?void 0:a.creationTime)&&(0,le.jsx)(ii,{file:i[null===o||void 0===o?void 0:o.getCurrentIndex()],scheduleUpdate:c}),(null===a||void 0===a?void 0:a.modificationTime)&&ri(y.Z.UPDATED_ON,(0,I.o0)(a.modificationTime/1e3)),(null===a||void 0===a?void 0:a.longitude)>0&&(null===a||void 0===a?void 0:a.longitude)>0&&ri(y.Z.LOCATION,(0,le.jsx)("a",{href:"https://www.openstreetmap.org/?mlat=".concat(a.latitude,"&mlon=").concat(a.longitude,"#map=15/").concat(a.latitude,"/").concat(a.longitude),target:"_blank",rel:"noopener noreferrer",children:y.Z.SHOW_MAP})),s&&(0,le.jsx)(le.Fragment,{children:(0,le.jsx)(ci,{exif:s})})]}),(0,le.jsx)(Wr.Z.Footer,{children:(0,le.jsx)(we.Z,{variant:"outline-secondary",onClick:r,children:y.Z.CLOSE})})]})}var ui=function(e){var t=(0,l.useRef)(),n=(0,l.useState)(),r=n[0],o=n[1],s=e.isOpen,u=e.items,d=(0,l.useState)(!1),p=d[0],f=d[1],h=(0,l.useState)(!1),x=h[0],v=h[1],g=(0,l.useState)(null),m=g[0],w=g[1],b=(0,l.useState)(null),E=b[0],O=b[1],j=(0,l.useRef)(!1);function T(){f(_(null===this||void 0===this?void 0:this.currItem))}(0,l.useEffect)((function(){if(t)return s&&S(),s||C(),function(){C()}}),[s]),(0,l.useEffect)((function(){k(u)}),[u]),(0,l.useEffect)((function(){r&&(r.options.arrowKeys=!x,r.options.escKey=!x)}),[x]);var S=function(){var n=e.items,r={history:!1,maxSpreadZoom:5,index:e.currentIndex,showHideOpacity:!0,getDoubleTapZoom:function(e,t){return e?2.5:t.initialZoomLevel<.7?1:1.5},getThumbBoundsFn:function(e){try{var t=n[e],r=document.getElementById("thumb-".concat(t.id));if(r){var i=r.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop;return{x:i.left,y:i.top+o,w:i.width}}return null}catch(a){return null}}},i=new(Lr())(t.current,Mr(),n,r);Vr.forEach((function(t){var n=e[t];(n||"destroy"===t)&&i.listen(t,(function(){if(n){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];r.unshift(this),n.apply(void 0,r)}"destroy"===t&&Z(),"close"===t&&Z()}))})),i.listen("beforeChange",(function(){R.call(this),T.call(this)})),i.listen("resize",A),i.init(),j.current=!1,o(i)},C=function(){r&&r.close()},Z=function(){var t=e.onClose;"function"===typeof t&&t(j.current);var n,r=Qr(document.getElementsByTagName("video"));try{for(r.s();!(n=r.n()).done;){n.value.pause()}}catch(i){r.e(i)}finally{r.f()}D()},_=function(t){var n=e.favItemIds;return!(!n||!t)&&n.has(t.id)},P=function(){var t=(0,a.Z)(c().mark((function t(n){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.favItemIds,_(n)?(r.delete(n.id),X(n),f(!1)):(r.add(n.id),V(n),f(!0)),j.current=!0;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r&&(r.items.length=0,e.forEach((function(e){r.items.push(e)})),r.invalidateCurrItems())},A=function(){O(null),setTimeout((function(){var e=document.querySelector(".pswp__img:not(.pswp__img--placeholder)");e&&zr.ZP.parse(e).then((function(e){e&&(e.raw=function(e){for(var t="",n=0,r=Object.entries(e);n<r.length;n++){var o=(0,i.Z)(r[n],2),a=o[0],s=o[1];s instanceof Uint8Array?t+=a+" : ["+s+"]\r\n":s instanceof Date?t+=a+" : "+s.toDateString()+"\r\n":t+=a+" : "+s+"\r\n"}return t}(e),O(e))}))}),100)};function R(){var e=null===this||void 0===this?void 0:this.currItem;null!==e&&void 0!==e&&e.metadata&&(w(e.metadata),O(null),A())}var D=function(){v(!1)},N=function(){var t=(0,a.Z)(c().mark((function t(n){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.loadingBar).current.continuousStart(),t.next=4,(0,I.Sv)(n);case 4:r.current.complete();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),L=e.id,F=e.className;return F=Ur()(["pswp",F]).trim(),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("div",{id:L,className:F,tabIndex:Number("-1"),role:"dialog","aria-hidden":"true",ref:t,children:[(0,le.jsx)("div",{className:"pswp__bg"}),(0,le.jsxs)("div",{className:"pswp__scroll-wrap",children:[(0,le.jsxs)("div",{className:"pswp__container",children:[(0,le.jsx)("div",{className:"pswp__item"}),(0,le.jsx)("div",{className:"pswp__item"}),(0,le.jsx)("div",{className:"pswp__item"})]}),(0,le.jsxs)("div",{className:"pswp__ui pswp__ui--hidden",children:[(0,le.jsxs)("div",{className:"pswp__top-bar",children:[(0,le.jsx)("div",{className:"pswp__counter"}),(0,le.jsx)("button",{className:"pswp__button pswp__button--close",title:y.Z.CLOSE}),(0,le.jsx)("button",{className:"pswp-custom download-btn",title:y.Z.DOWNLOAD,onClick:function(){return N(r.currItem)}}),(0,le.jsx)("button",{className:"pswp__button pswp__button--fs",title:y.Z.TOGGLE_FULLSCREEN}),(0,le.jsx)("button",{className:"pswp__button pswp__button--zoom",title:y.Z.ZOOM_IN_OUT}),!e.isSharedCollection&&!e.isTrashCollection&&(0,le.jsx)(Gr,{size:44,isClick:p,onClick:function(){P(null===r||void 0===r?void 0:r.currItem)}}),(0,le.jsx)("button",{className:"pswp-custom info-btn",title:y.Z.INFO,onClick:function(){v(!0)}}),(0,le.jsx)("div",{className:"pswp__preloader",children:(0,le.jsx)("div",{className:"pswp__preloader__icn",children:(0,le.jsx)("div",{className:"pswp__preloader__cut",children:(0,le.jsx)("div",{className:"pswp__preloader__donut"})})})})]}),(0,le.jsx)("div",{className:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap",children:(0,le.jsx)("div",{className:"pswp__share-tooltip"})}),(0,le.jsx)("button",{className:"pswp__button pswp__button--arrow--left",title:y.Z.PREVIOUS}),(0,le.jsx)("button",{className:"pswp__button pswp__button--arrow--right",title:y.Z.NEXT}),(0,le.jsx)("div",{className:"pswp__caption",children:(0,le.jsx)("div",{})})]})]})]}),(0,le.jsx)(li,{showInfo:x,handleCloseInfo:D,items:u,photoSwipe:r,metadata:m,exif:E,scheduleUpdate:function(){return j.current=!0}})]})};var di=function(e){return function(t){var n=!0;return(e.month||0===e.month)&&(n=e.month===t.getMonth()),n&&e.date&&(n=e.date===t.getDate()),n&&e.year&&(n=e.year===t.getFullYear()),n}};function pi(e){var t,n,r,i={};return e.date&&(i.day="numeric"),(e.month||0===e.month)&&(i.month="long"),e.year&&(i.year="numeric"),new Intl.DateTimeFormat("en-IN",i).format(new Date(null!==(t=e.year)&&void 0!==t?t:1,null!==(n=e.month)&&void 0!==n?n:1,null!==(r=e.date)&&void 0!==r?r:1))}function fi(e){return hi.apply(this,arguments)}function hi(){return(hi=(0,a.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var n=setTimeout((function(){e(!1)}),1e3),r=document.createElement("video");r.addEventListener("canplay",(function(){clearTimeout(n),e(!0)})),r.src=t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xi=n(87302);function vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vi(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mi;!function(e){e.TIME="TIME",e.TILE="TILE",e.BANNER="BANNER"}(mi||(mi={}));var wi=f.ZP.div.withConfig({displayName:"PhotoList__ListItem",componentId:"sc-wfu223-0"})(["display:flex;justify-content:center;"]),yi=f.ZP.div.withConfig({displayName:"PhotoList__ListContainer",componentId:"sc-wfu223-1"})(["user-select:none;display:grid;grid-template-columns:",";grid-column-gap:","px;padding:0 24px;width:100%;color:#fff;@media (max-width:","px){padding:0 4px;}"],(function(e){return function(e,t){if(t){var n=t.reduce((function(e,t){return e+t}),0);return n<e&&(t[t.length-1]+=e-n),t.map((function(e){return"repeat(".concat(e,", 1fr)")})).join(" ".concat(_e.BV,"px "))}return"repeat(".concat(e,", 1fr)")}(e.columns,e.groups)}),_e.dP,4*_e.C3),bi=f.ZP.div.withConfig({displayName:"PhotoList__DateContainer",componentId:"sc-wfu223-2"})(["user-select:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;grid-column:span ",";display:flex;align-items:center;height:","px;"],(function(e){return e.span}),_e.xU),Ei=f.ZP.div.withConfig({displayName:"PhotoList__BannerContainer",componentId:"sc-wfu223-3"})(["color:#979797;text-align:center;grid-column:span ",";display:flex;justify-content:center;align-items:flex-end;"],(function(e){return e.span})),Oi=f.ZP.div.withConfig({displayName:"PhotoList__NothingContainer",componentId:"sc-wfu223-4"})(["color:#979797;text-align:center;grid-column:span ",";display:flex;justify-content:center;align-items:center;"],(function(e){return e.span}));function ji(e){var t,n,r=e.height,i=e.width,o=e.filteredData,a=e.showBanner,s=e.getThumbnail,c=e.activeCollection,u=e.resetFetching,d=(0,l.useRef)([]),p=null!==(t=null===d||void 0===d?void 0:d.current)&&void 0!==t?t:[],f=(0,l.useRef)([]),h=null!==(n=f.current)&&void 0!==n?n:[],x=(0,l.useRef)(null),v=Math.floor(i/_e.C3),g=_e.Ho,m=!1;v<_e.yc&&(v=_e.yc,g=i/_e.yc,m=!0);(0,l.useEffect)((function(){var e=[],t=0,n=-1;o.forEach((function(r,i){if(w(new Date(r.metadata.creationTime/1e3),new Date(n)))t<v?(e[e.length-1].items.push(r),t++):(t=1,e.push({itemType:mi.TILE,items:[r],itemStartIndex:i}));else{n=r.metadata.creationTime/1e3;var o=new Intl.DateTimeFormat("en-IN",{weekday:"short",year:"numeric",month:"short",day:"numeric"});e.push({itemType:mi.TIME,date:w(new Date(n),new Date)?"Today":w(new Date(n),new Date(Date.now()-864e5))?"Yesterday":o.format(n),id:n.toString()}),e.push({itemType:mi.TILE,items:[r],itemStartIndex:i}),t=1}})),m||(e=O(e,v)),0===e.length&&e.push(b()),a&&e.push(E(e)),d.current=e,f.current=o,function(){var e;null===(e=x.current)||void 0===e||e.resetAfterIndex(0),u()}()}),[i,r,o,a]);var w=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},b=function(){return{itemType:mi.BANNER,banner:(0,le.jsx)(Oi,{span:v,children:(0,le.jsx)("div",{children:y.Z.NOTHING_HERE})}),id:"empty-list-banner",height:r-48}},E=function(e){var t=function(){for(var t=0,n=j(e),r=0;r<e.length;r++)t+=n(r);return t}();return{itemType:mi.BANNER,banner:(0,le.jsx)(Ei,{span:v,children:(0,le.jsx)("p",{children:y.Z.INSTALL_MOBILE_APP()})}),id:"install-banner",height:Math.max(48,r-t)}},O=function(e,t){for(var n=[],r=0,i=0;r<e.length;){var o=e[r];o.itemType===mi.TIME?n[i]?n[i+1].items.length+e[r+1].items.length<=t?(n[i].dates.push({date:o.date,span:e[r+1].items.length}),n[i+1].items=n[i+1].items.concat(e[r+1].items),r+=2):i+=2:(n.push(gi(gi({},o),{},{date:null,dates:[{date:o.date,span:e[r+1].items.length}]})),n.push(e[r+1]),r+=2):(n.push(o),r++,i=n.length)}for(var a=0;a<n.length;a++){var s=n[a],c=n[a+1];s.itemType===mi.TIME&&s.dates.length>1&&(s.groups=s.dates.map((function(e){return e.span})),c.groups=s.groups)}return n},j=function(e){return function(t){switch(e[t].itemType){case mi.TIME:return _e.xU;case mi.TILE:return g;default:return e[t].height}}},I=Math.ceil(2*r/_e.Ho),T=function(e){switch(e.itemType){case mi.TIME:return e.dates?e.dates.map((function(e){return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(bi,{span:e.span,children:e.date},e.date),(0,le.jsx)("div",{})]})})):(0,le.jsx)(bi,{span:v,children:e.date});case mi.BANNER:return e.banner;default:var t=e.items.map((function(t,n){return s(h,e.itemStartIndex+n)}));if(e.groups)for(var n=0,r=0;r<e.groups.length-1;r++)n+=e.groups[r],t.splice(n,0,(0,le.jsx)("div",{})),n+=1;return t}};return(0,le.jsx)(xi.S_,{ref:x,itemSize:j(p),height:r,width:i,itemCount:p.length,itemKey:function(e){switch(p[e].itemType){case mi.TILE:return"".concat(p[e].items[0].id,"-").concat(p[e].items.slice(-1)[0].id);default:return"".concat(p[e].id,"-").concat(e)}},overscanCount:I,children:function(e){var t=e.index,n=e.style;return(0,le.jsx)(wi,{style:n,children:(0,le.jsx)(yi,{columns:v,groups:p[t].groups,children:T(p[t])})})}},"".concat(c))}function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Si=f.ZP.div.withConfig({displayName:"PhotoFrame__Container",componentId:"sc-1b7sfkt-0"})(["display:block;flex:1;width:100%;flex-wrap:wrap;margin:0 auto;overflow-x:hidden;.pswp-thumbnail{display:inline-block;cursor:pointer;}"]),Ci=f.ZP.div.withConfig({displayName:"PhotoFrame__EmptyScreen",componentId:"sc-1b7sfkt-1"})(["display:flex;justify-content:center;align-items:center;flex-direction:column;flex:1;color:#51cd7c;& > svg{filter:drop-shadow(3px 3px 5px rgba(45,194,98,0.5));}"]),Zi=function(e){var t,n=e.files,i=e.setFiles,o=e.syncWithRemote,s=e.favItemIds,u=e.setSelected,d=e.selected,f=e.isFirstLoad,h=e.openFileUploader,x=e.loadingBar,v=e.isInSearchMode,g=e.search,m=e.setSearchStats,w=e.deleted,b=e.activeCollection,E=e.isSharedCollection,O=(0,l.useState)(!1),j=O[0],T=O[1],S=(0,l.useState)(0),C=S[0],Z=S[1],_=(0,l.useState)({}),P=_[0],k=_[1],A=Date.now(),R=(0,l.useContext)(La),D=(0,l.useState)(null),N=D[0],L=D[1],F=(0,l.useState)(null),M=F[0],B=F[1],U=(0,l.useState)(!1),H=U[0],G=U[1],z=(0,l.useRef)([]),W=null!==(t=null===z||void 0===z?void 0:z.current)&&void 0!==t?t:[];(0,l.useEffect)((function(){var e=function(e){"Shift"===e.key&&G(!0)},t=function(e){"Shift"===e.key&&G(!1)};return document.addEventListener("keydown",e,!1),document.addEventListener("keyup",t,!1),function(){document.addEventListener("keydown",e,!1),document.addEventListener("keyup",t,!1)}}),[]),(0,l.useEffect)((function(){if(v&&m({resultCount:W.length,timeTaken:(Date.now()-A)/1e3}),g.fileIndex||0===g.fileIndex){var e=W.findIndex((function(e){return e.dataIndex===g.fileIndex}));(e||0===e)&&K(e)()}}),[g]);var V=function(){k({})};(0,l.useEffect)((function(){0===d.count&&L(null)}),[d]),(0,l.useEffect)((function(){var e=new Set;z.current=n.map((function(e,t){return Ti(Ti({},e),{},{dataIndex:t,w:window.innerWidth,h:window.innerHeight},e.deleteBy&&{title:y.Z.AUTOMATIC_BIN_DELETE_MESSAGE((0,I.Km)(e.deleteBy/1e3))})})).filter((function(t){return!w.includes(t.id)&&(!(g.date&&!di(g.date)(new Date(t.metadata.creationTime/1e3)))&&((!g.location||(n=t.metadata,r=g.location,(null!==n.latitude||null!==n.longitude)&&n.longitude>=r[0]&&n.latitude>=r[1]&&n.longitude<=r[2]&&n.latitude<=r[3]))&&((b!==Tn||!(0,I.Ll)(t))&&(!(b===jn&&!(0,I.Ll)(t))&&(!((0,I.eO)(t)&&!E)&&(!(b===In&&!t.isTrashed)&&((b===In||!t.isTrashed)&&(!e.has(t.id)&&((b===Tn||b===jn||b===In||b===t.collectionID)&&(e.add(t.id),!0))))))))));var n,r}))}),[n,w,g,b]);var X=function(e){return function(t){n[e]=Ti(Ti({},n[e]),{},{msrc:t,src:n[e].src?n[e].src:t,w:window.innerWidth,h:window.innerHeight}),n[e].metadata.fileType!==p.Gk.VIDEO||n[e].html||(n[e].html='\n                <div class="video-loading">\n                    <img src="'.concat(t,'" />\n                    <div class="spinner-border text-light" role="status">\n                        <span class="sr-only">Loading...</span>\n                    </div>\n                </div>\n            '),delete n[e].src),n[e].metadata.fileType!==p.Gk.IMAGE||n[e].src||(n[e].src=t),i(n)}},Y=function(){var e=(0,a.Z)(c().mark((function e(t,r){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n[t]=Ti(Ti({},n[t]),{},{w:window.innerWidth,h:window.innerHeight}),n[t].metadata.fileType!==p.Gk.VIDEO){e.next=11;break}return e.next=4,fi(r);case 4:if(!e.sent){e.next=8;break}n[t].html='\n                <video controls>\n                    <source src="'.concat(r,'" />\n                    Your browser does not support the video tag.\n                </video>\n            '),e.next=9;break;case 8:n[t].html='\n                <div class="video-loading">\n                    <img src="'.concat(n[t].msrc,'" />\n                    <div class="download-message" >\n                        ').concat(y.Z.VIDEO_PLAYBACK_FAILED_DOWNLOAD_INSTEAD,'\n                        <a class="btn btn-outline-success" href=').concat(r,' download="').concat(n[t].metadata.title,'"">Download</button>\n                    </div>\n                </div>\n                ');case 9:e.next=12;break;case 11:n[t].src=r;case 12:i(n);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),K=function(e){return function(){Z(e),T(!0)}},q=function(e,t){return function(n){d.collectionID!==b&&u({count:0,collectionID:0}),n&&L(t),u((function(t){var i;return Ti(Ti({},t),{},(i={},(0,r.Z)(i,e,n),(0,r.Z)(i,"count",n?t.count+1:t.count-1),(0,r.Z)(i,"collectionID",b),i))}))}},J=function(e){return function(){B(e)}},Q=function(e){return function(){if(N!==e){var t=-1,n=-1;e<N?(t=e+1,n=N-1):(t=N+1,n=e-1);for(var r=t;r<=n;r++)q(W[r].id)(!0)}}},$=function(e,t){var n;return(0,le.jsx)(Rr,{file:e[t],updateUrl:X(e[t].dataIndex),onClick:K(t),selectable:!E,onSelect:q(e[t].id,t),selected:d.collectionID===b&&d[e[t].id],selectOnClick:d.count>0,onHover:J(t),onRangeSelect:Q(t),isRangeSelectActive:H&&(N||0===N),isInsSelectRange:t>=N&&t<=M||t>=M&&t<=N},"tile-".concat(e[t].id,"-selected-").concat(null!==(n=d[e[t].id])&&void 0!==n&&n))},ee=function(){var e=(0,a.Z)(c().mark((function e(t,r,i){var o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.msrc){e.next=20;break}if(e.prev=1,!R.thumbs.has(i.id)){e.next=6;break}o=R.thumbs.get(i.id),e.next=10;break;case 6:return e.next=8,Ke.Z.getThumbnail(i);case 8:o=e.sent,R.thumbs.set(i.id,o);case 10:X(i.dataIndex)(o),i.msrc=o,i.src||(i.src=o),i.w=window.innerWidth,i.h=window.innerHeight;try{t.invalidateCurrItems(),t.updateSize(!0)}catch(r){}e.next=20;break;case 18:e.prev=18,e.t0=e.catch(1);case 20:if(P[i.dataIndex]){e.next=45;break}if(e.prev=21,P[i.dataIndex]=!0,!R.files.has(i.id)){e.next=27;break}a=R.files.get(i.id),e.next=31;break;case 27:return e.next=29,Ke.Z.getFile(i,!0);case 29:a=e.sent,R.files.set(i.id,a);case 31:return e.next=33,Y(i.dataIndex,a);case 33:i.html=n[i.dataIndex].html,i.src=n[i.dataIndex].src,i.w=n[i.dataIndex].w,i.h=n[i.dataIndex].h;try{t.invalidateCurrItems(),t.updateSize(!0)}catch(r){}e.next=42;break;case 40:e.prev=40,e.t1=e.catch(21);case 42:return e.prev=42,P[i.dataIndex]=!1,e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[1,18],[21,40,42,45]])})));return function(t,n,r){return e.apply(this,arguments)}}();return(0,le.jsx)(le.Fragment,{children:f||0!==n.length||v?(0,le.jsxs)(Si,{children:[(0,le.jsx)(Dr.Z,{children:function(e){var t=e.height,r=e.width;return(0,le.jsx)(ji,{width:r,height:t,getThumbnail:$,filteredData:W,activeCollection:b,showBanner:n.length<30&&!v,resetFetching:V})}}),(0,le.jsx)(ui,{isOpen:j,items:W,currentIndex:C,onClose:function(e){T(!1),e&&o()},gettingData:ee,favItemIds:s,loadingBar:x,isSharedCollection:E,isTrashCollection:b===In})]}):(0,le.jsxs)(Ci,{children:[(0,le.jsx)("img",{height:150,src:"/images/gallery.png"}),(0,le.jsx)("div",{style:{color:"#a6a6a6",marginTop:"16px"},children:y.Z.UPLOAD_FIRST_PHOTO_DESCRIPTION}),(0,le.jsx)(we.Z,{variant:"outline-success",onClick:h,style:{marginTop:"32px",paddingLeft:"32px",paddingRight:"32px",paddingTop:"12px",paddingBottom:"12px",fontWeight:900},children:y.Z.UPLOAD_FIRST_PHOTO})]})})},_i=n(32320),Pi=n(7615),ki=n(69496),Ai=n.n(ki),Ri=n(72174),Di=(n(34155),(0,x.O3)()),Ni=new Set(["0","1","2","3","4","5","6","7","8","9"]);function Li(e){var t=Ri.parseDate(e),n=Ri.parseDate("".concat(e," 1"));if(null!==t){var r=[{month:t.getMonth()},{date:t.getDate(),month:t.getMonth()}],i=!1;return e.split("").forEach((function(e){Ni.has(e)&&(i=!0)})),i?r.reverse():r}return n?[{month:n.getMonth()}]:[]}function Fi(e){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,a.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.Z.get("".concat(Di,"/search/location"),{query:t,limit:4},{"X-Auth-Token":(0,m.LP)()});case 3:return r=e.sent,e.abrupt("return",null!==(n=r.data.results)&&void 0!==n?n:[]);case 7:e.prev=7,e.t0=e.catch(0),(0,O.H)(e.t0,"location search failed");case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Bi(e){return[{label:"Christmas",value:{month:11,date:25},type:Qi.DATE},{label:"Christmas Eve",value:{month:11,date:24},type:Qi.DATE},{label:"New Year",value:{month:0,date:1},type:Qi.DATE},{label:"New Year Eve",value:{month:11,date:31},type:Qi.DATE}].filter((function(t){return t.label.toLowerCase().includes(e)}))}function Ui(e){if(4===e.length)try{var t=parseInt(e);if(t>=1970&&t<=(new Date).getFullYear())return[{label:e,value:{year:t},type:Qi.DATE}]}catch(n){(0,O.H)(n,"getYearSuggestion failed")}return[]}function Hi(e,t){return t.filter((function(t){return t.name.toLowerCase().includes(e)}))}function Gi(e,t){return t.map((function(e,t){return{title:e.metadata.title,index:t,type:e.metadata.fileType,ownerID:e.ownerID,id:e.id}})).filter((function(t){return t.title.toLowerCase().includes(e)})).slice(0,4)}function zi(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:[(0,le.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.88-2.88 7.19-5 9.88C9.92 16.21 7 11.85 7 9z"}),(0,le.jsx)("circle",{cx:"12",cy:"9",r:"2.5"})]})}function Wi(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:(0,le.jsx)("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm-4.5-7a2.5 2.5 0 0 0 0 5 2.5 2.5 0 0 0 0-5z"})})}function Vi(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:(0,le.jsx)("path",{d:"M20.49 19l-5.73-5.73C15.53 12.2 16 10.91 16 9.5A6.5 6.5 0 1 0 9.5 16c1.41 0 2.7-.47 3.77-1.24L19 20.49 20.49 19zM5 9.5C5 7.01 7.01 5 9.5 5S14 7.01 14 9.5 11.99 14 9.5 14 5 11.99 5 9.5z"})})}function Xi(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:(0,le.jsx)("path",{d:"M6.083 4c1.38 1.612 2.578 3 4.917 3h11v13h-20v-16h4.083zm.917-2h-7v20h24v-17h-13c-1.629 0-2.305-1.058-4-3z"})})}function Yi(e){return(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"})]})}function Ki(e){return(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M4 6.47L5.76 10H20v8H4V6.47M22 4h-4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4z"})})}function qi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ji(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}zi.defaultProps={height:20,width:20,viewBox:"0 0 24 24"},Wi.defaultProps={height:20,width:20,viewBox:"0 0 24 24"},Vi.defaultProps={height:24,width:24,viewBox:"0 0 24 24",open:!1},Xi.defaultProps={height:20,width:20,viewBox:"0 0 24 24"},Yi.defaultProps={height:24,width:24,viewBox:"0 0 24 24"},Ki.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var Qi,$i=f.ZP.div.withConfig({displayName:"SearchBar__Wrapper",componentId:"sc-nlm1w0-0"})(["position:fixed;top:0;z-index:1000;display:",";width:100%;background:#111;@media (min-width:625px){display:flex;width:calc(100vw - 140px);margin:0 70px;}align-items:center;min-height:64px;transition:opacity 1s ease;opacity:",";margin-bottom:10px;"],(function(e){return e.isOpen?"flex":"none"}),(function(e){return e.isDisabled?0:1})),eo=f.ZP.div.withConfig({displayName:"SearchBar__SearchButton",componentId:"sc-nlm1w0-1"})(["display:none;@media (max-width:624px){display:",";right:80px;cursor:pointer;position:fixed;top:0;z-index:1000;align-items:center;min-height:64px;}"],(function(e){return e.isOpen?"none":"flex"})),to=f.ZP.div.withConfig({displayName:"SearchBar__SearchStatsContainer",componentId:"sc-nlm1w0-2"})(["display:flex;justify-content:center;align-items:center;color:#979797;margin-bottom:8px;"]),no=f.ZP.div.withConfig({displayName:"SearchBar__SearchInput",componentId:"sc-nlm1w0-3"})(["width:100%;display:flex;align-items:center;max-width:484px;margin:auto;"]);function ro(e){var t=(0,l.useState)(null),n=t[0],r=t[1];(0,l.useEffect)((function(){return u(n)}),[n]);var i=function(){var t=(0,a.Z)(c().mark((function t(n){var r,i,a,s,l,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=n.trim().toLowerCase(),null!==(r=n)&&void 0!==r&&r.length){t.next=3;break}return t.abrupt("return",[]);case 3:return i=[].concat((0,o.Z)(Bi(n)),(0,o.Z)(Ui(n))),a=Li(n),i.push.apply(i,(0,o.Z)(a.map((function(e){return{type:Qi.DATE,value:e,label:pi(e)}})))),s=Hi(n,e.collections),i.push.apply(i,(0,o.Z)(s.map((function(e){return{type:Qi.COLLECTION,value:e.id,label:e.name}})))),l=Gi(n,e.files),i.push.apply(i,(0,o.Z)(l.map((function(e){return{type:e.type===p.Gk.IMAGE?Qi.IMAGE:Qi.VIDEO,value:e.index,label:e.title}})))),t.next=12,Fi(n);case 12:return u=t.sent,i.push.apply(i,(0,o.Z)(u.map((function(e){return{type:Qi.LOCATION,value:e.bbox,label:e.place}})))),t.abrupt("return",i);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=Ai()(i,250),u=function(t){if(t)switch(t.type){case Qi.DATE:e.setSearch({date:t.value}),e.setOpen(!0);break;case Qi.LOCATION:e.setSearch({location:t.value}),e.setOpen(!0);break;case Qi.COLLECTION:e.setActiveCollection(t.value),r(null);break;case Qi.IMAGE:case Qi.VIDEO:e.setSearch({fileIndex:t.value}),r(null)}},d=function(e){switch(e){case Qi.DATE:return(0,le.jsx)(Wi,{});case Qi.LOCATION:return(0,le.jsx)(zi,{});case Qi.COLLECTION:return(0,le.jsx)(Xi,{});case Qi.IMAGE:return(0,le.jsx)(Yi,{});case Qi.VIDEO:return(0,le.jsx)(Ki,{});default:return(0,le.jsx)(Vi,{})}},f=function(e){return(0,le.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,le.jsx)("span",{style:{paddingRight:"10px",paddingBottom:"4px"},children:d(e.type)}),(0,le.jsx)("span",{children:e.label})]})},h=Pi.c.Option,x=Pi.c.Control,v={control:function(e,t){var n=t.isFocused;return Ji(Ji({},e),{},{backgroundColor:"#282828",color:"#d1d1d1",borderColor:n?"#51cd7c":"#444",boxShadow:"none",":hover":{borderColor:"#51cd7c",cursor:"text","&>.icon":{color:"#51cd7c"}}})},input:function(e){return Ji(Ji({},e),{},{color:"#d1d1d1"})},menu:function(e){return Ji(Ji({},e),{},{marginTop:"10px",backgroundColor:"#282828"})},option:function(e,t){var n=t.isFocused;return Ji(Ji({},e),{},{backgroundColor:n&&"#343434"})},dropdownIndicator:function(e){return Ji(Ji({},e),{},{display:"none"})},indicatorSeparator:function(e){return Ji(Ji({},e),{},{display:"none"})},clearIndicator:function(e){return Ji(Ji({},e),{},{display:"none"})},singleValue:function(e,t){return Ji(Ji({},e),{},{backgroundColor:"#282828",color:"#d1d1d1",display:t.selectProps.menuIsOpen?"none":"block"})},placeholder:function(e){return Ji(Ji({},e),{},{color:"#686868",wordSpacing:"2px",whiteSpace:"nowrap"})}};return(0,le.jsxs)(le.Fragment,{children:[e.searchStats&&(0,le.jsx)(to,{children:y.Z.SEARCH_STATS(e.searchStats)}),(0,le.jsx)($i,{isDisabled:e.isFirstFetch,isOpen:e.isOpen,children:(0,le.jsxs)(no,{children:[(0,le.jsx)("div",{style:{flex:1,margin:"10px"},children:(0,le.jsx)(_i.ZP,{value:n,components:{Option:function(e){return(0,le.jsx)(h,Ji(Ji({},e),{},{children:(0,le.jsx)(f,{type:e.data.type,label:e.data.label})}))},Control:function(e){var t;return(0,le.jsxs)(x,Ji(Ji({},e),{},{children:[(0,le.jsx)("span",{className:"icon",style:{paddingLeft:"10px",paddingBottom:"4px"},children:d(null===(t=e.getValue()[0])||void 0===t?void 0:t.type)}),e.children]}))}},placeholder:y.Z.SEARCH_HINT(),loadOptions:s,onChange:function(e){r(e)},isClearable:!0,escapeClearsValue:!0,styles:v,noOptionsMessage:function(){return null}})}),e.isOpen&&(0,le.jsx)(Pe.hU,{onClick:function(){return function(){var t;e.isOpen&&(null===(t=e.loadingBar.current)||void 0===t||t.continuousStart(),e.setSearch({}),setTimeout((function(){var t;null===(t=e.loadingBar.current)||void 0===t||t.complete()}),10),e.setOpen(!1),r(null))}()},children:(0,le.jsx)(ue,{})})]})}),(0,le.jsx)(eo,{isOpen:e.isOpen,onClick:function(){return!e.isFirstFetch&&e.setOpen(!0)},children:(0,le.jsx)(Vi,{})})]})}!function(e){e[e.DATE=0]="DATE",e[e.LOCATION=1]="LOCATION",e[e.COLLECTION=2]="COLLECTION",e[e.IMAGE=3]="IMAGE",e[e.VIDEO=4]="VIDEO"}(Qi||(Qi={}));var io=n(24479),oo=f.ZP.div.withConfig({displayName:"AddCollectionButton__ImageContainer",componentId:"sc-c20zst-0"})(["min-height:192px;max-width:192px;border:1px solid #555;display:flex;align-items:center;justify-content:center;font-size:42px;cursor:pointer;"]);function ao(e){var t=e.showNextModal;return(0,le.jsx)(uo,{style:{margin:"10px"},onClick:function(){return t()},children:(0,le.jsxs)(io.Z,{children:[(0,le.jsx)(oo,{children:"+"}),(0,le.jsx)(io.Z.Text,{style:{textAlign:"center"},children:y.Z.CREATE_COLLECTION})]})})}var so=["attributes","collectionsAndTheirLatestFile"];function co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?co(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var uo=f.ZP.div.withConfig({displayName:"CollectionSelector__CollectionIcon",componentId:"sc-l999ji-0"})(["width:200px;margin:10px;height:240px;padding:4px;color:black;border-width:4px;border-radius:34px;outline:none;"]),po=(0,f.ZP)(io.Z).withConfig({displayName:"CollectionSelector__CollectionCard",componentId:"sc-l999ji-1"})(["display:flex;flex-direction:column;height:221px;"]);var fo=function(e){var t=e.attributes,n=e.collectionsAndTheirLatestFile,r=(0,St.Z)(e,so),i=(0,l.useState)([]),o=i[0],a=i[1];if((0,l.useEffect)((function(){if(t){var e=(0,v.Yu)(v.Pd.USER),i=null===n||void 0===n?void 0:n.filter((function(n){return n.collection.id!==t.fromCollection&&n.collection.owner.id===(null===e||void 0===e?void 0:e.id)&&n.collection.type!==_.favorites}));0===i.length?(r.onHide(),t.showNextModal()):a(i)}}),[r.show]),!t)return(0,le.jsx)(Wr.Z,{});var s=null===o||void 0===o?void 0:o.map((function(e){return(0,le.jsx)(uo,{onClick:function(){t.callback(e.collection),r.onHide()},children:(0,le.jsxs)(po,{children:[(0,le.jsx)(Rr,{file:e.file,updateUrl:function(){},forcedEnable:!0}),(0,le.jsx)(io.Z.Text,{className:"text-center",children:e.collection.name})]})},e.collection.id)}));return(0,le.jsxs)(Wr.Z,lo(lo({},r),{},{size:"xl",centered:!0,contentClassName:"plan-selector-modal-content",children:[(0,le.jsx)(Wr.Z.Header,{closeButton:!0,onHide:function(){return r.onHide(!0)},children:(0,le.jsx)(Wr.Z.Title,{children:t.title})}),(0,le.jsxs)(Wr.Z.Body,{style:{display:"flex",flexWrap:"wrap"},children:[(0,le.jsx)(ao,{showNextModal:t.showNextModal}),s]})]}))},ho=["attributes"];function xo(e){var t=e.attributes,n=(0,St.Z)(e,ho),r=(0,l.useRef)(null);if((0,l.useEffect)((function(){t&&setTimeout((function(){var e;null===(e=r.current)||void 0===e||e.focus()}),200)}),[t]),!t)return(0,le.jsx)(ke.Z,{show:!1,onHide:function(){return null},attributes:{}});return(0,le.jsx)(ke.Z,{show:n.show,onHide:n.onHide,size:"sm",attributes:{title:null===t||void 0===t?void 0:t.title},children:(0,le.jsx)(wt.J9,{initialValues:{albumName:t.autoFilledName},validationSchema:yt.Ry().shape({albumName:yt.Z_().required(y.Z.REQUIRED)}),validateOnChange:!1,validateOnBlur:!1,onSubmit:function(e){var r=e.albumName;t.callback(r),n.onHide()},children:function(e){var n=e.values,i=e.touched,o=e.errors,a=e.handleChange,s=e.handleSubmit;return(0,le.jsxs)(bt.Z,{noValidate:!0,onSubmit:s,children:[(0,le.jsxs)(bt.Z.Group,{children:[(0,le.jsx)(bt.Z.Control,{className:"text-center",type:"text",value:n.albumName,onChange:a("albumName"),isInvalid:Boolean(i.albumName&&o.albumName),placeholder:y.Z.ENTER_ALBUM_NAME,ref:r,autoFocus:!0}),(0,le.jsx)(bt.Z.Control.Feedback,{type:"invalid",className:"text-center",children:o.albumName})]}),(0,le.jsx)(It.Z,{buttonText:t.buttonText,loading:!1})]})}})})}function vo(e){return(0,le.jsx)("div",{style:{color:je(ge.danger),display:"inline-block",padding:"0 10px"},children:(0,le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"currentColor",children:(0,le.jsx)("path",{d:"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1 6h2v8h-2v-8zm1 12.25c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25z"})})})}vo.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var go=f.ZP.div.withConfig({displayName:"AlertBanner__Banner",componentId:"sc-pxyst2-0"})(["border:1px solid ",";border-radius:8px;padding:16px 28px;color:#eee;margin-top:10px;"],je(ge.warning));function mo(e){return e.bannerMessage?(0,le.jsx)(Pe.A0,{children:(0,le.jsxs)(go,{children:[(0,le.jsx)(vo,{}),e.bannerMessage&&e.bannerMessage]})}):(0,le.jsx)(le.Fragment,{})}var wo=f.ZP.div.withConfig({displayName:"UploadButton__Wrapper",componentId:"sc-1s07xds-0"})(["position:fixed;display:flex;align-items:center;justify-content:center;top:0;z-index:100;min-height:64px;right:32px;transition:opacity 1s ease;cursor:pointer;opacity:",";"],(function(e){return e.isDisabled?0:1}));var yo=function(e){var t=e.openFileUploader,n=e.isFirstFetch;return(0,le.jsx)(wo,{onClick:t,isDisabled:n,children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"green",width:"32px",height:"32px",children:[(0,le.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,le.jsx)("path",{fill:"#51cd7c",d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10zM8 13.01l1.41 1.41L11 12.84V17h2v-4.16l1.59 1.59L16 13.01 12.01 9 8 13.01z"})]})})};function bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oo(e){return(0,le.jsxs)("svg",Eo(Eo({xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width},e),{},{children:[(0,le.jsx)("rect",{fill:"none",height:"24",width:"24"}),(0,le.jsx)("path",{d:"M15,5l-1.41,1.41L18.17,11H2V13h16.17l-4.59,4.59L15,19l7-7L15,5z"})]}))}Oo.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var jo,Io=f.ZP.div.withConfig({displayName:"PlanSelector__PlanIcon",componentId:"sc-arp8w6-0"})(["border-radius:20px;width:220px;border:2px solid #333;padding:30px;margin:10px;text-align:center;font-size:20px;background-color:#ffffff00;display:flex;justify-content:center;align-items:center;flex-direction:column;cursor:",";border-color:",";transition:all 0.3s ease-out;overflow:hidden;position:relative;& > div:first-child::before{content:' ';height:600px;width:50px;background-color:#444;left:0;top:-50%;position:absolute;transform:rotate(45deg) translateX(-200px);transition:all 0.5s ease-out;}&:hover{transform:scale(1.1);background-color:#ffffff11;}&:hover > div:first-child::before{transform:rotate(45deg) translateX(300px);}"],(function(e){return e.selected?"not-allowed":"pointer"}),(function(e){return e.selected&&"#56e066"}));!function(e){e.MONTH="month",e.YEAR="year"}(jo||(jo={}));var To=function(e){var t,n=(0,ce.rE)(),r=(0,l.useState)(null),i=r[0],s=r[1],u=(0,l.useState)(jo.YEAR),d=u[0],p=u[1];function f(e){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)(c().mark((function t(r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,ce.LN)(n)||(0,ce.CF)(n)||(0,ce.gd)(n)){t.next=4;break}e.setDialogMessage({title:y.Z.ERROR,content:y.Z.CANCEL_SUBSCRIPTION_ON_MOBILE,close:{variant:"danger"}}),t.next=18;break;case 4:if(!(0,ce.CF)(n)){t.next=8;break}e.setDialogMessage({title:"".concat(y.Z.CONFIRM," ").concat((0,Te._V)(y.Z.UPDATE_SUBSCRIPTION)),content:y.Z.UPDATE_SUBSCRIPTION_MESSAGE,staticBackdrop:!0,proceed:{text:y.Z.UPDATE_SUBSCRIPTION,action:ce.Mg.bind(null,r,e.setDialogMessage,e.setLoading,e.closeModal),variant:"success"},close:{text:y.Z.CANCEL}}),t.next=18;break;case 8:return t.prev=8,e.setLoading(!0),t.next=12,se.Z.buySubscription(r.stripeID);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(8),e.setLoading(!1),e.setDialogMessage({title:y.Z.ERROR,content:y.Z.SUBSCRIPTION_PURCHASE_FAILED,close:{variant:"danger"}});case 18:case"end":return t.stop()}}),t,null,[[8,14]])})))).apply(this,arguments)}(0,l.useEffect)((function(){e.modalView&&function(){var t=(0,a.Z)(c().mark((function t(){var r,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setLoading(!0),t.next=3,se.Z.getPlans();case 3:r=t.sent,i=0===r.filter((function(e){return(0,ce.Rf)(e,n)})).length,n&&!(0,ce.aX)(n)&&i&&(r=[(0,ce.Cu)(n)].concat((0,o.Z)(r))),s(r),e.setLoading(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e.modalView]);var x=null===i||void 0===i||null===(t=i.filter((function(e){return e.period===d})))||void 0===t?void 0:t.map((function(e){return(0,le.jsxs)(Io,{className:"subscription-plan-selector",selected:(0,ce.Rf)(e,n),onClick:(0,a.Z)(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:[(0,le.jsxs)("div",{children:[(0,le.jsx)("span",{style:{color:"#ECECEC",fontWeight:900,fontSize:"40px",lineHeight:"40px"},children:(0,ce.dl)(e.storage,0)}),(0,le.jsxs)("span",{style:{color:"#858585",fontSize:"24px",fontWeight:900},children:[" ","GB"]})]}),(0,le.jsx)("div",{className:"bold-text",style:{color:"#aaa",lineHeight:"36px",fontSize:"20px"},children:"".concat(e.price," / ").concat(e.period)}),(0,le.jsxs)(we.Z,{variant:"outline-success",block:!0,style:{marginTop:"20px",fontSize:"14px",display:"flex",justifyContent:"center"},disabled:(0,ce.Rf)(e,n),children:[y.Z.CHOOSE_PLAN_BTN,(0,le.jsx)(Oo,{style:{marginLeft:"5px"}})]})]},e.stripeID)}));return(0,le.jsxs)(Wr.Z,{show:e.modalView,onHide:e.closeModal,size:"xl",centered:!0,backdrop:!!(0,ce.LN)(n)||"static",contentClassName:"plan-selector-modal-content",children:[(0,le.jsx)(Wr.Z.Header,{closeButton:!0,children:(0,le.jsx)(Wr.Z.Title,{style:{marginLeft:"12px",width:"100%",textAlign:"center"},children:(0,le.jsx)("span",{children:(0,ce.LN)(n)?y.Z.MANAGE_PLAN:y.Z.CHOOSE_PLAN})})}),(0,le.jsxs)(Wr.Z.Body,{style:{marginTop:"20px"},children:[(0,le.jsx)(Ra,{children:(0,le.jsxs)("div",{style:{display:"flex"},children:[(0,le.jsx)("span",{className:"bold-text",style:{fontSize:"16px"},children:y.Z.MONTHLY}),(0,le.jsx)(bt.Z.Switch,{checked:d===jo.YEAR,id:"plan-period-toggler",style:{margin:"-4px 0 20px 15px",fontSize:"10px"},className:"custom-switch-md",onChange:function(){p((function(e){return e===jo.MONTH?jo.YEAR:jo.MONTH}))}}),(0,le.jsx)("span",{className:"bold-text",style:{fontSize:"16px"},children:y.Z.YEARLY})]})}),(0,le.jsx)("div",{style:{display:"flex",justifyContent:"space-around",flexWrap:"wrap",minHeight:"212px",margin:"5px 0"},children:i&&x}),(0,le.jsx)(Ra,{style:{marginBottom:"30px"},children:(0,ce.CF)(n)?(0,le.jsxs)(le.Fragment,{children:[(0,ce.gd)(n)?(0,le.jsx)(Ie,{variant:"success",onClick:function(){return e.setDialogMessage({title:y.Z.CONFIRM_ACTIVATE_SUBSCRIPTION,content:y.Z.ACTIVATE_SUBSCRIPTION_MESSAGE(n.expiryTime),staticBackdrop:!0,proceed:{text:y.Z.ACTIVATE_SUBSCRIPTION,action:ce.Iq.bind(null,e.setDialogMessage,e.closeModal,e.setLoading),variant:"success"},close:{text:y.Z.CANCEL}})},children:y.Z.ACTIVATE_SUBSCRIPTION}):(0,le.jsx)(Ie,{variant:"danger",onClick:function(){return e.setDialogMessage({title:y.Z.CONFIRM_CANCEL_SUBSCRIPTION,content:y.Z.CANCEL_SUBSCRIPTION_MESSAGE(),staticBackdrop:!0,proceed:{text:y.Z.CANCEL_SUBSCRIPTION,action:ce.EO.bind(null,e.setDialogMessage,e.closeModal,e.setLoading),variant:"danger"},close:{text:y.Z.CANCEL}})},children:y.Z.CANCEL_SUBSCRIPTION}),(0,le.jsx)(Ie,{variant:"primary",onClick:ce.TV.bind(null,e.setDialogMessage,e.setLoading),style:{marginTop:"20px"},children:y.Z.MANAGEMENT_PORTAL})]}):(0,le.jsx)(Ie,{variant:"primary",onClick:e.closeModal,style:{color:"rgb(121, 121, 121)",marginTop:"20px"},children:(0,ce.aX)(n)?y.Z.SKIP:y.Z.CLOSE})})]})]})};function So(e){return(0,le.jsx)("div",{children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"#000000",children:[(0,le.jsx)("path",{d:"M0 0h24v24H0V0z",fill:"none"}),(0,le.jsx)("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"})]})})}function Co(e){return(0,le.jsx)("div",{children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,fill:"#000000",children:[(0,le.jsx)("path",{d:"M24 24H0V0h24v24z",fill:"none",opacity:".87"}),(0,le.jsx)("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"})]})})}So.defaultProps={height:24,width:24,viewBox:"0 0 24 24",open:!1},Co.defaultProps={height:24,width:24,viewBox:"0 0 24 24",open:!1};var Zo=n(27108);function _o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Po(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Po(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ko(e,t){var n,r=_o(e);try{for(r.s();!(n=r.n()).done;){if(Ao(n.value.metadata,t))return!0}}catch(i){r.e(i)}finally{r.f()}return!1}function Ao(e,t){return e.fileType===t.fileType&&e.creationTime===t.creationTime&&e.modificationTime===t.modificationTime&&e.title===t.title}function Ro(e){var t=[],n=[];return e.forEach((function(e){var r=e.file;r.name.startsWith(".")||(r.name.toLowerCase().endsWith("json")?t.push(e):n.push(e))})),{mediaFiles:n,metadataFiles:t}}var Do=n(74804),No=n(86646),Lo=2e3,Fo=5368709120;function Mo(e,t,n){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,a.Z)(c().mark((function e(t,n,r){var i,o,a,s,l,u,d,f,h,x,v,g;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.file,o=r.collection,Do.Z.setFileProgress(i.name,0),a=null,s=null,l=null,u=null,d=null,e.prev=7,!(i.size>=Fo)){e.next=13;break}return Do.Z.setFileProgress(i.name,Go.TOO_LARGE),e.next=12,(0,Te._v)(Lo);case 12:return e.abrupt("return",{fileUploadResult:Go.TOO_LARGE});case 13:return e.next=15,(0,Dn.JB)(t,i);case 15:if((u=e.sent).fileType!==p.Gk.OTHERS){e.next=18;break}throw Error(j.sH.UNSUPPORTED_FILE_FORMAT);case 18:return e.next=20,No.ZP.getFileMetadata(i,o,u);case 20:if(l=e.sent,!ko(n,l)){e.next=26;break}return Do.Z.setFileProgress(i.name,Go.SKIPPED),e.next=25,(0,Te._v)(Lo);case 25:return e.abrupt("return",{fileUploadResult:Go.SKIPPED});case 26:return e.next=28,No.ZP.readFile(t,i,u);case 28:return(a=e.sent).hasStaticThumbnail&&(l.hasStaticThumbnail=!0),d={filedata:a.filedata,thumbnail:a.thumbnail,metadata:l},e.next=33,No.ZP.encryptFile(t,d,o.key);case 33:return s=e.sent,e.next=36,No.ZP.uploadToBucket(s.file);case 36:return f=e.sent,h=No.ZP.getUploadFile(o,f,s.fileKey),e.next=40,Rn.Z.uploadFile(h);case 40:return x=e.sent,e.next=43,(0,I.np)(x,o);case 43:return v=e.sent,Do.Z.setFileProgress(i.name,Go.UPLOADED),Do.Z.increaseFileUploaded(),e.abrupt("return",{fileUploadResult:Go.UPLOADED,file:v});case 49:e.prev=49,e.t0=e.catch(7),(0,O.H)(e.t0,"file upload failed",{fileFormat:u.exactType}),g=(0,j.a0)(e.t0),e.t1=g.message,e.next=e.t1===j.sH.ETAG_MISSING?56:e.t1===j.sH.UNSUPPORTED_FILE_FORMAT?58:e.t1===j.sH.FILE_TOO_LARGE?60:62;break;case 56:return Do.Z.setFileProgress(i.name,Go.BLOCKED),e.abrupt("return",{fileUploadResult:Go.BLOCKED});case 58:return Do.Z.setFileProgress(i.name,Go.UNSUPPORTED),e.abrupt("return",{fileUploadResult:Go.UNSUPPORTED});case 60:return Do.Z.setFileProgress(i.name,Go.TOO_LARGE),e.abrupt("return",{fileUploadResult:Go.TOO_LARGE});case 62:return Do.Z.setFileProgress(i.name,Go.FAILED),e.abrupt("return",{fileUploadResult:Go.FAILED});case 64:return e.prev=64,a=null,d=null,s=null,e.finish(64);case 69:case"end":return e.stop()}}),e,null,[[7,49,64,69]])})))).apply(this,arguments)}function Uo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ho(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Go,zo;!function(e){e[e.FAILED=-1]="FAILED",e[e.SKIPPED=-2]="SKIPPED",e[e.UNSUPPORTED=-3]="UNSUPPORTED",e[e.BLOCKED=-4]="BLOCKED",e[e.TOO_LARGE=-5]="TOO_LARGE",e[e.UPLOADED=100]="UPLOADED"}(Go||(Go={})),function(e){e[e.START=0]="START",e[e.READING_GOOGLE_METADATA_FILES=1]="READING_GOOGLE_METADATA_FILES",e[e.UPLOADING=2]="UPLOADING",e[e.FINISH=3]="FINISH"}(zo||(zo={}));var Wo=new(function(){function e(){(0,Be.Z)(this,e),(0,r.Z)(this,"cryptoWorkers",new Array(4)),(0,r.Z)(this,"metadataMap",void 0),(0,r.Z)(this,"filesToBeUploaded",void 0),(0,r.Z)(this,"failedFiles",void 0),(0,r.Z)(this,"existingFilesCollectionWise",void 0),(0,r.Z)(this,"existingFiles",void 0),(0,r.Z)(this,"setFiles",void 0),(0,r.Z)(this,"collections",void 0)}return(0,Ue.Z)(e,[{key:"initUploader",value:function(e,t){Do.Z.init(e),this.setFiles=t}},{key:"init",value:function(){var e=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.filesToBeUploaded=[],this.failedFiles=[],this.metadataMap=new Map,e.next=5,(0,p.dm)();case 5:return this.existingFiles=e.sent,this.existingFilesCollectionWise=(0,I.N0)(this.existingFiles),e.next=9,L();case 9:n=e.sent,t&&n.push.apply(n,(0,o.Z)(t)),this.collections=new Map(n.map((function(e){return[e.id,e]})));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queueFilesForUpload",value:function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.init(n);case 3:if(r=Ro(t),i=r.metadataFiles,o=r.mediaFiles,!i.length){e.next=8;break}return Do.Z.setUploadStage(zo.READING_GOOGLE_METADATA_FILES),e.next=8,this.seedMetadataMap(i);case 8:if(!o.length){e.next=12;break}return Do.Z.setUploadStage(zo.START),e.next=12,this.uploadMediaFiles(o);case 12:Do.Z.setUploadStage(zo.FINISH),Do.Z.setPercentComplete(100),e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(0),(0,O.H)(e.t0,"uploading failed with error"),e.t0;case 20:for(e.prev=20,a=0;a<4;a++)null===(s=this.cryptoWorkers[a])||void 0===s||s.worker.terminate();return e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[0,16,20,23]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"seedMetadataMap",value:function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,Do.Z.reset(t.length),n=Uo(t),e.prev=3,n.s();case 5:if((r=n.n()).done){e.next=13;break}return i=r.value,e.next=9,(0,Zo.a8)(i.file);case 9:(o=e.sent)&&(a=o.title,s=o.parsedMetaDataJSON,this.metadataMap.set((0,Zo.zt)(i.collectionID,a),s),Do.Z.increaseFileUploaded());case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),(0,O.H)(e.t1,"error seeding MetadataMap");case 26:case"end":return e.stop()}}),e,this,[[0,23],[3,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadMediaFiles",value:function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.filesToBeUploaded).push.apply(n,(0,o.Z)(t)),Do.Z.reset(t.length),e.next=4,No.ZP.init(t.length,this.metadataMap);case 4:Do.Z.setUploadStage(zo.UPLOADING),r=[],i=0;case 7:if(!(i<4&&this.filesToBeUploaded.length>0)){e.next=22;break}if(a=(0,w.P)()){e.next=11;break}throw Error(j.sH.FAILED_TO_LOAD_WEB_WORKER);case 11:return this.cryptoWorkers[i]=a,e.t0=r,e.t1=this,e.next=16,new this.cryptoWorkers[i].comlink;case 16:e.t2=e.sent,e.t3=e.t1.uploadNextFileInQueue.call(e.t1,e.t2),e.t0.push.call(e.t0,e.t3);case 19:i++,e.next=7;break;case 22:return e.next=24,Promise.all(r);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadNextFileInQueue",value:function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i,o,a,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.filesToBeUploaded.length>0)){e.next=22;break}return r=this.filesToBeUploaded.pop(),i=null!==(n=this.existingFilesCollectionWise.get(r.collectionID))&&void 0!==n?n:[],o=this.collections.get(r.collectionID),r.collection=o,e.next=7,Mo(t,i,r);case 7:if(a=e.sent,s=a.fileUploadResult,l=a.file,s!==Go.UPLOADED){e.next=18;break}return this.existingFiles.push(l),this.existingFiles=(0,I.hE)(this.existingFiles),e.next=15,(0,p.EL)((0,I.nO)(this.existingFiles));case 15:this.setFiles(this.existingFiles),this.existingFilesCollectionWise.has(l.collectionID)||this.existingFilesCollectionWise.set(l.collectionID,[]),this.existingFilesCollectionWise.get(l.collectionID).push(l);case 18:s!==Go.BLOCKED&&s!==Go.FAILED||this.failedFiles.push(r),Do.Z.moveFileToResultList(r.file.name),e.next=0;break;case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"retryFailedFiles",value:function(){var e=(0,a.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.queueFilesForUpload(this.failedFiles);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()),Vo=n(56180);function Xo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Yo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yo(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ko=f.ZP.ul.withConfig({displayName:"UploadProgress__FileList",componentId:"sc-13yugp9-0"})(["padding-left:30px;margin-top:5px;margin-bottom:0px;& > li{padding-left:5px;margin-bottom:10px;color:#ccc;}"]),qo=f.ZP.div.withConfig({displayName:"UploadProgress__SectionTitle",componentId:"sc-13yugp9-1"})(["display:flex;justify-content:space-between;color:#eee;font-size:20px;cursor:pointer;"]),Jo=f.ZP.div.withConfig({displayName:"UploadProgress__Section",componentId:"sc-13yugp9-2"})(["margin:20px 0;& > .ReactCollapse--collapse{transition:height 200ms;}word-break:break-word;padding:0 20px;"]),Qo=f.ZP.div.withConfig({displayName:"UploadProgress__SectionInfo",componentId:"sc-13yugp9-3"})(["margin:4px 0;padding-left:15px;"]),$o=f.ZP.div.withConfig({displayName:"UploadProgress__Content",componentId:"sc-13yugp9-4"})(["padding-right:30px;"]),ea=f.ZP.div.withConfig({displayName:"UploadProgress__NotUploadSectionHeader",componentId:"sc-13yugp9-5"})(["margin-top:30px;text-align:center;color:",";border-bottom:1px solid ",";margin:0 20px;"],je(ge.warning),je(ge.warning)),ta=function(e){var t,n=(0,l.useState)(!1),r=n[0],i=n[1],o=null===(t=e.fileUploadResultMap)||void 0===t?void 0:t.get(e.fileUploadResult);return null!==o&&void 0!==o&&o.length?(0,le.jsxs)(Jo,{children:[(0,le.jsxs)(qo,{onClick:function(){return i(!r)},children:[e.sectionTitle,r?(0,le.jsx)(So,{}):(0,le.jsx)(Co,{})]}),(0,le.jsx)(Vo.Collapse,{isOpened:r,children:(0,le.jsxs)($o,{children:[e.sectionInfo&&(0,le.jsx)(Qo,{children:e.sectionInfo}),(0,le.jsx)(Ko,{children:o.map((function(e){return(0,le.jsx)("li",{children:e},e)}))})]})})]}):(0,le.jsx)(le.Fragment,{})},na=function(e){var t=(0,l.useState)(!0),n=t[0],r=t[1],i=e.fileProgressStatuses;return null!==i&&void 0!==i&&i.length&&null!==i&&void 0!==i&&i.length?(0,le.jsxs)(Jo,{children:[(0,le.jsxs)(qo,{onClick:function(){return r(!n)},children:[e.sectionTitle,n?(0,le.jsx)(So,{}):(0,le.jsx)(Co,{})]}),(0,le.jsx)(Vo.Collapse,{isOpened:n,children:(0,le.jsx)($o,{children:(0,le.jsx)(Ko,{children:i.map((function(e){var t=e.fileName,n=e.progress;return(0,le.jsx)("li",{children:y.Z.FILE_UPLOAD_PROGRESS(t,n)},t)}))})})})]}):(0,le.jsx)(le.Fragment,{})};function ra(e){var t,n,r=[],a=new Map,s=!1;if(e.fileProgress){var c,l=Xo(e.fileProgress);try{for(l.s();!(c=l.n()).done;){var u=(0,i.Z)(c.value,2),d=u[0],p=u[1];r.push({fileName:d,progress:p})}}catch(w){l.e(w)}finally{l.f()}}if(e.uploadResult){var f,h=Xo(e.uploadResult);try{for(h.s();!(f=h.n()).done;){var x=(0,i.Z)(f.value,2),v=x[0],g=x[1];a.has(g)||a.set(g,[]),g<0&&(s=!0);var m=a.get(g);a.set(g,[].concat((0,o.Z)(m),[v]))}}catch(w){h.e(w)}finally{h.f()}}return(0,le.jsxs)(Wr.Z,{show:e.show,onHide:e.uploadStage!==zo.FINISH?function(){return null}:e.closeModal,"aria-labelledby":"contained-modal-title-vcenter",centered:!0,backdrop:0===(null===r||void 0===r?void 0:r.length)||"static",children:[(0,le.jsx)(Wr.Z.Header,{style:{display:"flex",justifyContent:"center",textAlign:"center",borderBottom:"none",paddingTop:"30px",paddingBottom:"0px"},closeButton:e.uploadStage===zo.FINISH,children:(0,le.jsx)("h4",{style:{width:"100%"},children:e.uploadStage===zo.UPLOADING?y.Z.UPLOAD[e.uploadStage](e.fileCounter):y.Z.UPLOAD[e.uploadStage]})}),(0,le.jsxs)(Wr.Z.Body,{children:[(e.uploadStage===zo.READING_GOOGLE_METADATA_FILES||e.uploadStage===zo.UPLOADING)&&(0,le.jsx)(it.Z,{now:e.now,animated:!0,variant:"upload-progress-bar"}),(0,le.jsx)(na,{fileProgressStatuses:r,sectionTitle:y.Z.INPROGRESS_UPLOADS}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.UPLOADED,sectionTitle:y.Z.SUCCESSFUL_UPLOADS}),e.uploadStage===zo.FINISH&&s&&(0,le.jsx)(ea,{children:y.Z.FILE_NOT_UPLOADED_LIST}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.BLOCKED,sectionTitle:y.Z.BLOCKED_UPLOADS,sectionInfo:y.Z.ETAGS_BLOCKED(Te.bw)}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.FAILED,sectionTitle:y.Z.FAILED_UPLOADS}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.SKIPPED,sectionTitle:y.Z.SKIPPED_FILES,sectionInfo:y.Z.SKIPPED_INFO}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.UNSUPPORTED,sectionTitle:y.Z.UNSUPPORTED_FILES,sectionInfo:y.Z.UNSUPPORTED_INFO}),(0,le.jsx)(ta,{fileUploadResultMap:a,fileUploadResult:Go.TOO_LARGE,sectionTitle:y.Z.TOO_LARGE_UPLOADS,sectionInfo:y.Z.TOO_LARGE_INFO})]}),e.uploadStage===zo.FINISH&&(0,le.jsx)(Wr.Z.Footer,{style:{border:"none"},children:e.uploadStage===zo.FINISH&&((null===a||void 0===a||null===(t=a.get(Go.FAILED))||void 0===t?void 0:t.length)>0||(null===a||void 0===a||null===(n=a.get(Go.BLOCKED))||void 0===n?void 0:n.length)>0?(0,le.jsx)(we.Z,{variant:"outline-success",style:{width:"100%"},onClick:e.retryFailed,children:y.Z.RETRY_FAILED}):(0,le.jsx)(we.Z,{variant:"outline-secondary",style:{width:"100%"},onClick:e.closeModal,children:y.Z.CLOSE}))})]})}var ia=["uploadToMultipleCollection","uploadToSingleCollection"];function oa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oa(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sa=function(e){var t=e.uploadToMultipleCollection,n=e.uploadToSingleCollection,r=(0,St.Z)(e,ia);return(0,le.jsxs)(ke.Z,aa(aa({},r),{},{attributes:{title:y.Z.MULTI_FOLDER_UPLOAD},children:[(0,le.jsx)("p",{style:{fontSize:"18px",textAlign:"center",marginBottom:"24px",marginTop:"4px"},children:y.Z.UPLOAD_STRATEGY_CHOICE}),(0,le.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",paddingBottom:"12px",justifyContent:"center"},children:[(0,le.jsx)(we.Z,{variant:"outline-success",onClick:function(){r.onHide(),n()},style:{padding:"12px 24px",whiteSpace:"nowrap",fontWeight:900},children:y.Z.UPLOAD_STRATEGY_SINGLE_COLLECTION}),(0,le.jsx)("div",{style:{textAlign:"center",minWidth:"100px",margin:"2%"},children:(0,le.jsx)("strong",{children:y.Z.OR})}),(0,le.jsx)(we.Z,{variant:"outline-success",onClick:function(){r.onHide(),t()},style:{padding:"12px 24px",whiteSpace:"nowrap",fontWeight:900},children:y.Z.UPLOAD_STRATEGY_COLLECTION_PER_FOLDER})]})]}))};function ca(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return la(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return la(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ua;function da(e){var t=(0,l.useState)(!1),n=t[0],r=t[1],o=(0,l.useState)(zo.START),s=o[0],u=o[1],d=(0,l.useState)({finished:0,total:0}),p=d[0],f=d[1],h=(0,l.useState)(new Map),x=h[0],v=h[1],g=(0,l.useState)(new Map),m=g[0],w=g[1],b=(0,l.useState)(0),E=b[0],I=b[1],T=(0,l.useState)(!1),S=T[0],C=T[1],Z=(0,l.useState)({suggestedCollectionName:"",multipleFolders:!1}),_=Z[0],P=Z[1],k=(0,l.useContext)(Se.AppContext),A=(0,l.useContext)(La);(0,l.useEffect)((function(){Wo.initUploader({setPercentComplete:I,setFileCounter:f,setFileProgress:v,setUploadResult:w,setUploadStage:u},e.setFiles)}),[]),(0,l.useEffect)((function(){var t,n,r,i;((null===(t=e.acceptedFiles)||void 0===t?void 0:t.length)>0||(null===(n=k.sharedFiles)||void 0===n?void 0:n.length)>0)&&(e.setLoading(!0),(null===(r=e.acceptedFiles)||void 0===r?void 0:r.length)>0?(i=function(){if(0===e.acceptedFiles.length)return null;var t=e.acceptedFiles.map((function(e){return e.path})),n=function(e){var t;return(null!==(t=e.match(/\//g))&&void 0!==t?t:[]).length};t.sort((function(e,t){return n(e)-n(t)}));var r=t[0],i=t[t.length-1],o=r.length,a=0,s=r.substr(0,r.lastIndexOf("/")),c=i.substr(0,i.lastIndexOf("/"));for(;a<o&&r.charAt(a)===i.charAt(a);)a++;var l=r.substring(0,a);l&&(l=l.substr(1,l.lastIndexOf("/")-1))&&(l=l.substr(l.lastIndexOf("/")+1));return{suggestedCollectionName:l,multipleFolders:s!==c}}())&&P(i):e.acceptedFiles=k.sharedFiles,H(i,e.isFirstUpload),e.setLoading(!1))}),[e.acceptedFiles,k.sharedFiles]);var R=function(){u(zo.START),f({finished:0,total:0}),v(new Map),w(new Map),I(0),e.closeCollectionSelector(),r(!0)};function D(){var t,n=new Map,r=ca(e.acceptedFiles);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.path,a=o.substr(0,o.lastIndexOf("/"));a.endsWith(nt)&&(a=a.substr(0,a.lastIndexOf("/")));var s=a.substr(a.lastIndexOf("/")+1);n.has(s)||n.set(s,[]),n.get(s).push(i)}}catch(c){r.e(c)}finally{r.f()}return n}var N=function(){var t=(0,a.Z)(c().mark((function t(n){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,R(),r=e.acceptedFiles.map((function(e){return{file:e,collectionID:n.id}})),t.next=5,F(r);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),(0,O.H)(t.t0,"Failed to upload files to existing collections");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),L=function(){var t=(0,a.Z)(c().mark((function t(n,o){var a,s,l,u,d,p,f,h,x,v,g,m,w;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,R(),a=[],s=[],l=new Map,n===ua.SINGLE_COLLECTION?l.set(o,e.acceptedFiles):l=D(),t.prev=6,t.next=9,M();case 9:u=t.sent,d=ca(l),t.prev=11,d.s();case 13:if((p=d.n()).done){t.next=23;break}return f=(0,i.Z)(p.value,2),h=f[0],x=f[1],t.next=17,G(h,u);case 17:v=t.sent,s.push(v),g=ca(x);try{for(g.s();!(m=g.n()).done;)w=m.value,a.push({collectionID:v.id,file:w})}catch(c){g.e(c)}finally{g.f()}case 21:t.next=13;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(11),d.e(t.t0);case 28:return t.prev=28,d.f(),t.finish(28);case 31:t.next=39;break;case 33:throw t.prev=33,t.t1=t.catch(6),r(!1),(0,O.H)(t.t1,"Failed to create album"),e.setDialogMessage({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.CREATE_ALBUM_FAILED}),t.t1;case 39:return t.next=41,F(a,s);case 41:t.next=46;break;case 43:t.prev=43,t.t2=t.catch(0),(0,O.H)(t.t2,"Failed to upload files to new collections");case 46:case"end":return t.stop()}}),t,null,[[0,43],[6,33],[11,25,28,31]])})));return function(e,n){return t.apply(this,arguments)}}(),F=function(){var t=(0,a.Z)(c().mark((function t(n,i){var o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setUploadInProgress(!0),e.closeCollectionSelector(),t.next=5,e.syncWithRemote(!0,!0);case 5:return t.next=7,Wo.queueFilesForUpload(n,i);case 7:t.next=15;break;case 9:throw t.prev=9,t.t0=t.catch(0),o=(0,j.T_)(t.t0.message,A.showPlanSelectorModal),e.setBannerMessage(o),r(!1),t.t0;case 15:return t.prev=15,k.resetSharedFiles(),e.setUploadInProgress(!1),e.syncWithRemote(),t.finish(15);case 20:case"end":return t.stop()}}),t,null,[[0,9,15,20]])})));return function(e,n){return t.apply(this,arguments)}}(),B=function(){var t=(0,a.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setUploadInProgress(!0),R(),t.next=5,e.syncWithRemote(!0,!0);case 5:return t.next=7,Wo.retryFailedFiles();case 7:t.next=15;break;case 9:t.prev=9,t.t0=t.catch(0),n=(0,j.T_)(t.t0.message,A.showPlanSelectorModal),k.resetSharedFiles(),e.setBannerMessage(n),r(!1);case 15:return t.prev=15,e.setUploadInProgress(!1),e.syncWithRemote(),t.finish(15);case 19:case"end":return t.stop()}}),t,null,[[0,9,15,19]])})));return function(){return t.apply(this,arguments)}}(),U=function(e){L(ua.SINGLE_COLLECTION,e)},H=function(t,n){t.suggestedCollectionName?t.multipleFolders?C(!0):t.suggestedCollectionName&&U(t.suggestedCollectionName):n?U("My First Album"):e.setCollectionSelectorAttributes({callback:N,showNextModal:function(){return function(t){e.setCollectionNamerAttributes({title:y.Z.CREATE_COLLECTION,buttonText:y.Z.CREATE,autoFilledName:null===t||void 0===t?void 0:t.suggestedCollectionName,callback:U})}(t)},title:y.Z.UPLOAD_TO_COLLECTION})};return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(sa,{show:S,onHide:function(){return C(!1)},uploadToSingleCollection:function(){return U(_.suggestedCollectionName)},uploadToMultipleCollection:function(){return L(ua.COLLECTION_PER_FOLDER)}}),(0,le.jsx)(ra,{now:E,fileCounter:p,uploadStage:s,fileProgress:x,show:n,closeModal:function(){return r(!1)},retryFailed:B,fileRejections:e.fileRejections,uploadResult:m})]})}!function(e){e[e.SINGLE_COLLECTION=0]="SINGLE_COLLECTION",e[e.COLLECTION_PER_FOLDER=1]="COLLECTION_PER_FOLDER"}(ua||(ua={}));var pa=f.ZP.button.withConfig({displayName:"DeleteBtn__Wrapper",componentId:"sc-1acxsdr-0"})(["border:none;background-color:#ff6666;position:fixed;z-index:1;bottom:30px;right:30px;width:60px;height:60px;border-radius:50%;color:#fff;"]);function fa(e){return(0,le.jsx)(wn,{message:y.Z.EMPTY_TRASH,children:(0,le.jsx)(pa,{onClick:e.onClick,children:(0,le.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",height:e.height,viewBox:e.viewBox,width:e.width,children:[(0,le.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,le.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})]})})})}fa.defaultProps={height:24,width:24,viewBox:"0 0 24 24"};var ha=n(69423);function xa(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return va(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return va(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function va(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ga(e,t,n,r){return ma.apply(this,arguments)}function ma(){return(ma=(0,a.Z)(c().mark((function e(t,n,r,o){var a,s,l,u,d,f,h,x,v,g,m,y,b;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,e.prev=1,0!==t.length){e.next=4;break}return e.abrupt("return",a);case 4:o({current:0,total:t.length}),s=xa(t.entries()),e.prev=6,s.s();case 8:if((l=s.n()).done){e.next=53;break}if(u=(0,i.Z)(l.value,2),d=u[0],f=u[1],e.prev=10,f.metadata.fileType===p.Gk.IMAGE){e.next=13;break}return e.abrupt("continue",51);case 13:if(h=void 0,n!==Oa.CUSTOM_TIME){e.next=18;break}h=(0,ha.BC)(r),e.next=34;break;case 18:return e.next=20,Ke.Z.getFile(f);case 20:return x=e.sent,e.next=23,(0,I.G5)(x);case 23:return v=e.sent,e.next=26,new w.ZP;case 26:return g=e.sent,e.next=29,(0,Dn.JB)(g,v);case 29:return m=e.sent,e.next=32,(0,ha.HM)(v,m);case 32:y=e.sent,h=n===Oa.DATE_TIME_ORIGINAL?(0,ha.BC)(null===y||void 0===y?void 0:y.DateTimeOriginal):(0,ha.BC)(null===y||void 0===y?void 0:y.CreateDate);case 34:if(!h||h===f.metadata.creationTime){e.next=42;break}return e.next=37,(0,I.rx)(f,h);case 37:return b=e.sent,e.next=40,(0,p.NA)([b]);case 40:b=e.sent[0],(0,I.Vz)(f,b);case 42:e.next=48;break;case 44:e.prev=44,e.t0=e.catch(10),(0,O.H)(e.t0,"failed to updated a CreationTime With Exif"),a=!0;case 48:return e.prev=48,o({current:d+1,total:t.length}),e.finish(48);case 51:e.next=8;break;case 53:e.next=58;break;case 55:e.prev=55,e.t1=e.catch(6),s.e(e.t1);case 58:return e.prev=58,s.f(),e.finish(58);case 61:e.next=67;break;case 63:e.prev=63,e.t2=e.catch(1),(0,O.H)(e.t2,"update CreationTime With Exif failed"),a=!0;case 67:return e.abrupt("return",a);case 68:case"end":return e.stop()}}),e,null,[[1,63],[6,55,58,61],[10,44,48,51]])})))).apply(this,arguments)}function wa(e){var t=e.progressTracker;return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,le.jsxs)(ot,{children:[" ",t.current," / ",t.total," "]})," ",(0,le.jsxs)("span",{style:{marginLeft:"10px"},children:[" ",y.Z.CREATION_TIME_UPDATED]})]}),(0,le.jsx)("div",{style:{width:"100%",marginTop:"10px",marginBottom:"20px"},children:(0,le.jsx)(it.Z,{now:Math.round(100*t.current/t.total),animated:!0,variant:"upload-progress-bar"})})]})}var ya=["fixState","startFix"];function ba(e){var t=e.fixState,n=e.startFix,r=(0,St.Z)(e,ya);return t!==Ea.RUNNING&&(0,le.jsxs)("div",{style:{width:"100%",display:"flex",marginTop:"30px",justifyContent:"space-around"},children:[(t===Ea.NOT_STARTED||t===Ea.COMPLETED_WITH_ERRORS)&&(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:function(){r.hide()},children:y.Z.CANCEL}),t===Ea.COMPLETED&&(0,le.jsx)(we.Z,{block:!0,variant:"outline-secondary",onClick:r.hide,children:y.Z.CLOSE}),(t===Ea.NOT_STARTED||t===Ea.COMPLETED_WITH_ERRORS)&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{width:"30px"}}),(0,le.jsx)(we.Z,{block:!0,variant:"outline-success",onClick:n,children:y.Z.FIX_CREATION_TIME})]})]})}var Ea,Oa,ja=function(e){var t=e.value,n=e.selected,r=e.onChange,i=e.label;return(0,le.jsxs)(bt.Z.Check,{name:"group1",style:{margin:"5px 0",color:t!==Number(n)?"#aaa":"#fff"},children:[(0,le.jsx)(bt.Z.Check.Input,{style:{marginTop:"6px"},id:t.toString(),type:"radio",value:t,checked:t===Number(n),onChange:r}),(0,le.jsx)(bt.Z.Check.Label,{style:{cursor:"pointer"},htmlFor:t.toString(),children:i})]})};function Ia(e){var t=e.handleChange,n=e.values;return(0,le.jsxs)(bt.Z,{noValidate:!0,children:[(0,le.jsx)(Pe.X2,{style:{margin:"0"},children:(0,le.jsx)(ja,{value:Oa.DATE_TIME_ORIGINAL,onChange:t("option"),label:y.Z.DATE_TIME_ORIGINAL,selected:Number(n.option)})}),(0,le.jsx)(Pe.X2,{style:{margin:"0"},children:(0,le.jsx)(ja,{value:Oa.DATE_TIME_DIGITIZED,onChange:t("option"),label:y.Z.DATE_TIME_DIGITIZED,selected:Number(n.option)})}),(0,le.jsxs)(Pe.X2,{style:{margin:"0"},children:[(0,le.jsx)(Pe.B4,{width:"50%",children:(0,le.jsx)(ja,{value:Oa.CUSTOM_TIME,onChange:t("option"),label:y.Z.CUSTOM_TIME,selected:Number(n.option)})}),Number(n.option)===Oa.CUSTOM_TIME&&(0,le.jsx)(Pe.B4,{width:"40%",children:(0,le.jsx)(Jr,{isInEditMode:!0,pickedTime:new Date(n.customTime),handleChange:function(e){return t("customTime")(e.toUTCString())}})})]})]})}function Ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ta(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ca(e){var t=null;switch(e.fixState){case Ea.NOT_STARTED:t=y.Z.UPDATE_CREATION_TIME_NOT_STARTED();break;case Ea.COMPLETED:t=y.Z.UPDATE_CREATION_TIME_COMPLETED();break;case Ea.COMPLETED_WITH_ERRORS:t=y.Z.UPDATE_CREATION_TIME_COMPLETED_WITH_ERROR()}return t?(0,le.jsx)("div",{children:t}):(0,le.jsx)(le.Fragment,{})}function Za(e){var t=(0,l.useState)(Ea.NOT_STARTED),n=t[0],r=t[1],i=(0,l.useState)({current:0,total:0}),o=i[0],s=i[1],u=(0,l.useContext)(La);(0,l.useEffect)((function(){e.attributes&&e.isOpen&&n!==Ea.RUNNING&&r(Ea.NOT_STARTED)}),[e.isOpen]);var d=function(){var t=(0,a.Z)(c().mark((function t(n,i){var o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(Ea.RUNNING),t.next=3,ga(e.attributes.files,n,i,s);case 3:return o=t.sent,r(o?Ea.COMPLETED_WITH_ERRORS:Ea.COMPLETED),t.next=7,u.syncWithRemote();case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();if(!e.attributes)return(0,le.jsx)(le.Fragment,{});return(0,le.jsx)(ke.Z,{show:e.isOpen,onHide:e.hide,attributes:{title:n===Ea.RUNNING?y.Z.FIX_CREATION_TIME_IN_PROGRESS:y.Z.FIX_CREATION_TIME,staticBackdrop:!0,nonClosable:!0},children:(0,le.jsxs)("div",{style:Sa({marginBottom:"10px",padding:"0 5%",display:"flex",flexDirection:"column"},n===Ea.RUNNING?{alignItems:"center"}:{}),children:[(0,le.jsx)(Ca,{fixState:n}),n===Ea.RUNNING&&(0,le.jsx)(wa,{progressTracker:o}),(0,le.jsx)(wt.J9,{initialValues:{option:Oa.DATE_TIME_ORIGINAL,customTime:new Date},validateOnBlur:!1,onSubmit:function(e){console.log(e),d(Number(e.option),new Date(e.customTime))},children:function(t){var r=t.values,i=t.handleChange,o=t.handleSubmit;return(0,le.jsxs)(le.Fragment,{children:[(n===Ea.NOT_STARTED||n===Ea.COMPLETED_WITH_ERRORS)&&(0,le.jsx)("div",{style:{marginTop:"10px"},children:(0,le.jsx)(Ia,{handleChange:i,values:r})}),(0,le.jsx)(ba,{fixState:n,startFix:o,hide:e.hide})]})}})]})})}function _a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ka(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Aa(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED",e[e.COMPLETED_WITH_ERRORS=3]="COMPLETED_WITH_ERRORS"}(Ea||(Ea={})),function(e){e[e.DATE_TIME_ORIGINAL=0]="DATE_TIME_ORIGINAL",e[e.DATE_TIME_DIGITIZED=1]="DATE_TIME_DIGITIZED",e[e.CUSTOM_TIME=2]="CUSTOM_TIME"}(Oa||(Oa={}));var Ra=f.ZP.div.withConfig({displayName:"gallery__DeadCenter",componentId:"sc-1v8vg44-0"})(["flex:1;display:flex;justify-content:center;align-items:center;text-align:center;flex-direction:column;"]),Da=f.ZP.div.withConfig({displayName:"gallery__AlertContainer",componentId:"sc-1v8vg44-1"})(["background-color:#111;padding:5px 0;font-size:14px;text-align:center;"]),Na={thumbs:new Map,files:new Map,showPlanSelectorModal:function(){return null},setActiveCollection:function(){return null},syncWithRemote:function(){return null}},La=(0,l.createContext)(Na);function Fa(){var e,t=(0,u.useRouter)(),n=(0,l.useState)([]),r=n[0],s=n[1],f=(0,l.useState)([]),x=f[0],v=f[1],g=(0,l.useState)(null),m=g[0],w=g[1],E=(0,l.useState)(),T=E[0],S=E[1],C=(0,l.useState)(null),Z=C[0],P=C[1],k=(0,l.useState)(!1),A=k[0],R=k[1],D=(0,l.useState)(!1),N=D[0],F=D[1],B=(0,l.useState)({count:0,collectionID:0}),G=B[0],W=B[1],V=(0,l.useState)(),X=V[0],Y=V[1],K=(0,l.useState)(!1),q=K[0],J=K[1],Q=(0,l.useState)(!1),$=Q[0],ee=Q[1],te=(0,l.useState)(!1),ne=te[0],re=te[1],oe=(0,l.useState)(null),ae=oe[0],ue=oe[1],de=(0,l.useState)(!1),pe=de[0],fe=de[1],he=(0,l.useState)(null),xe=he[0],ge=he[1],me=(0,l.useState)(!1),we=me[0],ye=me[1],be=(0,l.useState)({date:null,location:null,fileIndex:null}),Ee=be[0],Oe=be[1],je=(0,l.useState)(!1),Ie=je[0],Ze=je[1],Pe=(0,Ir.u)({noClick:!0,noKeyboard:!0,disabled:Ie}),Ae=Pe.getRootProps,Re=Pe.getInputProps,De=Pe.open,Ne=Pe.acceptedFiles,Le=Pe.fileRejections,Fe=(0,l.useRef)(null),Me=(0,l.useState)(!1),Be=Me[0],Ue=Me[1],He=(0,l.useState)(null),Ge=He[0],ze=He[1],We=(0,l.useRef)(!0),Ve=(0,l.useRef)(!1),Xe=(0,l.useState)([]),Ye=Xe[0],Ke=Xe[1],qe=(0,l.useContext)(Se.AppContext),Je=(0,l.useState)(),Qe=Je[0],$e=Je[1],et=(0,l.useState)(void 0),tt=et[0],nt=et[1],rt=(0,l.useState)([]),it=rt[0],ot=rt[1],at=(0,l.useState)(!1),st=at[0],ct=at[1],lt=(0,l.useState)(null),ut=lt[0],dt=lt[1];(0,l.useEffect)((function(){if(!(0,d.km)(d.Qm.ENCRYPTION_KEY))return qe.setRedirectUrl(t.asPath),void t.push(_e.q5.ROOT);(function(){var e=(0,a.Z)(c().mark((function e(){var t,n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nt(Tn),R((0,jr.aF)()),F(!0),(0,jr.fo)()&&ee(!0),(0,jr.Qj)(!1),e.t0=I.SA,e.next=8,(0,p.dm)();case 8:return e.t1=e.sent,t=(0,e.t0)(e.t1),e.next=12,L();case 12:return n=e.sent,e.next=15,Wn();case 15:return r=e.sent,i=rr(r),w((0,I.hE)([].concat((0,o.Z)(t),(0,o.Z)(i)))),s(n),ot(r),e.next=22,ft(n,t);case 22:return e.next=24,pt(!0);case 24:R(!1),(0,jr.n_)(!1),F(!1);case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),qe.showNavBar(!0)}),[]),(0,l.useEffect)((function(){return J(!0)}),[X]),(0,l.useEffect)((function(){return ae&&fe(!0)}),[ae]),(0,l.useEffect)((function(){return xe&&ye(!0)}),[xe]),(0,l.useEffect)((function(){return ut&&ct(!0)}),[ut]),(0,l.useEffect)((function(){if("undefined"!==typeof tt){var e="";tt!==Tn&&(e+="?collection=",e+=tt===jn?y.Z.ARCHIVE:tt===In?y.Z.TRASH:tt);var n="/gallery".concat(e);t.push(n,void 0,{shallow:!0})}}),[tt]),(0,l.useEffect)((function(){var e=(0,d.km)(d.Qm.ENCRYPTION_KEY);t.isReady&&e&&(0,ce.gT)(Y,t,re)}),[t.isReady]);var pt=function(){var e=(0,a.Z)(c().mark((function e(){var n,r,i,o,a,l,u,f=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>0&&void 0!==f[0]&&f[0],r=f.length>1&&void 0!==f[1]&&f[1],!We.current||n){e.next=5;break}return Ve.current=!0,e.abrupt("return");case 5:return We.current=!0,e.prev=6,(0,Te.SK)(),e.next=10,(0,b.D3)();case 10:if(e.sent){e.next=12;break}throw new Error(j.q8.SESSION_EXPIRED);case 12:return!r&&(null===(i=Fe.current)||void 0===i||i.continuousStart()),e.next=15,se.Z.syncSubscription();case 15:return e.next=17,M();case 17:return o=e.sent,s(o),e.next=21,(0,p.Z0)(o,w);case 21:return a=e.sent,e.next=24,ft(o,a);case 24:return e.next=26,$n(o,w,a);case 26:l=e.sent,ot(l),e.next=41;break;case 30:e.prev=30,e.t0=e.catch(6),e.t1=e.t0.message,e.next=e.t1===j.q8.SESSION_EXPIRED?35:e.t1===j.sH.KEY_MISSING?38:41;break;case 35:return P(y.Z.SESSION_EXPIRED_MESSAGE),Y({title:y.Z.SESSION_EXPIRED,content:y.Z.SESSION_EXPIRED_MESSAGE,staticBackdrop:!0,nonClosable:!0,proceed:{text:y.Z.LOGIN,action:b.TX,variant:"success"}}),e.abrupt("break",41);case 38:return(0,d.z5)(),t.push(_e.q5.CREDENTIALS),e.abrupt("break",41);case 41:return e.prev=41,!r&&(null===(u=Fe.current)||void 0===u||u.complete()),e.finish(41);case 44:We.current=!1,Ve.current&&(Ve.current=!1,pt());case 46:case"end":return e.stop()}}),e,null,[[6,30,41,44]])})));return function(){return e.apply(this,arguments)}}(),ft=function(){var e=(0,a.Z)(c().mark((function e(t,n){var r,o,a,l,u,d,p,f,h,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(n);case 2:r=e.sent,S(r),o=ie(t,n),s(o),a=U(o,n),v(a),l=(0,I.N0)(n),u=new Map,d=ka(l);try{for(d.s();!(p=d.n()).done;)f=(0,i.Z)(p.value,2),h=f[0],x=f[1],u.set(h,x.length)}catch(c){d.e(c)}finally{d.f()}$e(u);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ht=function(){W({count:0,collectionID:0})};if(!m)return(0,le.jsx)("div",{});var xt=function(e){return function(){var t=(0,a.Z)(c().mark((function t(n){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(r=Fe.current)||void 0===r||r.continuousStart(),t.prev=1,t.next=4,Bt(e,fe,G,m,nt,n);case 4:ht(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),(0,O.H)(t.t0,"collection ops failed",{ops:e}),Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.UNKNOWN_ERROR});case 11:return t.prev=11,t.next=14,pt(!1,!0);case 14:return Fe.current.complete(),t.finish(11);case 16:case"end":return t.stop()}}),t,null,[[1,7,11,16]])})));return function(e){return t.apply(this,arguments)}}()},vt=function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=Fe.current)||void 0===n||n.continuousStart(),e.prev=1,e.next=4,(0,I.Iq)(m,G,t);case 4:return i=e.sent,e.next=7,(0,p.FA)(i);case 7:ht(),e.next=19;break;case 10:e.prev=10,e.t0=e.catch(1),(0,O.H)(e.t0,"change file visibility failed"),e.t1=null===(r=e.t0.status)||void 0===r?void 0:r.toString(),e.next=e.t1===j.q8.FORBIDDEN?16:18;break;case 16:return Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.NOT_FILE_OWNER}),e.abrupt("return");case 18:Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.UNKNOWN_ERROR});case 19:return e.prev=19,e.next=22,pt(!1,!0);case 22:return Fe.current.complete(),e.finish(19);case 24:case"end":return e.stop()}}),e,null,[[1,10,19,24]])})));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=(0,a.Z)(c().mark((function e(t){var n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=Fe.current)||void 0===n||n.continuousStart(),e.prev=1,i=(0,I.Rb)(G,m),!t){e.next=9;break}return e.next=6,(0,p.be)(i.map((function(e){return e.id})));case 6:Ke([].concat((0,o.Z)(Ye),(0,o.Z)(i.map((function(e){return e.id}))))),e.next=11;break;case 9:return e.next=11,(0,p.N5)(i);case 11:ht(),e.next=18;break;case 14:switch(e.prev=14,e.t0=e.catch(1),null===(r=e.t0.status)||void 0===r?void 0:r.toString()){case j.q8.FORBIDDEN:Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.NOT_FILE_OWNER})}Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.UNKNOWN_ERROR});case 18:return e.prev=18,e.next=21,pt(!1,!0);case 21:return Fe.current.complete(),e.finish(18);case 23:case"end":return e.stop()}}),e,null,[[1,14,18,23]])})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=Fe.current)||void 0===t||t.continuousStart(),e.prev=1,e.next=4,ir();case 4:return G.collectionID===In&&ht(),e.next=7,or();case 7:nt(Tn),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.UNKNOWN_ERROR});case 13:return e.prev=13,e.next=16,pt(!1,!0);case 16:return Fe.current.complete(),e.finish(13);case 18:case"end":return e.stop()}}),e,null,[[1,10,13,18]])})));return function(){return e.apply(this,arguments)}}(),wt=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,I.Rb)(G,m),dt({files:t}),ht();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),yt=function(){var e=(0,a.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,I.Rb)(G,m),ht(),!We.current&&(null===(t=Fe.current)||void 0===t||t.continuousStart()),e.next=5,(0,I.GG)(n);case 5:!We.current&&Fe.current.complete();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,le.jsx)(La.Provider,{value:Pa(Pa({},Na),{},{showPlanSelectorModal:function(){return ee(!0)},setActiveCollection:nt,syncWithRemote:pt}),children:(0,le.jsxs)(ve,{getRootProps:Ae,getInputProps:Re,children:[ne&&(0,le.jsx)(Tr,{children:(0,le.jsx)(Ce.Z,{})}),(0,le.jsx)(h.Z,{color:"#51cd7c",ref:Fe}),A&&(0,le.jsx)(Da,{children:y.Z.INITIAL_LOAD_DELAY_WARNING}),(0,le.jsx)(To,{modalView:$,closeModal:function(){return ee(!1)},setDialogMessage:Y,setLoading:re}),(0,le.jsx)(mo,{bannerMessage:Z}),(0,le.jsx)(ke.Z,{size:"lg",show:q,onHide:function(){return J(!1)},attributes:X}),(0,le.jsx)(ro,{isOpen:Be,setOpen:Ue,loadingBar:Fe,isFirstFetch:N,collections:r,files:(0,I.zO)(m),setActiveCollection:nt,setSearch:function(e){nt(Tn),Oe(e),ze(null)},searchStats:Ge}),(0,le.jsx)(kn,{collections:r,collectionAndTheirLatestFile:x,isInSearchMode:Be,activeCollection:tt,setActiveCollection:nt,syncWithRemote:pt,setDialogMessage:Y,setCollectionNamerAttributes:ge,startLoadingBar:null===(e=Fe.current)||void 0===e?void 0:e.continuousStart,collectionFilesCount:Qe}),(0,le.jsx)(xo,{show:we,onHide:ye.bind(null,!1),attributes:xe}),(0,le.jsx)(fo,{show:pe,onHide:function(e){!0===e&&qe.resetSharedFiles(),fe(!1)},collectionsAndTheirLatestFile:x,attributes:ae}),(0,le.jsx)(Za,{isOpen:st,hide:function(){return ct(!1)},show:function(){return ct(!0)},attributes:ut}),(0,le.jsx)(da,{syncWithRemote:pt,setBannerMessage:P,acceptedFiles:Ne,showCollectionSelector:fe.bind(null,!0),setCollectionSelectorAttributes:ue,closeCollectionSelector:fe.bind(null,!1),setLoading:re,setCollectionNamerAttributes:ge,setDialogMessage:Y,setUploadInProgress:Ze,fileRejections:Le,setFiles:w,isFirstUpload:0===(null===x||void 0===x?void 0:x.length)}),(0,le.jsx)(Or,{collections:r,setDialogMessage:Y,setLoading:re}),(0,le.jsx)(yo,{isFirstFetch:N,openFileUploader:De}),(0,le.jsx)(Zi,{files:m,setFiles:w,syncWithRemote:pt,favItemIds:T,setSelected:W,selected:G,isFirstLoad:A,openFileUploader:De,loadingBar:Fe,isInSearchMode:Be,search:Ee,setSearchStats:ze,deleted:Ye,setDialogMessage:Y,activeCollection:tt,isSharedCollection:Gt(tt,r)}),G.count>0&&G.collectionID===tt&&(0,le.jsx)(yn,{addToCollectionHelper:xt(Dt.ADD),archiveFilesHelper:function(){return vt(p.YU.ARCHIVED)},unArchiveFilesHelper:function(){return vt(p.YU.VISIBLE)},moveToCollectionHelper:xt(Dt.MOVE),restoreToCollectionHelper:xt(Dt.RESTORE),showCreateCollectionModal:function(e){var t=function(){var t=(0,a.Z)(c().mark((function t(n){var i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z(n,_.album,r);case 3:return i=t.sent,t.next=6,xt(e)(i);case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),(0,O.H)(t.t0,"create and collection ops failed"),Y({title:y.Z.ERROR,staticBackdrop:!0,close:{variant:"danger"},content:y.Z.UNKNOWN_ERROR});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}();return function(){return ge({title:y.Z.CREATE_COLLECTION,buttonText:y.Z.CREATE,autoFilledName:"",callback:t})}},setDialogMessage:Y,setCollectionSelectorAttributes:ue,deleteFileHelper:gt,removeFromCollectionHelper:function(){return xt(Dt.REMOVE)(Ht(tt,r))},fixTimeHelper:wt,downloadHelper:yt,count:G.count,clearSelection:ht,activeCollection:tt,isFavoriteCollection:zt(tt,r)}),tt===In&&(null===it||void 0===it?void 0:it.length)>0&&(0,le.jsx)(fa,{onClick:function(){return Y({title:y.Z.CONFIRM_EMPTY_TRASH,content:y.Z.EMPTY_TRASH_MESSAGE,staticBackdrop:!0,proceed:{action:mt,text:y.Z.EMPTY_TRASH,variant:"danger"},close:{text:y.Z.CANCEL}})}})]})})}}}]);
//# sourceMappingURL=208-f6dc3e5396510ae290ac.js.map