"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{43514:function(e,n,t){t(67294);var r=t(35005),u=t(36968),c=t(85893);n.Z=function(e){var n=e.loading,t=e.buttonText,a=e.inline,s=e.disabled;return(0,c.jsx)(r.Z,{className:"submitButton",variant:"outline-success",type:"submit",block:!a,disabled:n||s,style:{padding:"6px 1em"},children:n?(0,c.jsx)(u.Z,{as:"span",animation:"border",style:{width:"22px",height:"22px",borderWidth:"0.20em",color:"#51cd7c"}}):t})}},63255:function(e,n,t){t.d(n,{sm:function(){return h},eF:function(){return x},$3:function(){return w},WO:function(){return k},_O:function(){return m},p6:function(){return b},wo:function(){return T},Jl:function(){return E},TX:function(){return K},VP:function(){return Z},D3:function(){return g},ks:function(){return P},er:function(){return O},dY:function(){return S},fG:function(){return D},Jr:function(){return L},XB:function(){return R},bW:function(){return A},tI:function(){return _},Uk:function(){return I},M_:function(){return B}});var r=t(30266),u=t(809),c=t.n(u),a=t(76640),s=t(9618),o=t(15289),i=t(11163),p=t(35641),f=t(58877),y=t(68487),l=t(44796),v=t(5567),d=(0,s.O3)(),h=[1,125,243,341],x=function(e){return l.Z.get("".concat(d,"/users/ott"),{email:e,client:"web"})},w=function(){var e=(0,r.Z)(c().mark((function e(n){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,y.LP)(),e.next=3,l.Z.get("".concat(d,"/users/public-key"),{email:n},{"X-Auth-Token":t});case 3:return r=e.sent,e.abrupt("return",r.data.publicKey);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),k=function(){var e=(0,r.Z)(c().mark((function e(){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,y.LP)(),e.next=3,l.Z.get("".concat(d,"/users/payment-token"),null,{"X-Auth-Token":n});case 3:return t=e.sent,e.abrupt("return",t.data.paymentToken);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(e,n){return l.Z.post("".concat(d,"/users/verify-email"),{email:e,ott:n})},b=function(e,n){return l.Z.put("".concat(d,"/users/attributes"),{keyAttributes:n},null,{"X-Auth-Token":e})},T=function(e,n){return l.Z.put("".concat(d,"/users/keys"),n,null,{"X-Auth-Token":e})},E=function(e,n){return l.Z.put("".concat(d,"/users/recovery-key"),n,null,{"X-Auth-Token":e})},K=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return(0,o.z5)(),(0,p.Nk)(),e.next=6,caches.delete("thumbs");case 6:return e.next=8,Z();case 8:i.default.push(a.q5.ROOT);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.Z.clear();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(0,y.LP)()){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,l.Z.get("".concat(d,"/users/session-validity/v2"),null,{"X-Auth-Token":(0,y.LP)()});case 5:if(n=e.sent,e.prev=6,void 0!==n.data.hasSetKeys){e.next=9;break}throw Error("resp.data.hasSetKey undefined");case 9:if(n.data.hasSetKeys){e.next=18;break}return e.prev=10,e.next=13,b((0,y.LP)(),(0,p.Yu)(p.Pd.ORIGINAL_KEY_ATTRIBUTES));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),(0,v.H)(e.t0,"put attribute failed");case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(6),(0,v.H)(e.t1,"hasSetKeys not set in session validity response");case 23:return e.abrupt("return",!0);case 26:return e.prev=26,e.t2=e.catch(0),e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,null,[[0,26],[6,20],[10,15]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.post("".concat(d,"/users/two-factor/setup"),null,null,{"X-Auth-Token":(0,y.LP)()});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,r.Z)(c().mark((function e(n,t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.post("".concat(d,"/users/two-factor/enable"),{code:n,encryptedTwoFactorSecret:t.encryptedData,twoFactorSecretDecryptionNonce:t.nonce},null,{"X-Auth-Token":(0,y.LP)()});case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),S=function(){var e=(0,r.Z)(c().mark((function e(n,t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.post("".concat(d,"/users/two-factor/verify"),{code:n,sessionID:t},null);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),D=function(){var e=(0,r.Z)(c().mark((function e(n){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.get("".concat(d,"/users/two-factor/recover"),{sessionID:n});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=function(){var e=(0,r.Z)(c().mark((function e(n,t){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.post("".concat(d,"/users/two-factor/remove"),{sessionID:n,secret:t});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),R=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.post("".concat(d,"/users/two-factor/disable"),null,null,{"X-Auth-Token":(0,y.LP)()});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,r.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.get("".concat(d,"/users/two-factor/status"),null,{"X-Auth-Token":(0,y.LP)()});case 2:return n=e.sent,e.abrupt("return",n.data.status);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.LP)()){e.next=2;break}return e.abrupt("return",!0);case 2:return e.prev=2,e.next=5,l.Z.post("".concat(d,"/users/logout"),null,null,{"X-Auth-Token":(0,y.LP)()});case 5:return e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(2),(0,v.H)(e.t0,"/users/logout failed"),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,r.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.LP)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,l.Z.get("".concat(d,"/users/ott"),{email:n,client:"web",purpose:"change"});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),I=function(){var e=(0,r.Z)(c().mark((function e(n,t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.LP)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,l.Z.post("".concat(d,"/users/change-email"),{email:n,ott:t},null,{"X-Auth-Token":(0,y.LP)()});case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),B=function(){var e=(0,r.Z)(c().mark((function e(){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,y.LP)(),e.next=3,l.Z.get("".concat(d,"/users/details"),null,{"X-Auth-Token":n});case 3:return t=e.sent,e.abrupt("return",t.data.details);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},76640:function(e,n,t){t.d(n,{kF:function(){return u},dP:function(){return c},xU:function(){return a},Ho:function(){return s},C3:function(){return o},yc:function(){return i},BV:function(){return p},q5:function(){return r}});var r,u=4194304,c=4,a=48,s=200,o=s-c,i=4,p=44;!function(e){e.CHANGE_EMAIL="/change-email",e.CHANGE_PASSWORD="/change-password",e.CREDENTIALS="/credentials",e.GALLERY="/gallery",e.GENERATE="/generate",e.LOGIN="/login",e.RECOVER="/recover",e.SIGNUP="/signup",e.TWO_FACTOR_SETUP="/two-factor/setup",e.TWO_FACTOR_VERIFY="/two-factor/verify",e.TWO_FACTOR_RECOVER="/two-factor/recover",e.VERIFY="/verify",e.ROOT="/"}(r||(r={}))},68487:function(e,n,t){t.d(n,{GW:function(){return p},LP:function(){return f}});var r=t(30266),u=t(809),c=t.n(u),a=t(8635),s=t(35641),o=t(15289),i=t(65725),p=(t(34155),function(){var e=(0,r.Z)(c().mark((function e(){var n,t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,o.km)(o.Qm.ENCRYPTION_KEY),e.next=4,new a.ZP;case 4:return t=e.sent,e.next=7,t.decryptB64(n.encryptedData,n.nonce,n.key);case 7:return r=e.sent,e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(0),new Error(i.sH.KEY_MISSING);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}()),f=function(){var e;return null===(e=(0,s.Yu)(s.Pd.USER))||void 0===e?void 0:e.token}},8635:function(e,n,t){t.d(n,{P:function(){return x},dR:function(){return k},iv:function(){return b},K_:function(){return E},yr:function(){return K},PN:function(){return P},OT:function(){return S}});var r,u=t(92809),c=t(30266),a=t(809),s=t.n(a),o=t(54375),i=t(31262),p=t(15289),f=t(35641),y=t(68487),l=t(63255),v=t(5567);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){(0,u.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var x=function(){if((0,i.S2)()){var e=new Worker(new URL(t.p+t.u(287),t.b),{name:"ente-worker"});return{comlink:o.Ud(e),worker:e}}},w=null===(r=x())||void 0===r?void 0:r.comlink;function k(e){return m.apply(this,arguments)}function m(){return(m=(0,c.Z)(s().mark((function e(n){var t,r,u,c,a,o,i,p,f,y,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w;case 2:return t=e.sent,e.next=5,t.generateEncryptionKey();case 5:return r=e.sent,e.next=8,t.generateEncryptionKey();case 8:return u=e.sent,e.next=11,t.generateSaltToDeriveKey();case 11:return c=e.sent,e.next=14,t.deriveSensitiveKey(n,c);case 14:return a=e.sent,e.next=17,t.encryptToB64(r,a.key);case 17:return o=e.sent,e.next=20,t.encryptToB64(r,u);case 20:return i=e.sent,e.next=23,t.encryptToB64(u,r);case 23:return p=e.sent,e.next=26,t.generateKeyPair();case 26:return f=e.sent,e.next=29,t.encryptToB64(f.privateKey,r);case 29:return y=e.sent,l={kekSalt:c,encryptedKey:o.encryptedData,keyDecryptionNonce:o.nonce,publicKey:f.publicKey,encryptedSecretKey:y.encryptedData,secretKeyDecryptionNonce:y.nonce,opsLimit:a.opsLimit,memLimit:a.memLimit,masterKeyEncryptedWithRecoveryKey:i.encryptedData,masterKeyDecryptionNonce:i.nonce,recoveryKeyEncryptedWithMasterKey:p.encryptedData,recoveryKeyDecryptionNonce:p.nonce},e.abrupt("return",{keyAttributes:l,masterKey:r});case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,n,t){return T.apply(this,arguments)}function T(){return(T=(0,c.Z)(s().mark((function e(n,t,r){var u,c,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w;case 2:return u=e.sent,e.next=5,u.generateSaltToDeriveKey();case 5:return c=e.sent,e.next=8,u.deriveIntermediateKey(n,c);case 8:return a=e.sent,e.next=11,u.encryptToB64(r,a.key);case 11:return o=e.sent,i=Object.assign(t,{kekSalt:c,encryptedKey:o.encryptedData,keyDecryptionNonce:o.nonce,opsLimit:a.opsLimit,memLimit:a.memLimit}),(0,f.a_)(f.Pd.KEY_ATTRIBUTES,i),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(){var e=(0,c.Z)(s().mark((function e(n,t){var r,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w;case 2:return r=e.sent,e.next=5,r.encryptToB64(t);case 5:u=e.sent,(0,p.Dt)(n,u);case 7:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),K=function(){var e=(0,c.Z)(s().mark((function e(){var n,t,r,u,c,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,new w;case 4:return t=e.sent,r=(0,f.Yu)(f.Pd.KEY_ATTRIBUTES),u=r.recoveryKeyEncryptedWithMasterKey,c=r.recoveryKeyDecryptionNonce,e.next=9,(0,y.GW)();case 9:if(a=e.sent,!u){e.next=16;break}return e.next=13,t.decryptB64(u,c,a);case 13:n=e.sent,e.next=19;break;case 16:return e.next=18,Z();case 18:n=e.sent;case 19:return e.next=21,t.toHex(n);case 21:return n=e.sent,e.abrupt("return",n);case 25:e.prev=25,e.t0=e.catch(1),(0,v.H)(e.t0,"getRecoveryKey failed");case 28:case"end":return e.stop()}}),e,null,[[1,25]])})));return function(){return e.apply(this,arguments)}}();function Z(){return g.apply(this,arguments)}function g(){return(g=(0,c.Z)(s().mark((function e(){var n,t,r,u,c,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.GW)();case 2:return n=e.sent,t=(0,f.Yu)(f.Pd.KEY_ATTRIBUTES),e.next=6,new w;case 6:return r=e.sent,e.next=9,r.generateEncryptionKey();case 9:return u=e.sent,e.next=12,r.encryptToB64(n,u);case 12:return c=e.sent,e.next=15,r.encryptToB64(u,n);case 15:return a=e.sent,o={masterKeyEncryptedWithRecoveryKey:c.encryptedData,masterKeyDecryptionNonce:c.nonce,recoveryKeyEncryptedWithMasterKey:a.encryptedData,recoveryKeyDecryptionNonce:a.nonce},e.next=19,(0,l.Jl)((0,y.LP)(),o);case 19:return i=Object.assign(t,o),(0,f.a_)(f.Pd.KEY_ATTRIBUTES,i),e.abrupt("return",u);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return O.apply(this,arguments)}function O(){return(O=(0,c.Z)(s().mark((function e(n){var t,r,u,c,a,o,i,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w;case 2:if(t=e.sent,r=(0,f.Yu)(f.Pd.USER),u=(0,f.Yu)(f.Pd.KEY_ATTRIBUTES),c=null,!((a=r.encryptedToken)&&a.length>0)){e.next=21;break}return e.next=10,t.decryptB64(u.encryptedSecretKey,u.secretKeyDecryptionNonce,n);case 10:return o=e.sent,e.next=13,t.boxSealOpen(a,u.publicKey,o);case 13:return i=e.sent,e.next=16,t.fromB64(i);case 16:return p=e.sent,e.next=19,t.toURLSafeB64(p);case 19:c=e.sent,(0,f.a_)(f.Pd.USER,h(h({},r),{},{token:c,encryptedToken:null}));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return D.apply(this,arguments)}function D(){return(D=(0,c.Z)(s().mark((function e(n){var t,r,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w;case 2:return t=e.sent,e.next=5,K();case 5:return r=e.sent,e.next=8,t.fromHex(r);case 8:return u=e.sent,e.next=11,t.encryptToB64(n,u);case 11:return c=e.sent,e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.ZP=w},58877:function(e,n,t){var r=t(31262),u=t(69483),c=t.n(u);(0,r.S2)()&&c().config({driver:c().INDEXEDDB,name:"ente-files",version:1,storeName:"files"}),n.Z=c()},15289:function(e,n,t){var r;t.d(n,{Qm:function(){return r},Dt:function(){return u},km:function(){return c},z5:function(){return a}}),function(e){e.ENCRYPTION_KEY="encryptionKey"}(r||(r={}));var u=function(e,n){if("undefined"===typeof sessionStorage)return null;sessionStorage.setItem(e,JSON.stringify(n))},c=function(e){return"undefined"===typeof sessionStorage?null:JSON.parse(sessionStorage.getItem(e))},a=function(){if("undefined"===typeof sessionStorage)return null;sessionStorage.clear()}}}]);
//# sourceMappingURL=279-698cb79bff86009d86df.js.map